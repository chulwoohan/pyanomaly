<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyanomaly &mdash; PyAnomaly 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=14fdb342" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=f2a433a1"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Support" href="support.html" />
    <link rel="prev" title="Bulding Your Own" href="building_your_own.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PyAnomaly
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#main-features">Main Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#coverage">Coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#structure">Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#system-requirement">System Requirement</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#comparison-to-other-sources">Comparison to Other Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#useful-links">Useful Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#glossary">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#contributors">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#featured-in">Featured In</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to Use</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html#generating-characteristics">Generating Characteristics</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_your_own.html">Bulding Your Own</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">pyanomaly</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.analytics">analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.characteristics">characteristics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.config">config</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.datatools">datatools</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.factors">factors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.ff">ff</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.fileio">fileio</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.globals">globals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.log">log</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.numba_support">numba_support</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.panel">panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.portfolio">portfolio</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.tcost">tcost</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.util">util</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.wrdsdata">wrdsdata</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyAnomaly</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">pyanomaly</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pyanomaly_edited.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pyanomaly">
<span id="id1"></span><h1>pyanomaly<a class="headerlink" href="#pyanomaly" title="Link to this heading"></a></h1>
<p id="module-pyanomaly">PyAnomaly is a Python library for asset pricing research.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-pyanomaly.analytics" title="pyanomaly.analytics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.analytics</span></code></a></p></td>
<td><p>This module defines analytic functions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-pyanomaly.characteristics" title="pyanomaly.characteristics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.characteristics</span></code></a></p></td>
<td><p>This module defines classes for firm characteristic generation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-pyanomaly.config" title="pyanomaly.config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.config</span></code></a></p></td>
<td><p>This module defines functions to set/get package configuration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-pyanomaly.datatools" title="pyanomaly.datatools"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.datatools</span></code></a></p></td>
<td><p>This module defines functions for data handling.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-pyanomaly.factors" title="pyanomaly.factors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.factors</span></code></a></p></td>
<td><p>This module defines functions to generate factor portfolios and characteristic portfolios.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-pyanomaly.ff" title="pyanomaly.ff"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.ff</span></code></a></p></td>
<td><p>This module defines functions to generate Fama-French factors.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-pyanomaly.fileio" title="pyanomaly.fileio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.fileio</span></code></a></p></td>
<td><p>This module defines functions for file IO.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-pyanomaly.globals" title="pyanomaly.globals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.globals</span></code></a></p></td>
<td><p>This module defines global constants.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-pyanomaly.log" title="pyanomaly.log"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.log</span></code></a></p></td>
<td><p>This module defines logging functions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-pyanomaly.numba_support" title="pyanomaly.numba_support"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.numba_support</span></code></a></p></td>
<td><p>This module defines jitted function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-pyanomaly.panel" title="pyanomaly.panel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.panel</span></code></a></p></td>
<td><p>This module defines classes for panel data analysis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-pyanomaly.portfolio" title="pyanomaly.portfolio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.portfolio</span></code></a></p></td>
<td><p>This module defines classes for portfolio analysis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-pyanomaly.tcost" title="pyanomaly.tcost"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.tcost</span></code></a></p></td>
<td><p>This module defines classes for transaction costs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-pyanomaly.util" title="pyanomaly.util"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.util</span></code></a></p></td>
<td><p>This module defines utility functions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-pyanomaly.wrdsdata" title="pyanomaly.wrdsdata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyanomaly.wrdsdata</span></code></a></p></td>
<td><p>This module defines WRDS class that is used to download and handle WRDS data.</p></td>
</tr>
</tbody>
</table>
<section id="module-pyanomaly.analytics">
<span id="analytics"></span><h2>analytics<a class="headerlink" href="#module-pyanomaly.analytics" title="Link to this heading"></a></h2>
<p>This module defines analytic functions.</p>
<dl>
<dt><strong>Sorting</strong></dt><dd><table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.analytics.one_dim_sort" title="pyanomaly.analytics.one_dim_sort"><code class="xref py py-obj docutils literal notranslate"><span class="pre">one_dim_sort</span></code></a></p></td>
<td><p>One-dimensional sort.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.analytics.two_dim_sort" title="pyanomaly.analytics.two_dim_sort"><code class="xref py py-obj docutils literal notranslate"><span class="pre">two_dim_sort</span></code></a></p></td>
<td><p>Two-dimensional sort.</p></td>
</tr>
</tbody>
</table>
<p>Auxiliary functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.analytics.relabel_class" title="pyanomaly.analytics.relabel_class"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relabel_class</span></code></a></p></td>
<td><p>Relabel classes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.analytics.weighted_mean" title="pyanomaly.analytics.weighted_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">weighted_mean</span></code></a></p></td>
<td><p>Calculate weighted means.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.analytics.append_long_short" title="pyanomaly.analytics.append_long_short"><code class="xref py py-obj docutils literal notranslate"><span class="pre">append_long_short</span></code></a></p></td>
<td><p>Add long-short to a quantile data.</p></td>
</tr>
</tbody>
</table>
</dd>
<dt><strong>Time-Series Analysis</strong></dt><dd><table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.analytics.time_series_average" title="pyanomaly.analytics.time_series_average"><code class="xref py py-obj docutils literal notranslate"><span class="pre">time_series_average</span></code></a></p></td>
<td><p>Calculate time-series mean and <cite>t</cite>-statistic.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.analytics.grs_test" title="pyanomaly.analytics.grs_test"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grs_test</span></code></a></p></td>
<td><p>Run GRS (Gibbons, Ross, and Shanken, 1989) test.</p></td>
</tr>
</tbody>
</table>
<p>Auxiliary functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.analytics.t_stat" title="pyanomaly.analytics.t_stat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">t_stat</span></code></a></p></td>
<td><p>Calculate <cite>t</cite>-statistic.</p></td>
</tr>
</tbody>
</table>
</dd>
<dt><strong>Cross-sectional Analysis</strong></dt><dd><table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.analytics.crosssectional_regression" title="pyanomaly.analytics.crosssectional_regression"><code class="xref py py-obj docutils literal notranslate"><span class="pre">crosssectional_regression</span></code></a></p></td>
<td><p>Run cross-sectional OLS.</p></td>
</tr>
</tbody>
</table>
</dd>
<dt><strong>Portfolio Analysis</strong></dt><dd><table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.analytics.make_position" title="pyanomaly.analytics.make_position"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_position</span></code></a></p></td>
<td><p>Make portfolio position data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.analytics.make_portfolio" title="pyanomaly.analytics.make_portfolio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_portfolio</span></code></a></p></td>
<td><p>Make a portfolio.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.analytics.make_long_short_portfolio" title="pyanomaly.analytics.make_long_short_portfolio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_long_short_portfolio</span></code></a></p></td>
<td><p>Make a long-short portfolio.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.analytics.make_quantile_portfolios" title="pyanomaly.analytics.make_quantile_portfolios"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_quantile_portfolios</span></code></a></p></td>
<td><p>Make quantile portfolios.</p></td>
</tr>
</tbody>
</table>
<p>Auxiliary functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.analytics.future_return" title="pyanomaly.analytics.future_return"><code class="xref py py-obj docutils literal notranslate"><span class="pre">future_return</span></code></a></p></td>
<td><p>Compute future returns.</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.append_long_short">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">append_long_short</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.append_long_short" title="Link to this definition"></a></dt>
<dd><p>Add long-short to a quantile data.</p>
<p>Long-short is defined as (first group - last group) in each date.
If labels are not given, long-short will be (class 0 - class N-1), where N is the number of classes,
and the class label of the long-short is set to N.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame with index = date/class1/class2/….</p></li>
<li><p><strong>level</strong> – Index level to make long-short on. Default to the last level.</p></li>
<li><p><strong>l_label</strong> – Label of the long class. If None, <cite>l_label</cite> = 0.</p></li>
<li><p><strong>s_label</strong> – Label of the short class. If None, <cite>s_label</cite> = N-1.</p></li>
<li><p><strong>ls_label</strong> – Label of the long-short. If None, <cite>ls_label</cite> = N.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The <cite>data</cite> with long-short appended.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.crosssectional_regression">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">crosssectional_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endo_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nonrobust'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.crosssectional_regression" title="Link to this definition"></a></dt>
<dd><p>Run cross-sectional OLS.</p>
<blockquote>
<div><p>Run cross-sectional OLS on each date and calculate the time-series means and t-stats of the coefficients.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame with index = date/id.</p></li>
<li><p><strong>endo_col</strong> – y column.</p></li>
<li><p><strong>exog_cols</strong> – List of X columns.</p></li>
<li><p><strong>add_constant</strong> (<em>bool</em>) – Add constant to X.</p></li>
<li><p><strong>cov_type</strong> – Covariance estimator. See <a class="reference internal" href="#pyanomaly.analytics.t_stat" title="pyanomaly.analytics.t_stat"><code class="xref py py-func docutils literal notranslate"><span class="pre">t_stat()</span></code></a>.</p></li>
<li><p><strong>cov_kwds</strong> – Parameters required for the chosen covariance estimator. See <a class="reference internal" href="#pyanomaly.analytics.t_stat" title="pyanomaly.analytics.t_stat"><code class="xref py py-func docutils literal notranslate"><span class="pre">t_stat()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>mean (DataFrame). Time-series means of coefficients with index = (‘const’ +) <cite>exog_cols</cite> and columns = ‘mean’.</p></li>
<li><p><cite>t</cite>-stat (DataFrame). <cite>t</cite>-statistics of coefficients with index = (‘const’ +) <cite>exog_cols</cite> and columns = ‘t-stat’.</p></li>
<li><p>coefs (DataFrame). Coefficient time-series with index = dates and columns = (‘const’ +) <cite>exog_cols</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.future_return">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">future_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ret</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.future_return" title="Link to this definition"></a></dt>
<dd><p>Compute future returns.</p>
<p>Compute <cite>period</cite>-period ahead returns. If <cite>ret</cite> has a MultiIndex of date/id, future returns are calculated for each
id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ret</strong> – Series of returns with index = date or date/id. If index = date/id, <cite>ret</cite> must be sorted on id/date.</p></li>
<li><p><strong>period</strong> – Target period.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Series of future returns.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.grs_test">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">grs_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">assets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factors</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.grs_test" title="Link to this definition"></a></dt>
<dd><p>Run GRS (Gibbons, Ross, and Shanken, 1989) test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>assets</strong> – T x N DataFrame or ndarray of asset returns.</p></li>
<li><p><strong>factors</strong> – T x F DataFrame or ndarray of factor returns.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>pricing error (alpha.T * inv(Sigma) * alpha)</p></li>
<li><p>squared Sharpe ratio of the factors</p></li>
<li><p>GRS statistic</p></li>
<li><p>p value</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.make_long_short_portfolio">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">make_long_short_portfolio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lposition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sposition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">costfcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'H-L'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls_wgt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">-1)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.make_long_short_portfolio" title="Link to this definition"></a></dt>
<dd><p>Make a long-short portfolio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lposition</strong> – DataFrame. Long position data. See <a class="reference internal" href="#pyanomaly.analytics.make_position" title="pyanomaly.analytics.make_position"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_position()</span></code></a> for the data format.</p></li>
<li><p><strong>sposition</strong> – DataFrame. Short position data.</p></li>
<li><p><strong>rf</strong> – Series or DataFrame of risk-free rates. The index should be date.</p></li>
<li><p><strong>costfcn</strong> – Transaction cost. See <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.costfcn" title="pyanomaly.portfolio.Portfolio.costfcn"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Portfolio.costfcn()</span></code></a>.</p></li>
<li><p><strong>keep_position</strong> – If True, keep the position information in the returned value. If position information is not
needed, set this to False to save memory.</p></li>
<li><p><strong>name</strong> – Portfolio name.</p></li>
<li><p><strong>ls_wgt</strong> – Long-short weights. (1, -1) means 1:1 long-short.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio" title="pyanomaly.portfolio.Portfolio"><code class="xref py py-class docutils literal notranslate"><span class="pre">Portfolio</span></code></a> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.make_portfolio">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">make_portfolio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">costfcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.make_portfolio" title="Link to this definition"></a></dt>
<dd><p>Make a portfolio.</p>
<p>This function creates portfolio position data from <cite>data</cite> and construct a portfolio from it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame with index = date/id.</p></li>
<li><p><strong>ret_col</strong> – Return column of <cite>data</cite>. Return should be over t to t+1.</p></li>
<li><p><strong>weight_col</strong> – Weight column of <cite>data</cite>. If None, constituents are equally weighted.</p></li>
<li><p><strong>rf</strong> – Series or DataFrame of risk-free rates. The index should be date.</p></li>
<li><p><strong>costfcn</strong> – Transaction cost. See <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.costfcn" title="pyanomaly.portfolio.Portfolio.costfcn"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Portfolio.costfcn()</span></code></a>.</p></li>
<li><p><strong>keep_position</strong> – If True, keep the position information in the returned value. If position information is not
needed, set this to False to save memory.</p></li>
<li><p><strong>name</strong> – Portfolio name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio" title="pyanomaly.portfolio.Portfolio"><code class="xref py py-class docutils literal notranslate"><span class="pre">Portfolio</span></code></a> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.make_position">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">make_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pf_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.make_position" title="Link to this definition"></a></dt>
<dd><p>Make portfolio position data.</p>
<p>To construct and evaluate a portfolio using <a class="reference internal" href="#pyanomaly.portfolio.Portfolio" title="pyanomaly.portfolio.Portfolio"><code class="xref py py-class docutils literal notranslate"><span class="pre">Portfolio</span></code></a>, position data is required.
This function makes the position data from <cite>data</cite>, which is a panel of securities.
The position data is generated via the following operations:</p>
<blockquote>
<div><ul>
<li><p>Change column names as assumed in <a class="reference internal" href="#pyanomaly.portfolio.Portfolio" title="pyanomaly.portfolio.Portfolio"><code class="xref py py-class docutils literal notranslate"><span class="pre">Portfolio</span></code></a>:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘date’: Date column.</p></li>
<li><p>‘id’: Security id column.</p></li>
<li><p>‘ret’: Return column.</p></li>
<li><p>‘wgt’: Weight column.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Normalize weights so that their cross-sectional sum becomes 1 within each portfolio.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame with index = date/id.</p></li>
<li><p><strong>ret_col</strong> – Return column of <cite>data</cite>. Return should be over t to t+1.</p></li>
<li><p><strong>weight_col</strong> – Weight column of <cite>data</cite>. If None, constituents are equally weighted.</p></li>
<li><p><strong>pf_col</strong> – Portfolio column of <cite>data</cite>, i.e., a column that maps securities with portfolios.
This can be None if the input data is for one portfolio.</p></li>
<li><p><strong>other_cols</strong> – Other columns of <cite>data</cite> to include in the <code class="docutils literal notranslate"><span class="pre">position</span></code> attribute of <code class="docutils literal notranslate"><span class="pre">Portfolio</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Position DataFrame with index = ‘date’ and columns = [‘id’, ‘ret’, ‘wgt’] + <cite>other_cols</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.make_quantile_portfolios">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">make_quantile_portfolios</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">costfcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls_wgt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">-1)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.make_quantile_portfolios" title="Link to this definition"></a></dt>
<dd><p>Make quantile portfolios.</p>
<p>This function makes quantile portfolios and the long-short portfolio from <cite>data</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame with index = date/id.</p></li>
<li><p><strong>q_col</strong> – Column of <cite>data</cite> that maps a security with quantiles (portfolios). The values should be integers
starting from 0.</p></li>
<li><p><strong>ret_col</strong> – Return column of <cite>data</cite>. Return should be over t to t+1.</p></li>
<li><p><strong>weight_col</strong> – Weight column of <cite>data</cite>. If None, constituents are equally weighted.</p></li>
<li><p><strong>rf</strong> – Series or DataFrame of risk-free rates. The index should be date.</p></li>
<li><p><strong>costfcn</strong> – Transaction cost. See <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.costfcn" title="pyanomaly.portfolio.Portfolio.costfcn"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Portfolio.costfcn()</span></code></a>.</p></li>
<li><p><strong>keep_position</strong> – If True, keep the position information in the returned value. If position information is not
needed, set this to False to save memory.</p></li>
<li><p><strong>names</strong> – Portfolio names. If None, the values in <cite>pf_col</cite> are used.</p></li>
<li><p><strong>ls_wgt</strong> – Long-short weights. (1, -1) means 1:1 long-short. If None, long-short portfolio is not constructed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolios" title="pyanomaly.portfolio.Portfolios"><code class="xref py py-class docutils literal notranslate"><span class="pre">Portfolios</span></code></a> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.one_dim_sort">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">one_dim_sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_long_short</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.one_dim_sort" title="Link to this definition"></a></dt>
<dd><p>One-dimensional sort.</p>
<p>This function assumes that <cite>data</cite> has already been sorted/grouped and class labels are given
in <cite>class_col</cite> column. Aggregate <cite>target_cols</cite> values using <cite>class_col</cite> and return aggregated results.
Class labels in <cite>class_col</cite> should be 0, 1, …</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame to be grouped. Index must be date/id.</p></li>
<li><p><strong>class_col</strong> – Class label column.</p></li>
<li><p><strong>target_cols</strong> – (List of) column(s) to aggregate. If None, <cite>target_cols</cite> = all numeric columns of <cite>data</cite>.</p></li>
<li><p><strong>weight_col</strong> – Weight column. If given, weighted mean is returned. Applicable only when <cite>function</cite> = ‘mean’.</p></li>
<li><p><strong>function</strong> – Aggregate function, e.g., ‘sum’, ‘mean’, ‘count’, or a list of functions.</p></li>
<li><p><strong>add_long_short</strong> (<em>bool</em>) – Add long-short to the output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aggregated data with index = date/class, columns = <cite>target_cols</cite>. If <cite>function</cite> is a list of functions,
the columns has two levels: first level = <cite>target_cols</cite> and second level = <cite>function</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.relabel_class">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">relabel_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.relabel_class" title="Link to this definition"></a></dt>
<dd><p>Relabel classes.</p>
<p>Relabel (rename) columns, indexes, or column values of <cite>data</cite>. The existing labels (values) should be continuous
integers starting from 0. The <cite>data</cite> is relabeled in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame to be relabeled.</p></li>
<li><p><strong>labels</strong> (<em>list</em>) – New class labels. Label 0 is replaced by the first element of <cite>labels</cite>, and so forth.</p></li>
<li><p><strong>axis</strong> – 1: index, 2: column.</p></li>
<li><p><strong>level</strong> – Level of index/column to be relabeled.</p></li>
<li><p><strong>col</strong> – Column name. If column name is given, <cite>axis</cite> and <cite>level</cite> are ignored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.t_stat">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">t_stat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nonrobust'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.t_stat" title="Link to this definition"></a></dt>
<dd><p>Calculate <cite>t</cite>-statistic.</p>
<p>Calculate <cite>t</cite>-statistic for each column of <cite>data</cite> under H0: x = 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Series, DataFrame, or ndarray with each column containing samples.</p></li>
<li><p><strong>cov_type</strong> – Covariance estimator: e.g., ‘HAC’ for Newey-West.</p></li>
<li><p><strong>cov_kwds</strong> – Parameters required for the chosen covariance estimator: e.g., {‘maxlags: 12} for <cite>cov_type</cite> = ‘HAC’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>t</cite>-stat. Float (if <cite>data</cite> is one dimensional) or (1 x K) ndarray, where K is the number of columns of <cite>data</cite>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.OLS.fit.html.">statsmodels.api.OLS.fit</a> for possible values of <cite>cov_type</cite> and <cite>cov_kwds</cite>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.time_series_average">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">time_series_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nonrobust'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.time_series_average" title="Link to this definition"></a></dt>
<dd><p>Calculate time-series mean and <cite>t</cite>-statistic.</p>
<p>Time-series mean and <cite>t</cite>-statistic are calculated for each column of  <cite>data</cite>. The <cite>data</cite> can be either a
time-series data (index = date) or a panel data (index = date/id). If it is a panel, time-series mean and
t-statistic are calculated for each id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame, Series, or ndarray. Data to analyze. If MultiIndex, the first index must be date.</p></li>
<li><p><strong>cov_type</strong> – Covariance estimator. See <a class="reference internal" href="#pyanomaly.analytics.t_stat" title="pyanomaly.analytics.t_stat"><code class="xref py py-func docutils literal notranslate"><span class="pre">t_stat()</span></code></a>.</p></li>
<li><p><strong>cov_kwds</strong> – Parameters required for the chosen covariance estimator. See <a class="reference internal" href="#pyanomaly.analytics.t_stat" title="pyanomaly.analytics.t_stat"><code class="xref py py-func docutils literal notranslate"><span class="pre">t_stat()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>mean (DataFrame).</p></li>
<li><p><cite>t</cite>-stat (DataFrame).</p></li>
</ul>
<p>If <cite>data</cite> has MultiIndex, mean (<cite>t</cite>-stat) has index = level 1 index of <cite>data</cite> and columns = <cite>data.columns</cite>.
Otherwise, mean (<cite>t</cite>-stat) has index = <cite>data.columns</cite> and columns = ‘mean’ (‘t-stat’).</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.two_dim_sort">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">two_dim_sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_col1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_col2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_long_short</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.two_dim_sort" title="Link to this definition"></a></dt>
<dd><p>Two-dimensional sort.</p>
<p>This function assumes that <cite>data</cite> has already been sorted/grouped and class labels are given
in <cite>class_col1</cite> and <cite>class_col2</cite> columns. Aggregate <cite>target_cols</cite> values using <cite>class_col1</cite> and <cite>class_col2</cite> and
return aggregated results. Class labels in <cite>class_col1(2)</cite> should be 0, 1, …</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Data to be grouped. Index must be date/id.</p></li>
<li><p><strong>class_col1</strong> – Class label column for the 1st dimension.</p></li>
<li><p><strong>class_col2</strong> – Class label column for the 2nd dimension.</p></li>
<li><p><strong>target_cols</strong> – (List of) column(s) to aggregate. If None, <cite>target_cols</cite> = all numeric columns of <cite>data</cite>.</p></li>
<li><p><strong>weight_col</strong> – Weight column. If given, weighted mean is returned. Applicable only when <cite>function</cite> = ‘mean’.</p></li>
<li><p><strong>function</strong> – Aggregate function, e.g., ‘sum’, ‘mean’, ‘count’.</p></li>
<li><p><strong>add_long_short</strong> (<em>bool</em>) – Add long-short to the output.</p></li>
<li><p><strong>output_dim</strong> – If 1, output is a DataFrame with index = date/class1/class2; if 2, output is a DataFrame with
index = date/class1 and column = class2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Aggregated data (DataFrame or dict of DataFrames).</p>
<ul class="simple">
<li><p>If <cite>output_dim</cite> = 1, index = date/class1/class2 and columns = <cite>target_cols</cite>.</p></li>
<li><p>If <cite>output_dim</cite> = 2 and <cite>len(target_cols)</cite> = 1, index = date/class1 and columns = class2.</p></li>
<li><p>If <cite>output_dim</cite> = 2 and <cite>len(target_cols)</cite> &gt; 1, output is dict with keys = <cite>target_cols</cite> and
values = DataFrames (as in the second case).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.weighted_mean">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">weighted_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_cols</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.weighted_mean" title="Link to this definition"></a></dt>
<dd><p>Calculate weighted means.</p>
<p>Calculate weighted means of each column in <cite>target_cols</cite> within each group defined by <cite>group_cols</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame.</p></li>
<li><p><strong>target_cols</strong> – (List of) column(s) to calculate weighted-mean.</p></li>
<li><p><strong>weight_col</strong> – Weight column name or Series or ndarray of weights.</p></li>
<li><p><strong>group_cols</strong> – (List of) grouping column(s).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame of weighted means with index = <cite>group_cols</cite> and columns = <cite>target_cols</cite>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>If <cite>data</cite> is a panel with index = date/permno and column ‘ret’ contains returns
and ‘me’ contains market equity at t-1, value-weighted returns can be obtained as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wmean</span> <span class="o">=</span> <span class="n">weighted_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;ret&#39;</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pyanomaly.characteristics">
<span id="characteristics"></span><h2>characteristics<a class="headerlink" href="#module-pyanomaly.characteristics" title="Link to this heading"></a></h2>
<p>This module defines classes for firm characteristic generation.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.FUNDA" title="pyanomaly.characteristics.FUNDA"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FUNDA</span></code></a></p></td>
<td><p>Class to generate firm characteristics from funda.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.FUNDQ" title="pyanomaly.characteristics.FUNDQ"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FUNDQ</span></code></a></p></td>
<td><p>Class to generate firm characteristics from fundq.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPM" title="pyanomaly.characteristics.CRSPM"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CRSPM</span></code></a></p></td>
<td><p>Class to generate firm characteristics from crspm.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw" title="pyanomaly.characteristics.CRSPDRaw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CRSPDRaw</span></code></a></p></td>
<td><p>Class that handles crspd data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPD" title="pyanomaly.characteristics.CRSPD"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CRSPD</span></code></a></p></td>
<td><p>Class to generate firm characteristics from crspd.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.Merge" title="pyanomaly.characteristics.Merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Merge</span></code></a></p></td>
<td><p>Class to generate firm characteristics from a combined dataset of crspm, crspd, funda, and fundq.</p></td>
</tr>
</tbody>
</table>
<section id="funda">
<h3>FUNDA<a class="headerlink" href="#funda" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.characteristics.</span></span><span class="sig-name descname"><span class="pre">FUNDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanomaly.panel.FCPanel" title="pyanomaly.panel.FCPanel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCPanel</span></code></a></p>
<p>Class to generate firm characteristics from funda.</p>
<p>The firm characteristics defined in this class can be viewed using <a class="reference internal" href="#pyanomaly.panel.FCPanel.show_available_chars" title="pyanomaly.panel.FCPanel.show_available_chars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">show_available_chars()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias</strong> (<em>str</em><em>, </em><em>list</em><em>, or </em><em>dict</em>) – <p>Firm characteristics to generate and their aliases. If None, all available firm
characteristics are generated.</p>
<ul>
<li><p>str: A column name in the mapping file (<code class="docutils literal notranslate"><span class="pre">config.mapping_file_path</span></code>). The firm characteristics defined
in this class and in the <cite>alias</cite> column of the mapping file are generated. See <a class="reference internal" href="getting_started.html#sec-mapping-file"><span class="std std-ref">Mapping File</span></a>.</p></li>
<li><p>list: List of firm characteristics (method names).</p></li>
<li><p>dict: Dict of firm characteristics and their aliases of the form {method name: alias}.</p></li>
</ul>
<p>If aliases are not specified, method names are used as aliases.</p>
</p></li>
<li><p><strong>data</strong> – DataFrame of funda data with index = datadate/gvkey, sorted on gvkey/datadate. The funda data can be
given at initialization or loaded later using <a class="reference internal" href="#pyanomaly.characteristics.FUNDA.load_data" title="pyanomaly.characteristics.FUNDA.load_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_data()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.FUNDA.load_data" title="pyanomaly.characteristics.FUNDA.load_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_data</span></code></a></p></td>
<td><p>Load funda data from file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.FUNDA.convert_currency" title="pyanomaly.characteristics.FUNDA.convert_currency"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_currency</span></code></a></p></td>
<td><p>Convert currency to USD.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.FUNDA.merge_with_fundq" title="pyanomaly.characteristics.FUNDA.merge_with_fundq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_with_fundq</span></code></a></p></td>
<td><p>Merge funda with fundq.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.FUNDA.add_crsp_me" title="pyanomaly.characteristics.FUNDA.add_crsp_me"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_crsp_me</span></code></a></p></td>
<td><p>Add crsp market equity.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.FUNDA.update_variables" title="pyanomaly.characteristics.FUNDA.update_variables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_variables</span></code></a></p></td>
<td><p>Preprocess data before creating firm characteristics.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.FUNDA.postprocess" title="pyanomaly.characteristics.FUNDA.postprocess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">postprocess</span></code></a></p></td>
<td><p>Postprocess data.</p></td>
</tr>
</tbody>
</table>
<p>Firm characteristic generation methods have a name like <code class="docutils literal notranslate"><span class="pre">c_characteristic()</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.add_crsp_me">
<span class="sig-name descname"><span class="pre">add_crsp_me</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crspm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'latest'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.add_crsp_me" title="Link to this definition"></a></dt>
<dd><p>Add crsp market equity.</p>
<p>In funda, market equity (‘me’) and fiscal market equity (‘me_fiscal’) are both defined as (prcc_f * csho).
This method replaces them with crspm’s firm-level market equity (‘me_company’).
If <cite>method</cite> = ‘latest’, ‘me’ is the latest ‘me_company’ and ‘me_fiscal’ is the ‘me_company’ on datadate.
If <cite>method</cite> = ‘year_end’, both ‘me’ and ‘me_fiscal’ are the ‘me_company’ in December of datadate year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crspm</strong> – <a class="reference internal" href="#pyanomaly.characteristics.CRSPM" title="pyanomaly.characteristics.CRSPM"><code class="xref py py-class docutils literal notranslate"><span class="pre">CRSPM</span></code></a> instance.</p></li>
<li><p><strong>method</strong> – How to merge crsp me with funda. ‘latest’: latest me; ‘year_end’: December me.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_absacc">
<span class="sig-name descname"><span class="pre">c_absacc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_absacc" title="Link to this definition"></a></dt>
<dd><p>Absolute accruals. Bandyopadhyay, Huang, and Wirjanto (2010)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_acc">
<span class="sig-name descname"><span class="pre">c_acc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_acc" title="Link to this definition"></a></dt>
<dd><p>Operating accruals (GHZ, Org). Sloan (1996)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_age">
<span class="sig-name descname"><span class="pre">c_age</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_age" title="Link to this definition"></a></dt>
<dd><p>Firm age. Jiang, Lee, and Zhang (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_aliq_at">
<span class="sig-name descname"><span class="pre">c_aliq_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_aliq_at" title="Link to this definition"></a></dt>
<dd><p>Asset liquidity to book assets. Ortiz-Molina and Phillips (2014)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_aliq_mat">
<span class="sig-name descname"><span class="pre">c_aliq_mat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_aliq_mat" title="Link to this definition"></a></dt>
<dd><p>Asset liquidity to market assets. Ortiz-Molina and Phillips (2014)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_at_be">
<span class="sig-name descname"><span class="pre">c_at_be</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_at_be" title="Link to this definition"></a></dt>
<dd><p>Book leverage. Fama and French (1992)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_at_gr1">
<span class="sig-name descname"><span class="pre">c_at_gr1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_at_gr1" title="Link to this definition"></a></dt>
<dd><p>Asset growth. Cooper, Gulen, and Schill (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_at_me">
<span class="sig-name descname"><span class="pre">c_at_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_at_me" title="Link to this definition"></a></dt>
<dd><p>Assets-to-market. Fama and French (1992)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_at_turnover">
<span class="sig-name descname"><span class="pre">c_at_turnover</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_at_turnover" title="Link to this definition"></a></dt>
<dd><p>Capital turnover. Haugen and Baker (1996)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_be_gr1a">
<span class="sig-name descname"><span class="pre">c_be_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_be_gr1a" title="Link to this definition"></a></dt>
<dd><p>Chage in common equity. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_be_me">
<span class="sig-name descname"><span class="pre">c_be_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_be_me" title="Link to this definition"></a></dt>
<dd><p>Book-to-market (December ME). Rosenberg, Reid, and Lanstein (1985)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_bev_mev">
<span class="sig-name descname"><span class="pre">c_bev_mev</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_bev_mev" title="Link to this definition"></a></dt>
<dd><p>Book-to-market enterprise value. Penman, Richardson, and Tuna (2007)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_bm_ia">
<span class="sig-name descname"><span class="pre">c_bm_ia</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_bm_ia" title="Link to this definition"></a></dt>
<dd><p>Industry-adjusted book-to-market. Asness, Porter, and Stevens (2000)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_capex_abn">
<span class="sig-name descname"><span class="pre">c_capex_abn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_capex_abn" title="Link to this definition"></a></dt>
<dd><p>Abnormal corporate investment. Titman, Wei, and Xie (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_capx_gr1">
<span class="sig-name descname"><span class="pre">c_capx_gr1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_capx_gr1" title="Link to this definition"></a></dt>
<dd><p>CAPEX growth (1 year). Xie (2001)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_capx_gr2">
<span class="sig-name descname"><span class="pre">c_capx_gr2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_capx_gr2" title="Link to this definition"></a></dt>
<dd><p>Two-year investment growth. Anderson and Garcia-Feijoo (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_capx_gr3">
<span class="sig-name descname"><span class="pre">c_capx_gr3</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_capx_gr3" title="Link to this definition"></a></dt>
<dd><p>Three-year investment growth. Anderson and Garcia-Feijoo (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cash_at">
<span class="sig-name descname"><span class="pre">c_cash_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cash_at" title="Link to this definition"></a></dt>
<dd><p>Cash-to-assets. Palazzo (2012)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cashdebt">
<span class="sig-name descname"><span class="pre">c_cashdebt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cashdebt" title="Link to this definition"></a></dt>
<dd><p>Cash flow-to-debt. Ou and Penman(1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cashpr">
<span class="sig-name descname"><span class="pre">c_cashpr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cashpr" title="Link to this definition"></a></dt>
<dd><p>Cash productivity. Chandrashekar and Rao (2009)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cfp">
<span class="sig-name descname"><span class="pre">c_cfp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cfp" title="Link to this definition"></a></dt>
<dd><p>Operating Cash flows to price (Org, GHZ). Desai, Rajgopal, and Venkatachalam (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cfp_ia">
<span class="sig-name descname"><span class="pre">c_cfp_ia</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cfp_ia" title="Link to this definition"></a></dt>
<dd><p>Industry-adjusted cash flow-to-price. Asness, Porter, and Stevens (2000)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_chatoia">
<span class="sig-name descname"><span class="pre">c_chatoia</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_chatoia" title="Link to this definition"></a></dt>
<dd><p>Change in profit margin. Soliman (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_chcsho">
<span class="sig-name descname"><span class="pre">c_chcsho</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_chcsho" title="Link to this definition"></a></dt>
<dd><p>Net stock issues (GHZ). Pontiff and Woodgate (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_chempia">
<span class="sig-name descname"><span class="pre">c_chempia</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_chempia" title="Link to this definition"></a></dt>
<dd><p>Industry-adjusted change in employees. Asness, Porter, and Stevens (2000)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_chpmia">
<span class="sig-name descname"><span class="pre">c_chpmia</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_chpmia" title="Link to this definition"></a></dt>
<dd><p>Change in profit margin. Soliman (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_coa_gr1a">
<span class="sig-name descname"><span class="pre">c_coa_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_coa_gr1a" title="Link to this definition"></a></dt>
<dd><p>Change in current operating assets. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_col_gr1a">
<span class="sig-name descname"><span class="pre">c_col_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_col_gr1a" title="Link to this definition"></a></dt>
<dd><p>Change in current Ooperating liabilities. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_convind">
<span class="sig-name descname"><span class="pre">c_convind</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_convind" title="Link to this definition"></a></dt>
<dd><p>Convertible debt indicator. Valta (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cop_at">
<span class="sig-name descname"><span class="pre">c_cop_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cop_at" title="Link to this definition"></a></dt>
<dd><p>Cash-based operating profitablility. Ball et al. (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cop_atl1">
<span class="sig-name descname"><span class="pre">c_cop_atl1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cop_atl1" title="Link to this definition"></a></dt>
<dd><p>Cash-based operating profits to lagged assets. Ball et al. (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cowc_gr1a">
<span class="sig-name descname"><span class="pre">c_cowc_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cowc_gr1a" title="Link to this definition"></a></dt>
<dd><p>Change in net non-cash working capital. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_currat">
<span class="sig-name descname"><span class="pre">c_currat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_currat" title="Link to this definition"></a></dt>
<dd><p>Current ratio. Ou and Penman (1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_dbnetis_at">
<span class="sig-name descname"><span class="pre">c_dbnetis_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_dbnetis_at" title="Link to this definition"></a></dt>
<dd><p>Net debt finance. Bradshaw, Richardson, and Sloan (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_debt_gr3">
<span class="sig-name descname"><span class="pre">c_debt_gr3</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_debt_gr3" title="Link to this definition"></a></dt>
<dd><p>Composite debt issuance. Lyandres, Sun, and Zhang (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_debt_me">
<span class="sig-name descname"><span class="pre">c_debt_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_debt_me" title="Link to this definition"></a></dt>
<dd><p>Debt to market. Bhandari (1988)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_depr">
<span class="sig-name descname"><span class="pre">c_depr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_depr" title="Link to this definition"></a></dt>
<dd><p>Depreciation to PP&amp;E. Holthausen and Larcker (1992)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_dgp_dsale">
<span class="sig-name descname"><span class="pre">c_dgp_dsale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_dgp_dsale" title="Link to this definition"></a></dt>
<dd><p>Gross margin growth to sales growth. Abarbanell and Bushee (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_dsale_dinv">
<span class="sig-name descname"><span class="pre">c_dsale_dinv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_dsale_dinv" title="Link to this definition"></a></dt>
<dd><p>Sales growth to inventory growth. Abarbanell and Bushee (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_dsale_drec">
<span class="sig-name descname"><span class="pre">c_dsale_drec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_dsale_drec" title="Link to this definition"></a></dt>
<dd><p>Sales growth to receivable growth. Abarbanell and Bushee (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_dsale_dsga">
<span class="sig-name descname"><span class="pre">c_dsale_dsga</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_dsale_dsga" title="Link to this definition"></a></dt>
<dd><p>Sales growth to SG&amp;A growth. Abarbanell and Bushee (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_dy">
<span class="sig-name descname"><span class="pre">c_dy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_dy" title="Link to this definition"></a></dt>
<dd><p>Dividend yield (GHZ). Litzenberger and Ramaswamy (1979)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_earnings_variability">
<span class="sig-name descname"><span class="pre">c_earnings_variability</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_earnings_variability" title="Link to this definition"></a></dt>
<dd><p>Earnings smoothness. Francis et al. (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ebit_bev">
<span class="sig-name descname"><span class="pre">c_ebit_bev</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ebit_bev" title="Link to this definition"></a></dt>
<dd><p>Return on net operating assets. Soliman (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ebit_sale">
<span class="sig-name descname"><span class="pre">c_ebit_sale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ebit_sale" title="Link to this definition"></a></dt>
<dd><p>Profit margin. Soliman (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ebitda_mev">
<span class="sig-name descname"><span class="pre">c_ebitda_mev</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ebitda_mev" title="Link to this definition"></a></dt>
<dd><p>Enterprise multiple. Loughran and Wellman (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_emp_gr1">
<span class="sig-name descname"><span class="pre">c_emp_gr1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_emp_gr1" title="Link to this definition"></a></dt>
<dd><p>Employee growth. Belo, Lin, and Bazdresch (2014)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_enterprise_multiple">
<span class="sig-name descname"><span class="pre">c_enterprise_multiple</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_enterprise_multiple" title="Link to this definition"></a></dt>
<dd><p>Enterprise multiple. Loughran and Wellman (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_eq_dur">
<span class="sig-name descname"><span class="pre">c_eq_dur</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_eq_dur" title="Link to this definition"></a></dt>
<dd><p>Equity duration. Dechow, Sloan, and Soliman (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_eqnetis_at">
<span class="sig-name descname"><span class="pre">c_eqnetis_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_eqnetis_at" title="Link to this definition"></a></dt>
<dd><p>Net equity finance. Bradshaw, Richardson, and Sloan (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_eqnpo_me">
<span class="sig-name descname"><span class="pre">c_eqnpo_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_eqnpo_me" title="Link to this definition"></a></dt>
<dd><p>Net payout yield. Boudoukh et al. (2007)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_eqpo_me">
<span class="sig-name descname"><span class="pre">c_eqpo_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_eqpo_me" title="Link to this definition"></a></dt>
<dd><p>Payout yield. Boudoukh et al. (2007)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_f_score">
<span class="sig-name descname"><span class="pre">c_f_score</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_f_score" title="Link to this definition"></a></dt>
<dd><p>Piotroski F-Score (JKP). Piotroski (2000)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_fcf_me">
<span class="sig-name descname"><span class="pre">c_fcf_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_fcf_me" title="Link to this definition"></a></dt>
<dd><p>Cash flow-to-price. Lakonishok, Shleifer, and Vishny (1994)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_fnl_gr1a">
<span class="sig-name descname"><span class="pre">c_fnl_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_fnl_gr1a" title="Link to this definition"></a></dt>
<dd><p>Change in financial liabilities. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_gp_at">
<span class="sig-name descname"><span class="pre">c_gp_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_gp_at" title="Link to this definition"></a></dt>
<dd><p>Gross profits-to-assets. Novy-Marx (2013)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_gp_atl1">
<span class="sig-name descname"><span class="pre">c_gp_atl1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_gp_atl1" title="Link to this definition"></a></dt>
<dd><p>Gross profits-to-lagged assets. Novy-Marx (2013)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_herf_at">
<span class="sig-name descname"><span class="pre">c_herf_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_herf_at" title="Link to this definition"></a></dt>
<dd><p>Industry concentration (total assets). Hou and Robinson (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_herf_be">
<span class="sig-name descname"><span class="pre">c_herf_be</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_herf_be" title="Link to this definition"></a></dt>
<dd><p>Industry concentration (book equity). Hou and Robinson (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_herf_sale">
<span class="sig-name descname"><span class="pre">c_herf_sale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_herf_sale" title="Link to this definition"></a></dt>
<dd><p>Industry concentration (sales). Hou and Robinson (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_intrinsic_value">
<span class="sig-name descname"><span class="pre">c_intrinsic_value</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_intrinsic_value" title="Link to this definition"></a></dt>
<dd><p>Intrinsic value-to-market. Frankel and Lee (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_inv_gr1">
<span class="sig-name descname"><span class="pre">c_inv_gr1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_inv_gr1" title="Link to this definition"></a></dt>
<dd><p>Inventory growth. Belo and Lin (2012)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_inv_gr1a">
<span class="sig-name descname"><span class="pre">c_inv_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_inv_gr1a" title="Link to this definition"></a></dt>
<dd><p>Inventory change. Thomas and Zhang (2002)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_invest">
<span class="sig-name descname"><span class="pre">c_invest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_invest" title="Link to this definition"></a></dt>
<dd><p>CAPEX and inventory. Chen and Zhang (2010)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_kz_index">
<span class="sig-name descname"><span class="pre">c_kz_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_kz_index" title="Link to this definition"></a></dt>
<dd><p>Kaplan-Zingales Index. Lamont, Polk, and Saa-Requejo (2001)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_lgr">
<span class="sig-name descname"><span class="pre">c_lgr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_lgr" title="Link to this definition"></a></dt>
<dd><p>Change in long-term debt. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_lnoa_gr1a">
<span class="sig-name descname"><span class="pre">c_lnoa_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_lnoa_gr1a" title="Link to this definition"></a></dt>
<dd><p>Change in long-term net operating assets. Fairfield, Whisenant, and Yohn (2003)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_lti_gr1a">
<span class="sig-name descname"><span class="pre">c_lti_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_lti_gr1a" title="Link to this definition"></a></dt>
<dd><p>Chagne in long-term investments. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_mve_ia">
<span class="sig-name descname"><span class="pre">c_mve_ia</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_mve_ia" title="Link to this definition"></a></dt>
<dd><p>Industry-adjusted firm size. Asness, Porter, and Stevens (2000)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ncoa_gr1a">
<span class="sig-name descname"><span class="pre">c_ncoa_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ncoa_gr1a" title="Link to this definition"></a></dt>
<dd><p>Change in non-current operating assets. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ncol_gr1a">
<span class="sig-name descname"><span class="pre">c_ncol_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ncol_gr1a" title="Link to this definition"></a></dt>
<dd><p>Change in non-current operating liabilities. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_netdebt_me">
<span class="sig-name descname"><span class="pre">c_netdebt_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_netdebt_me" title="Link to this definition"></a></dt>
<dd><p>Net debt-to-price. Penman, Richardson, and Tuna (2007)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_netis_at">
<span class="sig-name descname"><span class="pre">c_netis_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_netis_at" title="Link to this definition"></a></dt>
<dd><p>Net external finance. Bradshaw, Richardson, and Sloan (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_nfna_gr1a">
<span class="sig-name descname"><span class="pre">c_nfna_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_nfna_gr1a" title="Link to this definition"></a></dt>
<dd><p>Change in net financial assets. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ni_ar1">
<span class="sig-name descname"><span class="pre">c_ni_ar1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ni_ar1" title="Link to this definition"></a></dt>
<dd><p>Earnings persistence. Francis et al. (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ni_be">
<span class="sig-name descname"><span class="pre">c_ni_be</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ni_be" title="Link to this definition"></a></dt>
<dd><p>Return on equity. Haugen and Baker (1996)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ni_ivol">
<span class="sig-name descname"><span class="pre">c_ni_ivol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ni_ivol" title="Link to this definition"></a></dt>
<dd><p>Earnings predictability. Francis et al. (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ni_me">
<span class="sig-name descname"><span class="pre">c_ni_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ni_me" title="Link to this definition"></a></dt>
<dd><p>Earnings to price. Basu (1983)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_nncoa_gr1a">
<span class="sig-name descname"><span class="pre">c_nncoa_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_nncoa_gr1a" title="Link to this definition"></a></dt>
<dd><p>Change in net non-current operating assets. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_noa_at">
<span class="sig-name descname"><span class="pre">c_noa_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_noa_at" title="Link to this definition"></a></dt>
<dd><p>Net operating assets. Hirshleifer et al. (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_noa_gr1a">
<span class="sig-name descname"><span class="pre">c_noa_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_noa_gr1a" title="Link to this definition"></a></dt>
<dd><p>Change in net operating assets. Hirshleifer et al. (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_o_score">
<span class="sig-name descname"><span class="pre">c_o_score</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_o_score" title="Link to this definition"></a></dt>
<dd><p>Ohlson O-Score. Dichev (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_oaccruals_at">
<span class="sig-name descname"><span class="pre">c_oaccruals_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_oaccruals_at" title="Link to this definition"></a></dt>
<dd><p>Operating Accruals (JKP). Sloan (1996)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_oaccruals_ni">
<span class="sig-name descname"><span class="pre">c_oaccruals_ni</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_oaccruals_ni" title="Link to this definition"></a></dt>
<dd><p>Percent Operating Accruals (JKP). Hafzalla, Lundholm, and Van Winkle (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ocf_at">
<span class="sig-name descname"><span class="pre">c_ocf_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ocf_at" title="Link to this definition"></a></dt>
<dd><p>Operating cash flow to assets. Bouchard et al. (2019)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ocf_at_chg1">
<span class="sig-name descname"><span class="pre">c_ocf_at_chg1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ocf_at_chg1" title="Link to this definition"></a></dt>
<dd><p>Change in operating cash flow to assets. Bouchard et al. (2019)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ocf_me">
<span class="sig-name descname"><span class="pre">c_ocf_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ocf_me" title="Link to this definition"></a></dt>
<dd><p>Operating Cash flows to price (JKP). Desai, Rajgopal, and Venkatachalam (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_op_at">
<span class="sig-name descname"><span class="pre">c_op_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_op_at" title="Link to this definition"></a></dt>
<dd><p>Operating profits-to-assets. Ball et al. (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_op_atl1">
<span class="sig-name descname"><span class="pre">c_op_atl1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_op_atl1" title="Link to this definition"></a></dt>
<dd><p>Operating profits-to-lagged assets. Ball et al. (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ope_be">
<span class="sig-name descname"><span class="pre">c_ope_be</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ope_be" title="Link to this definition"></a></dt>
<dd><p>Operating profits to book equity (JKP). Fama and French (2015)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ope_bel1">
<span class="sig-name descname"><span class="pre">c_ope_bel1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ope_bel1" title="Link to this definition"></a></dt>
<dd><p>Operating profits to lagged book equity. Fama and French (2015)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_operprof">
<span class="sig-name descname"><span class="pre">c_operprof</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_operprof" title="Link to this definition"></a></dt>
<dd><p>Operating profits to book equity (GHZ, Org). Fama and French (2015)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_opex_at">
<span class="sig-name descname"><span class="pre">c_opex_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_opex_at" title="Link to this definition"></a></dt>
<dd><p>Operating leverage. Novy-Marx (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_pchcapx_ia">
<span class="sig-name descname"><span class="pre">c_pchcapx_ia</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_pchcapx_ia" title="Link to this definition"></a></dt>
<dd><p>Industry-adjusted change in capital investment. Abarbanell and Bushee (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_pchcurrat">
<span class="sig-name descname"><span class="pre">c_pchcurrat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_pchcurrat" title="Link to this definition"></a></dt>
<dd><p>Change in current ratio. Ou and Penman (1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_pchdepr">
<span class="sig-name descname"><span class="pre">c_pchdepr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_pchdepr" title="Link to this definition"></a></dt>
<dd><p>Change in depreciation to PP&amp;E. Holthausen and Larcker (1992)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_pchquick">
<span class="sig-name descname"><span class="pre">c_pchquick</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_pchquick" title="Link to this definition"></a></dt>
<dd><p>Change in quick ratio. Ou and Penman (1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_pchsaleinv">
<span class="sig-name descname"><span class="pre">c_pchsaleinv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_pchsaleinv" title="Link to this definition"></a></dt>
<dd><p>Change in sales to inventory. Ou and Penman(1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_pctacc">
<span class="sig-name descname"><span class="pre">c_pctacc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_pctacc" title="Link to this definition"></a></dt>
<dd><p>Percent operating accruals (GHZ, Org). Hafzalla, Lundholm, and Van Winkle (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_pi_nix">
<span class="sig-name descname"><span class="pre">c_pi_nix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_pi_nix" title="Link to this definition"></a></dt>
<dd><p>Taxable income to income (JKP). Lev and Nissim (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ppeinv_gr1a">
<span class="sig-name descname"><span class="pre">c_ppeinv_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ppeinv_gr1a" title="Link to this definition"></a></dt>
<dd><p>Changes in PPE and inventory/assets. Lyandres, Sun, and Zhang (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ps">
<span class="sig-name descname"><span class="pre">c_ps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ps" title="Link to this definition"></a></dt>
<dd><p>Piotroski score (GHZ, Org). Piotroski (2000)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_quick">
<span class="sig-name descname"><span class="pre">c_quick</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_quick" title="Link to this definition"></a></dt>
<dd><p>Quick ratio. Ou and Penman (1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_rd">
<span class="sig-name descname"><span class="pre">c_rd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_rd" title="Link to this definition"></a></dt>
<dd><p>Unexpected R&amp;D increase. Eberhart, Maxwell, and Siddique (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_rd5_at">
<span class="sig-name descname"><span class="pre">c_rd5_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_rd5_at" title="Link to this definition"></a></dt>
<dd><p>R&amp;D capital-to-assets. Li (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_rd_me">
<span class="sig-name descname"><span class="pre">c_rd_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_rd_me" title="Link to this definition"></a></dt>
<dd><p>R&amp;D to market. Chan, Lakonishok, and Sougiannis (Guo, Lev, and Shi (2006) in GHZ)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_rd_sale">
<span class="sig-name descname"><span class="pre">c_rd_sale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_rd_sale" title="Link to this definition"></a></dt>
<dd><p>R&amp;D to sales. Chan, Lakonishok, and Sougiannis (2001) (Guo, Lev, and Shi (2006) in GHZ)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_realestate">
<span class="sig-name descname"><span class="pre">c_realestate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_realestate" title="Link to this definition"></a></dt>
<dd><p>Real estate holdings. Tuzel (2010)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_roic">
<span class="sig-name descname"><span class="pre">c_roic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_roic" title="Link to this definition"></a></dt>
<dd><p>Return on invested capital. Brown and Rowe (2007)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_sale_bev">
<span class="sig-name descname"><span class="pre">c_sale_bev</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_sale_bev" title="Link to this definition"></a></dt>
<dd><p>Asset turnover. Soliman (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_sale_emp_gr1">
<span class="sig-name descname"><span class="pre">c_sale_emp_gr1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_sale_emp_gr1" title="Link to this definition"></a></dt>
<dd><p>Labor force efficiency. Abarbanell and Bushee (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_sale_gr1">
<span class="sig-name descname"><span class="pre">c_sale_gr1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_sale_gr1" title="Link to this definition"></a></dt>
<dd><p>Annual sales growth. Lakonishok, Shleifer, and Vishny (1994)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_sale_gr3">
<span class="sig-name descname"><span class="pre">c_sale_gr3</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_sale_gr3" title="Link to this definition"></a></dt>
<dd><p>Three-year sales growth. Lakonishok, Shleifer, and Vishny (1994)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_sale_me">
<span class="sig-name descname"><span class="pre">c_sale_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_sale_me" title="Link to this definition"></a></dt>
<dd><p>Sales to price. Barbee, Mukherji, and Raines (1996)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_salecash">
<span class="sig-name descname"><span class="pre">c_salecash</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_salecash" title="Link to this definition"></a></dt>
<dd><p>Sales-to-cash. Ou and Penman (1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_saleinv">
<span class="sig-name descname"><span class="pre">c_saleinv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_saleinv" title="Link to this definition"></a></dt>
<dd><p>Sales-to-inventory. Ou and Penman(1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_salerec">
<span class="sig-name descname"><span class="pre">c_salerec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_salerec" title="Link to this definition"></a></dt>
<dd><p>Sales-to-receivables. Ou and Penman(1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_secured">
<span class="sig-name descname"><span class="pre">c_secured</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_secured" title="Link to this definition"></a></dt>
<dd><p>Secured debt-to-total debt. Valta (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_securedind">
<span class="sig-name descname"><span class="pre">c_securedind</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_securedind" title="Link to this definition"></a></dt>
<dd><p>Secured debt indicator. Valta (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_sin">
<span class="sig-name descname"><span class="pre">c_sin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_sin" title="Link to this definition"></a></dt>
<dd><p>Sin stocks. Hong and Kacperczyk (2009)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_sti_gr1a">
<span class="sig-name descname"><span class="pre">c_sti_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_sti_gr1a" title="Link to this definition"></a></dt>
<dd><p>Change in short-term investments. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_taccruals_at">
<span class="sig-name descname"><span class="pre">c_taccruals_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_taccruals_at" title="Link to this definition"></a></dt>
<dd><p>Total Accruals. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_taccruals_ni">
<span class="sig-name descname"><span class="pre">c_taccruals_ni</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_taccruals_ni" title="Link to this definition"></a></dt>
<dd><p>Percent total accruals. Hafzalla, Lundholm, and Van Winkle (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_tangibility">
<span class="sig-name descname"><span class="pre">c_tangibility</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_tangibility" title="Link to this definition"></a></dt>
<dd><p>Tangibility. Hahn and Lee (2009)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_tb">
<span class="sig-name descname"><span class="pre">c_tb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_tb" title="Link to this definition"></a></dt>
<dd><p>Taxable income to income (Org, GHZ). Lev and Nissim (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_z_score">
<span class="sig-name descname"><span class="pre">c_z_score</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_z_score" title="Link to this definition"></a></dt>
<dd><p>Altman Z-Score. Dichev (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.convert_currency">
<span class="sig-name descname"><span class="pre">convert_currency</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.convert_currency" title="Link to this definition"></a></dt>
<dd><p>Convert currency to USD.</p>
<p>Convert the currency of funda to USD. This method needs to be called if</p>
<blockquote>
<div><ol class="lowerroman simple">
<li><p>the data contains non USD-denominated firms, e.g., CAD; and</p></li>
<li><p>CRSP’s market equity is used, which is always in USD.</p></li>
</ol>
</div></blockquote>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.convert_fund_currency_to_usd" title="pyanomaly.wrdsdata.WRDS.convert_fund_currency_to_usd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WRDS.convert_fund_currency_to_usd()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'funda'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.load_data" title="Link to this definition"></a></dt>
<dd><p>Load funda data from file.</p>
<p>This method loads funda data from <code class="docutils literal notranslate"><span class="pre">config.input_dir/comp/funda</span></code> and stores it in the <code class="docutils literal notranslate"><span class="pre">data</span></code>
attribute. The <code class="docutils literal notranslate"><span class="pre">data</span></code> has index = datadate/gvkey and is sorted on gvkey/datadate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date (‘yyyy-mm-dd’). If None, from the earliest.</p></li>
<li><p><strong>edate</strong> – End date (‘yyyy-mm-dd’). If None, to the latest.</p></li>
<li><p><strong>fname</strong> – The funda file name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.merge_with_fundq">
<span class="sig-name descname"><span class="pre">merge_with_fundq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fundq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.merge_with_fundq" title="Link to this definition"></a></dt>
<dd><p>Merge funda with fundq.</p>
<p>Merge funda with quarterly-updated annual data generated from fundq. If a value exists in both data,
funda has the priority.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>JKP create characteristics in funda and fundq separately and merge them, whereas we merge the raw data
first and then generate characteristics. Since some variables in funda are not available in fundq, e.g.,
ebitda, JKP synthesize those unavailable variables with other variables and create characteristics, even when
they are available in funda. We prefer to merge funda with fundq at the raw data level and create
characteristics from the merged data.</p>
<p>Columns in both funda and fundq:</p>
<blockquote>
<div><p>datadate, cusip, cik, sic, naics, sale, revt, cogs, xsga, dp, xrd, ib, nopi, spi, pi, txp, ni, txt, xint,
capx, oancf, gdwlia, gdwlip, rect, act, che, ppegt, invt, at, aco, intan, ao, ppent, gdwl, lct, dlc, dltt,
lt, pstk, ap, lco, lo, drc, drlt, txdi, ceq, scstkc, csho, prcc_f, oibdp, oiadp, mii, xopr, xi, do, xido,
ibc, dpc, xidoc, fincf, fiao, txbcof, dltr, dlcch, prstkc, sstk, dv, ivao, ivst, re, txditc, txdb, seq,
mib, icapt, ajex, curcd, exratd</p>
</div></blockquote>
<p>Columns in funda but not in fundq:</p>
<blockquote>
<div><p>xad, gp, ebitda, ebit, txfed, txfo, dvt, ob, gwo, fatb, fatl, dm, dcvt, cshrc, dcpstk, emp, xlr, ds, dvc,
itcb, pstkrv, pstkl, dltis, ppenb, ppenls</p>
</div></blockquote>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fundq</strong> – <a class="reference internal" href="#pyanomaly.characteristics.FUNDQ" title="pyanomaly.characteristics.FUNDQ"><code class="xref py py-class docutils literal notranslate"><span class="pre">FUNDQ</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.postprocess">
<span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.postprocess" title="Link to this definition"></a></dt>
<dd><p>Postprocess data.</p>
<p>This method deletes temporary variable columns (columns starting with ‘_’) and replaces infinite
values with nan.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.update_variables">
<span class="sig-name descname"><span class="pre">update_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.update_variables" title="Link to this definition"></a></dt>
<dd><p>Preprocess data before creating firm characteristics.</p>
<ol class="arabic simple">
<li><p>Synthesize missing values with other variables.</p></li>
<li><p>Create frequently used variables.</p></li>
</ol>
</dd></dl>

</dd></dl>

</section>
<section id="fundq">
<h3>FUNDQ<a class="headerlink" href="#fundq" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.characteristics.</span></span><span class="sig-name descname"><span class="pre">FUNDQ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanomaly.panel.FCPanel" title="pyanomaly.panel.FCPanel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCPanel</span></code></a></p>
<p>Class to generate firm characteristics from fundq.</p>
<p>The firm characteristics defined in this class can be viewed using <a class="reference internal" href="#pyanomaly.panel.FCPanel.show_available_chars" title="pyanomaly.panel.FCPanel.show_available_chars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">show_available_chars()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias</strong> (<em>str</em><em>, </em><em>list</em><em>, or </em><em>dict</em>) – <p>Firm characteristics to generate and their aliases. If None, all available firm
characteristics are generated.</p>
<ul>
<li><p>str: A column name in the mapping file (<code class="docutils literal notranslate"><span class="pre">config.mapping_file_path</span></code>). The firm characteristics defined
in this class and in the <cite>alias</cite> column of the mapping file are generated. See <a class="reference internal" href="getting_started.html#sec-mapping-file"><span class="std std-ref">Mapping File</span></a>.</p></li>
<li><p>list: List of firm characteristics (method names).</p></li>
<li><p>dict: Dict of firm characteristics and their aliases of the form {method name: alias}.</p></li>
</ul>
<p>If aliases are not specified, method names are used as aliases.</p>
</p></li>
<li><p><strong>data</strong> – DataFrame of fundq data with index = datadate/gvkey, sorted on gvkey/datadate. The fundq data can be
given at initialization or loaded later using <a class="reference internal" href="#pyanomaly.characteristics.FUNDQ.load_data" title="pyanomaly.characteristics.FUNDQ.load_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_data()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.FUNDQ.load_data" title="pyanomaly.characteristics.FUNDQ.load_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_data</span></code></a></p></td>
<td><p>Load fundq data from file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.FUNDQ.remove_duplicates" title="pyanomaly.characteristics.FUNDQ.remove_duplicates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_duplicates</span></code></a></p></td>
<td><p>Drop duplicates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.FUNDQ.convert_currency" title="pyanomaly.characteristics.FUNDQ.convert_currency"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_currency</span></code></a></p></td>
<td><p>Convert currency to USD.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.FUNDQ.create_qitems_from_yitems" title="pyanomaly.characteristics.FUNDQ.create_qitems_from_yitems"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_qitems_from_yitems</span></code></a></p></td>
<td><p>Quarterize ytd items.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.FUNDQ.update_variables" title="pyanomaly.characteristics.FUNDQ.update_variables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_variables</span></code></a></p></td>
<td><p>Preprocess data before creating firm characteristics.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.FUNDQ.postprocess" title="pyanomaly.characteristics.FUNDQ.postprocess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">postprocess</span></code></a></p></td>
<td><p>Postprocess data.</p></td>
</tr>
</tbody>
</table>
<p>Firm characteristic generation methods have a name like <code class="docutils literal notranslate"><span class="pre">c_characteristic()</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_chtx">
<span class="sig-name descname"><span class="pre">c_chtx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_chtx" title="Link to this definition"></a></dt>
<dd><p>Tax expense surprise. Thomas and Zhang (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_ni_inc8q">
<span class="sig-name descname"><span class="pre">c_ni_inc8q</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_ni_inc8q" title="Link to this definition"></a></dt>
<dd><p>Number of consecutive quarters with earnings increases. Barth, Elliott, and Finn (1999)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_niq_at">
<span class="sig-name descname"><span class="pre">c_niq_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_niq_at" title="Link to this definition"></a></dt>
<dd><p>Quarterly return on assets. Balakrishnan, Bartov, and Faurel (2010)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_niq_at_chg1">
<span class="sig-name descname"><span class="pre">c_niq_at_chg1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_niq_at_chg1" title="Link to this definition"></a></dt>
<dd><p>Change in quarterly return on assets. Balakrishnan, Bartov, and Faurel (2010)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_niq_be">
<span class="sig-name descname"><span class="pre">c_niq_be</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_niq_be" title="Link to this definition"></a></dt>
<dd><p>Return on equity (quarterly). Hou, Xue, and Zhang (2015)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_niq_be_chg1">
<span class="sig-name descname"><span class="pre">c_niq_be_chg1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_niq_be_chg1" title="Link to this definition"></a></dt>
<dd><p>Change in quarterly return on equity. Balakrishnan, Bartov, and Faurel (2010)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_niq_su">
<span class="sig-name descname"><span class="pre">c_niq_su</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_niq_su" title="Link to this definition"></a></dt>
<dd><p>Earnings surprise. Foster, Olsen, and Shevlin (1984)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_ocfq_saleq_std">
<span class="sig-name descname"><span class="pre">c_ocfq_saleq_std</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_ocfq_saleq_std" title="Link to this definition"></a></dt>
<dd><p>Cash flow volatility. Huang (2009)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_roavol">
<span class="sig-name descname"><span class="pre">c_roavol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_roavol" title="Link to this definition"></a></dt>
<dd><p>ROA volatility. Francis et al. (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_rsup">
<span class="sig-name descname"><span class="pre">c_rsup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_rsup" title="Link to this definition"></a></dt>
<dd><p>Revenue surprise (Karma). Kama (2009)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_saleq_su">
<span class="sig-name descname"><span class="pre">c_saleq_su</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_saleq_su" title="Link to this definition"></a></dt>
<dd><p>Revenue surprise. Jegadeesh and Livnat (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_stdacc">
<span class="sig-name descname"><span class="pre">c_stdacc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_stdacc" title="Link to this definition"></a></dt>
<dd><p>Accrual volatility. Bandyopadhyay, Huang, and Wirjanto (2010)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.convert_currency">
<span class="sig-name descname"><span class="pre">convert_currency</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.convert_currency" title="Link to this definition"></a></dt>
<dd><p>Convert currency to USD.</p>
<p>Convert the currency of fundq to USD. This method needs to be called if</p>
<blockquote>
<div><ol class="lowerroman simple">
<li><p>the data contains non USD-denominated firms, e.g., CAD; and</p></li>
<li><p>CRSP’s market equity is used, which is always in USD.</p></li>
</ol>
</div></blockquote>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.convert_fund_currency_to_usd" title="pyanomaly.wrdsdata.WRDS.convert_fund_currency_to_usd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WRDS.convert_fund_currency_to_usd()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.create_qitems_from_yitems">
<span class="sig-name descname"><span class="pre">create_qitems_from_yitems</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.create_qitems_from_yitems" title="Link to this definition"></a></dt>
<dd><p>Quarterize ytd items.</p>
<p>Quarterize ytd variables, Xy’s, and use them to fill missing Xq’s (if Xq exists) or to
create new quarterly variables (if Xq does not exist).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.generate_funda_vars">
<span class="sig-name descname"><span class="pre">generate_funda_vars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.generate_funda_vars" title="Link to this definition"></a></dt>
<dd><p>Generate quarterly-updated annual data from fundq.</p>
<p>The following variables are annualized by cumulating over the past 4 quarters.</p>
<blockquote>
<div><p>‘cogs’, ‘xsga’, ‘xint’, ‘dp’, ‘txt’, ‘xrd’, ‘spi’, ‘sale’, ‘revt’,
‘xopr’, ‘oibdp’, ‘oiadp’, ‘ib’, ‘ni’, ‘xido’, ‘nopi’, ‘mii’, ‘pi’, ‘xi’,
‘oancf’, ‘dv’, ‘sstk’, ‘dlcch’, ‘capx’, ‘dltr’, ‘txbcof’, ‘xidoc’, ‘dpc’,
‘fiao’, ‘ibc’, ‘prstkc’, ‘fincf’.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame of quarterly-updated annual data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fundq'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.load_data" title="Link to this definition"></a></dt>
<dd><p>Load fundq data from file.</p>
<p>This method loads fundq data from <code class="docutils literal notranslate"><span class="pre">config.input_dir/comp/fundq</span></code> and stores it in the <code class="docutils literal notranslate"><span class="pre">data</span></code>
attribute. The <code class="docutils literal notranslate"><span class="pre">data</span></code> has index = datadate/gvkey and is sorted on gvkey/datadate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date (‘yyyy-mm-dd’). If None, from the earliest.</p></li>
<li><p><strong>edate</strong> – End date (‘yyyy-mm-dd’). If None, to the latest.</p></li>
<li><p><strong>fname</strong> – The fundq file name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.postprocess">
<span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.postprocess" title="Link to this definition"></a></dt>
<dd><p>Postprocess data.</p>
<p>This method deletes temporary variable columns (columns starting with ‘_’) and replaces infinite
values with nan.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.remove_duplicates">
<span class="sig-name descname"><span class="pre">remove_duplicates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.remove_duplicates" title="Link to this definition"></a></dt>
<dd><p>Drop duplicates.</p>
<p>In fundq, there are duplicate rows (rows with the same datadate and gvekey).
Remove duplicates in the following order:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Remove records with missing fqtr.</p></li>
<li><p>Choose records with the maximum fyearq.</p></li>
<li><p>Choose records with the minimum fqtr.</p></li>
</ol>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.update_variables">
<span class="sig-name descname"><span class="pre">update_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.update_variables" title="Link to this definition"></a></dt>
<dd><p>Preprocess data before creating firm characteristics.</p>
<ol class="arabic simple">
<li><p>Synthesize missing values with other variables.</p></li>
<li><p>Create frequently used variables.</p></li>
</ol>
</dd></dl>

</dd></dl>

</section>
<section id="crspm">
<h3>CRSPM<a class="headerlink" href="#crspm" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.characteristics.</span></span><span class="sig-name descname"><span class="pre">CRSPM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanomaly.panel.FCPanel" title="pyanomaly.panel.FCPanel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCPanel</span></code></a></p>
<p>Class to generate firm characteristics from crspm.</p>
<p>The firm characteristics defined in this class can be viewed using <a class="reference internal" href="#pyanomaly.panel.FCPanel.show_available_chars" title="pyanomaly.panel.FCPanel.show_available_chars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">show_available_chars()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias</strong> (<em>str</em><em>, </em><em>list</em><em>, or </em><em>dict</em>) – <p>Firm characteristics to generate and their aliases. If None, all available firm
characteristics are generated.</p>
<ul>
<li><p>str: A column name in the mapping file (<code class="docutils literal notranslate"><span class="pre">config.mapping_file_path</span></code>). The firm characteristics defined
in this class and in the <cite>alias</cite> column of the mapping file are generated. See <a class="reference internal" href="getting_started.html#sec-mapping-file"><span class="std std-ref">Mapping File</span></a>.</p></li>
<li><p>list: List of firm characteristics (method names).</p></li>
<li><p>dict: Dict of firm characteristics and their aliases of the form {method name: alias}.</p></li>
</ul>
<p>If aliases are not specified, method names are used as aliases.</p>
</p></li>
<li><p><strong>data</strong> – DataFrame of crspm data with index = date/permno, sorted on permno/date. The crspm data can be given at
initialization or loaded later using <a class="reference internal" href="#pyanomaly.characteristics.CRSPM.load_data" title="pyanomaly.characteristics.CRSPM.load_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_data()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPM.load_data" title="pyanomaly.characteristics.CRSPM.load_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_data</span></code></a></p></td>
<td><p>Load crspm data from file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPM.filter_data" title="pyanomaly.characteristics.CRSPM.filter_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_data</span></code></a></p></td>
<td><p>Filter data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPM.update_variables" title="pyanomaly.characteristics.CRSPM.update_variables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_variables</span></code></a></p></td>
<td><p>Preprocess data before creating firm characteristics.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPM.merge_with_factors" title="pyanomaly.characteristics.CRSPM.merge_with_factors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_with_factors</span></code></a></p></td>
<td><p>Merge crspm with factors.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPM.postprocess" title="pyanomaly.characteristics.CRSPM.postprocess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">postprocess</span></code></a></p></td>
<td><p>Postprocess data.</p></td>
</tr>
</tbody>
</table>
<p>Firm characteristic generation methods have a name like <code class="docutils literal notranslate"><span class="pre">c_characteristic()</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_beta_60m">
<span class="sig-name descname"><span class="pre">c_beta_60m</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_beta_60m" title="Link to this definition"></a></dt>
<dd><p>Market beta (Org, JKP). Fama and MacBeth (1973)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_chcsho_12m">
<span class="sig-name descname"><span class="pre">c_chcsho_12m</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_chcsho_12m" title="Link to this definition"></a></dt>
<dd><p>Net stock issues (JKP). Pontiff and Woodgate (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_chmom">
<span class="sig-name descname"><span class="pre">c_chmom</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_chmom" title="Link to this definition"></a></dt>
<dd><p>Change in 6-month momentum. Gettleman and Marks (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_div12m_me">
<span class="sig-name descname"><span class="pre">c_div12m_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_div12m_me" title="Link to this definition"></a></dt>
<dd><p>Dividend yield (JKP). Litzenberger and Ramaswamy (1979)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_divi">
<span class="sig-name descname"><span class="pre">c_divi</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_divi" title="Link to this definition"></a></dt>
<dd><p>Dividend initiation. Michaely, Thaler, and Womack (1995)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_divo">
<span class="sig-name descname"><span class="pre">c_divo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_divo" title="Link to this definition"></a></dt>
<dd><p>Dividend omission. Michaely, Thaler, and Womack (1995)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_dolvol">
<span class="sig-name descname"><span class="pre">c_dolvol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_dolvol" title="Link to this definition"></a></dt>
<dd><p>Dollar trading volume (Org, GHZ). Brennan, Chordia, and Subrahmanyam (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_eqnpo_12m">
<span class="sig-name descname"><span class="pre">c_eqnpo_12m</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_eqnpo_12m" title="Link to this definition"></a></dt>
<dd><p>Composite equity issuance (JKP, 12 months). Daniel and Titman (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_eqnpo_60m">
<span class="sig-name descname"><span class="pre">c_eqnpo_60m</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_eqnpo_60m" title="Link to this definition"></a></dt>
<dd><p>Composite equity issuance (Org). Daniel and Titman (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_indmom">
<span class="sig-name descname"><span class="pre">c_indmom</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_indmom" title="Link to this definition"></a></dt>
<dd><p>Industry momentum. Moskowitz and Grinblatt (1999)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ipo">
<span class="sig-name descname"><span class="pre">c_ipo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ipo" title="Link to this definition"></a></dt>
<dd><p>Initial public offerings. Loughran and Ritter (1995)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_market_equity">
<span class="sig-name descname"><span class="pre">c_market_equity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_market_equity" title="Link to this definition"></a></dt>
<dd><p>Market equity. Banz (1981)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_price">
<span class="sig-name descname"><span class="pre">c_price</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_price" title="Link to this definition"></a></dt>
<dd><p>Share price. Miller and Scholes (1982)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_resff3_12_1">
<span class="sig-name descname"><span class="pre">c_resff3_12_1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_resff3_12_1" title="Link to this definition"></a></dt>
<dd><p>12 month residual momentum. Blitz, Huij, and Martens (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_resff3_6_1">
<span class="sig-name descname"><span class="pre">c_resff3_6_1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_resff3_6_1" title="Link to this definition"></a></dt>
<dd><p>6 month residual momentum. Blitz, Huij, and Martens (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_12_1">
<span class="sig-name descname"><span class="pre">c_ret_12_1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_12_1" title="Link to this definition"></a></dt>
<dd><p>Momentum (12 months). Jegadeesh and Titman (1993)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_12_6">
<span class="sig-name descname"><span class="pre">c_ret_12_6</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_12_6" title="Link to this definition"></a></dt>
<dd><p>Intermediate momentum (7-12). Novy-Marx (2012)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_1_0">
<span class="sig-name descname"><span class="pre">c_ret_1_0</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_1_0" title="Link to this definition"></a></dt>
<dd><p>Short-term reversal. Jegadeesh (1990)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_36_12">
<span class="sig-name descname"><span class="pre">c_ret_36_12</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_36_12" title="Link to this definition"></a></dt>
<dd><p>Long-term reversal (12-36). De Bondt and Thaler (1985)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_3_1">
<span class="sig-name descname"><span class="pre">c_ret_3_1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_3_1" title="Link to this definition"></a></dt>
<dd><p>Momentum (3 months). Jegadeesh and Titman (1993)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_60_12">
<span class="sig-name descname"><span class="pre">c_ret_60_12</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_60_12" title="Link to this definition"></a></dt>
<dd><p>Long-term reversal (12-60). De Bondt and Thaler (1985)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_6_1">
<span class="sig-name descname"><span class="pre">c_ret_6_1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_6_1" title="Link to this definition"></a></dt>
<dd><p>Momentum (6 months). Jegadeesh and Titman (1993)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_9_1">
<span class="sig-name descname"><span class="pre">c_ret_9_1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_9_1" title="Link to this definition"></a></dt>
<dd><p>Momentum (9 months). Jegadeesh and Titman (1993)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_11_15an">
<span class="sig-name descname"><span class="pre">c_seas_11_15an</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_11_15an" title="Link to this definition"></a></dt>
<dd><p>Years 11-15 lagged returns, annual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_11_15na">
<span class="sig-name descname"><span class="pre">c_seas_11_15na</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_11_15na" title="Link to this definition"></a></dt>
<dd><p>Years 11-15 lagged returns, nonannual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_16_20an">
<span class="sig-name descname"><span class="pre">c_seas_16_20an</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_16_20an" title="Link to this definition"></a></dt>
<dd><p>Years 16-20 lagged returns, annual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_16_20na">
<span class="sig-name descname"><span class="pre">c_seas_16_20na</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_16_20na" title="Link to this definition"></a></dt>
<dd><p>Years 16-20 lagged returns, nonannual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_1_1an">
<span class="sig-name descname"><span class="pre">c_seas_1_1an</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_1_1an" title="Link to this definition"></a></dt>
<dd><p>Year 1-lagged return, annual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_1_1na">
<span class="sig-name descname"><span class="pre">c_seas_1_1na</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_1_1na" title="Link to this definition"></a></dt>
<dd><p>Year 1-lagged return, nonannual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_2_5an">
<span class="sig-name descname"><span class="pre">c_seas_2_5an</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_2_5an" title="Link to this definition"></a></dt>
<dd><p>Years 2-5 lagged returns, annual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_2_5na">
<span class="sig-name descname"><span class="pre">c_seas_2_5na</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_2_5na" title="Link to this definition"></a></dt>
<dd><p>Years 2-5 lagged returns, nonannual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_6_10an">
<span class="sig-name descname"><span class="pre">c_seas_6_10an</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_6_10an" title="Link to this definition"></a></dt>
<dd><p>Years 6-10 lagged returns, annual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_6_10na">
<span class="sig-name descname"><span class="pre">c_seas_6_10na</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_6_10na" title="Link to this definition"></a></dt>
<dd><p>Years 6-10 lagged returns, nonannual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_turn">
<span class="sig-name descname"><span class="pre">c_turn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_turn" title="Link to this definition"></a></dt>
<dd><p>Share turnover (Org, GHZ). Datar, Naik, and Radcliffe (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.filter_data">
<span class="sig-name descname"><span class="pre">filter_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.filter_data" title="Link to this definition"></a></dt>
<dd><p>Filter data.</p>
<p>The data is filtered using the following filters:</p>
<blockquote>
<div><ul class="simple">
<li><p>shrcd in [10, 11, 12]</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We do not filter the data using exchange code (exchcd in [1 (NYSE), 2 (ASE), 3 (NASDAQ)]) because exchcd
can change when a stock is delisted: If the data is filtered using exchcd, the data of the delist month can
be lost.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'crspm'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.load_data" title="Link to this definition"></a></dt>
<dd><p>Load crspm data from file.</p>
<p>This method loads crspm data from <code class="docutils literal notranslate"><span class="pre">config.input_dir/crspm</span></code> and stores it in the <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute.
The <code class="docutils literal notranslate"><span class="pre">data</span></code> has index = date/permno and is sorted on permno/date.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In CRSP monthly tables, date is the last business day of the month, whereas datadate in Compustat is the
end-of-month date. To make the two dates consistent, crspm dates are shifted to the end of the month.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date (‘yyyy-mm-dd’). If None, from the earliest.</p></li>
<li><p><strong>edate</strong> – End date (‘yyyy-mm-dd’). If None, to the latest.</p></li>
<li><p><strong>fname</strong> – The crspm file name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.merge_with_factors">
<span class="sig-name descname"><span class="pre">merge_with_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.merge_with_factors" title="Link to this definition"></a></dt>
<dd><p>Merge crspm with factors.</p>
<p>The <cite>factors</cite> should contain Fama-French 3 factors with column names as defined in <code class="docutils literal notranslate"><span class="pre">config.factor_names</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>factors</strong> – DataFrame of factors with index = date or list of factors. If None or list, factor data will be
read from <code class="docutils literal notranslate"><span class="pre">config.monthly_factors_fname</span></code> and only the factors in <cite>factors</cite> will be merged.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.postprocess">
<span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.postprocess" title="Link to this definition"></a></dt>
<dd><p>Postprocess data.</p>
<p>This method deletes temporary variable columns (columns starting with ‘_’) and replaces infinite
values with nan.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.update_variables">
<span class="sig-name descname"><span class="pre">update_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.update_variables" title="Link to this definition"></a></dt>
<dd><p>Preprocess data before creating firm characteristics.</p>
<ul class="simple">
<li><p>Convert negative prices (quotes) to positive.</p></li>
<li><p>Convert shares outstanding (shrout) unit from thousands to millions (divide by 1000).</p></li>
<li><p>Convert trading volume (vol) unit from 100 shares to shares (multiply by 100).</p></li>
<li><p>Adjust trading volume following Gao and Ritter (2010).</p></li>
<li><p>Create frequently used variables.</p></li>
</ul>
</dd></dl>

</dd></dl>

</section>
<section id="crspd">
<h3>CRSPD<a class="headerlink" href="#crspd" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPDRaw">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.characteristics.</span></span><span class="sig-name descname"><span class="pre">CRSPDRaw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPDRaw" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanomaly.panel.FCPanel" title="pyanomaly.panel.FCPanel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCPanel</span></code></a></p>
<p>Class that handles crspd data.</p>
<p>This class contains daily crspd data and is used to generate monthly firm characteristics in <a class="reference internal" href="#pyanomaly.characteristics.CRSPD" title="pyanomaly.characteristics.CRSPD"><code class="xref py py-class docutils literal notranslate"><span class="pre">CRSPD</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias</strong> (<em>str</em><em>, </em><em>list</em><em>, or </em><em>dict</em>) – <p>Firm characteristics to generate and their aliases. If None, all available firm
characteristics are generated.</p>
<ul>
<li><p>str: A column name in the mapping file (<code class="docutils literal notranslate"><span class="pre">config.mapping_file_path</span></code>). The firm characteristics defined
in this class and in the <cite>alias</cite> column of the mapping file are generated. See <a class="reference internal" href="getting_started.html#sec-mapping-file"><span class="std std-ref">Mapping File</span></a>.</p></li>
<li><p>list: List of firm characteristics (method names).</p></li>
<li><p>dict: Dict of firm characteristics and their aliases of the form {method name: alias}.</p></li>
</ul>
<p>If aliases are not specified, method names are used as aliases.</p>
</p></li>
<li><p><strong>data</strong> – DataFrame of crspd data with index = date/permno, sorted on permno/date. The crspd data can be given at
initialization or loaded later using <a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw.load_data" title="pyanomaly.characteristics.CRSPDRaw.load_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_data()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw.load_data" title="pyanomaly.characteristics.CRSPDRaw.load_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_data</span></code></a></p></td>
<td><p>Load crspd data from file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw.filter_data" title="pyanomaly.characteristics.CRSPDRaw.filter_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_data</span></code></a></p></td>
<td><p>Filter data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw.update_variables" title="pyanomaly.characteristics.CRSPDRaw.update_variables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_variables</span></code></a></p></td>
<td><p>Preprocess data before creating firm characteristics.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw.merge_with_factors" title="pyanomaly.characteristics.CRSPDRaw.merge_with_factors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_with_factors</span></code></a></p></td>
<td><p>Merge crspd with factors.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw.get_idym_group" title="pyanomaly.characteristics.CRSPDRaw.get_idym_group"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_idym_group</span></code></a></p></td>
<td><p>Get id-month group.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw.get_idym_group_size" title="pyanomaly.characteristics.CRSPDRaw.get_idym_group_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_idym_group_size</span></code></a></p></td>
<td><p>Get id-month group sizes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw.apply_to_idyms" title="pyanomaly.characteristics.CRSPDRaw.apply_to_idyms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_to_idyms</span></code></a></p></td>
<td><p>Apply a function to each id-month group.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPDRaw.apply_to_idyms">
<span class="sig-name descname"><span class="pre">apply_to_idyms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ret</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPDRaw.apply_to_idyms" title="Link to this definition"></a></dt>
<dd><p>Apply a function to each id-month group.</p>
<p>This method groups <cite>data</cite> by id-month and applies <cite>function</cite> to each group.
This method can be used when the <cite>function</cite> is a reduce function and requires only the data within the month.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame, Series, ndarray, or (list of) columns. It should have the same length and order as the
<code class="docutils literal notranslate"><span class="pre">data</span></code> attribute.</p></li>
<li><p><strong>function</strong> – Jitted reduce function to apply to groups. Its arguments should be (<cite>gbdata</cite>, <cite>*args</cite>) or
(<cite>gbdata</cite>, <cite>gbdata2</cite>, <cite>*args</cite>), where <cite>gbdata</cite> (<cite>gbdata2</cite>) is a group of <cite>data</cite> (<cite>data2</cite>).</p></li>
<li><p><strong>n_ret</strong> – Number of returns of <cite>function</cite>. If None, it is assumed to be the same as the column size of <cite>data</cite>.</p></li>
<li><p><strong>*args</strong> – Additional arguments of <cite>function</cite>.</p></li>
<li><p><strong>data2</strong> – DataFrame, Series, ndarray, str, or int. Optional argument when <cite>function</cite> requires two sets of
input data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Concatenated value of the outputs of <cite>function</cite>. Size = (number of id-month groups) x <cite>n_retval</cite>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyanomaly.datatools.apply_to_groups_reduce_jit" title="pyanomaly.datatools.apply_to_groups_reduce_jit"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups_reduce_jit()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPDRaw.filter_data">
<span class="sig-name descname"><span class="pre">filter_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPDRaw.filter_data" title="Link to this definition"></a></dt>
<dd><p>Filter data.</p>
<p>The data is filtered using the following filters:</p>
<blockquote>
<div><ul class="simple">
<li><p>shrcd in [10, 11, 12]</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We do not filter the data using exchange code (exchcd in [1 (NYSE), 2 (ASE), 3 (NASDAQ)]) because exchcd
can change when a stock is delisted: If the data is filtered using exchcd, the data of the delist month can
be lost.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPDRaw.get_idym_group">
<span class="sig-name descname"><span class="pre">get_idym_group</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPDRaw.get_idym_group" title="Link to this definition"></a></dt>
<dd><p>Get id-month group.</p>
<p>Group <code class="docutils literal notranslate"><span class="pre">data</span></code> by permno and year-month and return the GroupBy object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pandas GroupBy object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPDRaw.get_idym_group_size">
<span class="sig-name descname"><span class="pre">get_idym_group_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPDRaw.get_idym_group_size" title="Link to this definition"></a></dt>
<dd><p>Get id-month group sizes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Ndarray of id-month group sizes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPDRaw.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'crspd'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPDRaw.load_data" title="Link to this definition"></a></dt>
<dd><p>Load crspd data from file.</p>
<p>This method loads crspd data from <code class="docutils literal notranslate"><span class="pre">config.input_dir/crspd</span></code> and stores it in the <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute.
The <code class="docutils literal notranslate"><span class="pre">data</span></code> has index = date/permno and is sorted on permno/date.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date (‘yyyy-mm-dd’). If None, from the earliest.</p></li>
<li><p><strong>edate</strong> – End date (‘yyyy-mm-dd’). If None, to the latest.</p></li>
<li><p><strong>fname</strong> – The crspd file name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPDRaw.merge_with_factors">
<span class="sig-name descname"><span class="pre">merge_with_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPDRaw.merge_with_factors" title="Link to this definition"></a></dt>
<dd><p>Merge crspd with factors.</p>
<p>The <cite>factors</cite> should contain Fama-French 3 factors and Hou-Xue-Zhang 4 factors with column names as defined
in <code class="docutils literal notranslate"><span class="pre">config.factor_names</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>factors</strong> – DataFrame of factors with index = date or list of factors. If None or list, factor data will be
read from <code class="docutils literal notranslate"><span class="pre">config.daily_factors_fname</span></code> and only the factors in <cite>factors</cite> will be merged.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPDRaw.update_variables">
<span class="sig-name descname"><span class="pre">update_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPDRaw.update_variables" title="Link to this definition"></a></dt>
<dd><p>Preprocess data before creating firm characteristics.</p>
<ul class="simple">
<li><p>Convert negative prices (quotes) to positive.</p></li>
<li><p>Set askhi and bidlo to nan if it is negative, the price is negative, or the volume is 0.</p></li>
<li><p>Conver cfacpr of 0 to nan.</p></li>
<li><p>Convert shares outstanding (shrout) unit from thousands to millions (divide by 1000).</p></li>
<li><p>Adjust trading volume following Gao and Ritter (2010).</p></li>
<li><p>Create frequently used variables.</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.characteristics.</span></span><span class="sig-name descname"><span class="pre">CRSPD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanomaly.panel.FCPanel" title="pyanomaly.panel.FCPanel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCPanel</span></code></a></p>
<p>Class to generate firm characteristics from crspd.</p>
<p>This class has a <code class="docutils literal notranslate"><span class="pre">CRSPDRaw</span></code> object as a member attribute and use it to generate monthly firm characteristics.
<code class="docutils literal notranslate"><span class="pre">CRSPDRaw.data</span></code> contains daily crspd data and <code class="docutils literal notranslate"><span class="pre">CRSPD.data</span></code> contains monthly firm characteristics.
The firm characteristics defined in this class can be viewed using <a class="reference internal" href="#pyanomaly.panel.FCPanel.show_available_chars" title="pyanomaly.panel.FCPanel.show_available_chars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">show_available_chars()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias</strong> (<em>str</em><em>, </em><em>list</em><em>, or </em><em>dict</em>) – <p>Firm characteristics to generate and their aliases. If None, all available firm
characteristics are generated.</p>
<ul>
<li><p>str: A column name in the mapping file (<code class="docutils literal notranslate"><span class="pre">config.mapping_file_path</span></code>). The firm characteristics defined
in this class and in the <cite>alias</cite> column of the mapping file are generated. See <a class="reference internal" href="getting_started.html#sec-mapping-file"><span class="std std-ref">Mapping File</span></a>.</p></li>
<li><p>list: List of firm characteristics (method names).</p></li>
<li><p>dict: Dict of firm characteristics and their aliases of the form {method name: alias}.</p></li>
</ul>
<p>If aliases are not specified, method names are used as aliases.</p>
</p></li>
<li><p><strong>data</strong> – DataFrame of crspd data with index = date/permno, sorted on permno/date. The crspd data can be given at
initialization or loaded later using <a class="reference internal" href="#pyanomaly.characteristics.CRSPD.load_data" title="pyanomaly.characteristics.CRSPD.load_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_data()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p><strong>Attributes</strong></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.cd">
<span class="sig-name descname"><span class="pre">cd</span></span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.cd" title="Link to this definition"></a></dt>
<dd><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw" title="pyanomaly.characteristics.CRSPDRaw"><code class="xref py py-class docutils literal notranslate"><span class="pre">CRSPDRaw</span></code></a> object that stores daily crspd data.</p>
</dd></dl>

<p><strong>Methods</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPD.load_data" title="pyanomaly.characteristics.CRSPD.load_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_data</span></code></a></p></td>
<td><p>Load crspd data from file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPD.filter_data" title="pyanomaly.characteristics.CRSPD.filter_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_data</span></code></a></p></td>
<td><p>Filter data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPD.update_variables" title="pyanomaly.characteristics.CRSPD.update_variables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_variables</span></code></a></p></td>
<td><p>Preprocess data before creating firm characteristics.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPD.merge_with_factors" title="pyanomaly.characteristics.CRSPD.merge_with_factors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_with_factors</span></code></a></p></td>
<td><p>Merge crspd with factors.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPD.postprocess" title="pyanomaly.characteristics.CRSPD.postprocess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">postprocess</span></code></a></p></td>
<td><p>Postprocess data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPD.get_idym_group" title="pyanomaly.characteristics.CRSPD.get_idym_group"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_idym_group</span></code></a></p></td>
<td><p>Get id-month group.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.CRSPD.get_idym_group_size" title="pyanomaly.characteristics.CRSPD.get_idym_group_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_idym_group_size</span></code></a></p></td>
<td><p>Get id-month group sizes.</p></td>
</tr>
</tbody>
</table>
<p>Firm characteristic generation methods have a name like <code class="docutils literal notranslate"><span class="pre">c_characteristic()</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_ami_126d">
<span class="sig-name descname"><span class="pre">c_ami_126d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_ami_126d" title="Link to this definition"></a></dt>
<dd><p>Illiquidity. Amihud (2002)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_baspread">
<span class="sig-name descname"><span class="pre">c_baspread</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_baspread" title="Link to this definition"></a></dt>
<dd><p>Bid-ask spread. Amihud and Mendelson (1986)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_beta">
<span class="sig-name descname"><span class="pre">c_beta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_beta" title="Link to this definition"></a></dt>
<dd><p>Market beta  (GHZ). Fama and MacBeth (1973)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_beta_dimson_21d">
<span class="sig-name descname"><span class="pre">c_beta_dimson_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_beta_dimson_21d" title="Link to this definition"></a></dt>
<dd><p>Dimson Beta. Dimson (1979)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_betabab_1260d">
<span class="sig-name descname"><span class="pre">c_betabab_1260d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_betabab_1260d" title="Link to this definition"></a></dt>
<dd><p>Frazzini-Pedersen beta. Frazzini and Pedersen (2014)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_betadown_252d">
<span class="sig-name descname"><span class="pre">c_betadown_252d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_betadown_252d" title="Link to this definition"></a></dt>
<dd><p>Downside beta. Ang, Chen, and Xing (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_betasq">
<span class="sig-name descname"><span class="pre">c_betasq</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_betasq" title="Link to this definition"></a></dt>
<dd><p>Beta squared (GHZ). Fama and MacBeth (1973)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_bidaskhl_21d">
<span class="sig-name descname"><span class="pre">c_bidaskhl_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_bidaskhl_21d" title="Link to this definition"></a></dt>
<dd><p>High-low bid-ask spread. Corwin and Schultz (2012)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_corr_1260d">
<span class="sig-name descname"><span class="pre">c_corr_1260d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_corr_1260d" title="Link to this definition"></a></dt>
<dd><p>Market correlation. Assness et al. (2020)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_coskew_21d">
<span class="sig-name descname"><span class="pre">c_coskew_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_coskew_21d" title="Link to this definition"></a></dt>
<dd><p>Coskewness. Harvey and Siddique (2000)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_dolvol_126d">
<span class="sig-name descname"><span class="pre">c_dolvol_126d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_dolvol_126d" title="Link to this definition"></a></dt>
<dd><p>Dollar trading volume (JKP). Brennan, Chordia, and Subrahmanyam (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_dolvol_var_126d">
<span class="sig-name descname"><span class="pre">c_dolvol_var_126d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_dolvol_var_126d" title="Link to this definition"></a></dt>
<dd><p>Volatility of dollar trading volume (JKP). Chordia, Subrahmanyam, and Anshuman (2001)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_idiovol">
<span class="sig-name descname"><span class="pre">c_idiovol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_idiovol" title="Link to this definition"></a></dt>
<dd><p>Idiosyncratic volatility (GHZ). Ali, Hwang, and Trombley (2003)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_iskew_capm_21d">
<span class="sig-name descname"><span class="pre">c_iskew_capm_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_iskew_capm_21d" title="Link to this definition"></a></dt>
<dd><p>Idiosyncratic skewness (CAPM). Bali, Engle, and Murray (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_iskew_ff3_21d">
<span class="sig-name descname"><span class="pre">c_iskew_ff3_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_iskew_ff3_21d" title="Link to this definition"></a></dt>
<dd><p>Idiosyncratic skewness (FF3). Bali, Engle, and Murray (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_iskew_hxz4_21d">
<span class="sig-name descname"><span class="pre">c_iskew_hxz4_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_iskew_hxz4_21d" title="Link to this definition"></a></dt>
<dd><p>Idiosyncratic skewness (HXZ). Bali, Engle, and Murray (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_ivol_capm_21d">
<span class="sig-name descname"><span class="pre">c_ivol_capm_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_ivol_capm_21d" title="Link to this definition"></a></dt>
<dd><p>Idiosyncratic volatility (CAPM). Ang et al. (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_ivol_capm_252d">
<span class="sig-name descname"><span class="pre">c_ivol_capm_252d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_ivol_capm_252d" title="Link to this definition"></a></dt>
<dd><p>Idiosyncratic volatility (Org, JKP). Ali, Hwang, and Trombley (2003)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_ivol_ff3_21d">
<span class="sig-name descname"><span class="pre">c_ivol_ff3_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_ivol_ff3_21d" title="Link to this definition"></a></dt>
<dd><p>Idiosyncratic volatility (FF3). Ang et al. (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_ivol_hxz4_21d">
<span class="sig-name descname"><span class="pre">c_ivol_hxz4_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_ivol_hxz4_21d" title="Link to this definition"></a></dt>
<dd><p>Idiosyncratic volatility (HXZ). Ang et al. (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_prc_highprc_252d">
<span class="sig-name descname"><span class="pre">c_prc_highprc_252d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_prc_highprc_252d" title="Link to this definition"></a></dt>
<dd><p>52-week high. George and Hwang (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_pricedelay">
<span class="sig-name descname"><span class="pre">c_pricedelay</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_pricedelay" title="Link to this definition"></a></dt>
<dd><p>Price delay based on R-squared. Hou and Moskowitz (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_pricedelay_slope">
<span class="sig-name descname"><span class="pre">c_pricedelay_slope</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_pricedelay_slope" title="Link to this definition"></a></dt>
<dd><p>Price delay based on slopes. Hou and Moskowitz (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_retvol">
<span class="sig-name descname"><span class="pre">c_retvol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_retvol" title="Link to this definition"></a></dt>
<dd><p>Return volatility. Ang et al. (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_rmax1_21d">
<span class="sig-name descname"><span class="pre">c_rmax1_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_rmax1_21d" title="Link to this definition"></a></dt>
<dd><p>Maximum daily return. Bali, Cakici, and Whitelaw (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_rmax5_21d">
<span class="sig-name descname"><span class="pre">c_rmax5_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_rmax5_21d" title="Link to this definition"></a></dt>
<dd><p>Highest 5 days of return. Bali, Brown, and Tang (2017)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_rmax5_rvol_21d">
<span class="sig-name descname"><span class="pre">c_rmax5_rvol_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_rmax5_rvol_21d" title="Link to this definition"></a></dt>
<dd><p>Highest 5 days of return to volatility. Assness et al. (2020)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_rskew_21d">
<span class="sig-name descname"><span class="pre">c_rskew_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_rskew_21d" title="Link to this definition"></a></dt>
<dd><p>Return skewness. Bali, Engle, and Murray (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_std_dolvol">
<span class="sig-name descname"><span class="pre">c_std_dolvol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_std_dolvol" title="Link to this definition"></a></dt>
<dd><p>Volatility of dollar trading volume (GHZ). Chordia, Subrahmanyam, and Anshuman (2001)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_std_turn">
<span class="sig-name descname"><span class="pre">c_std_turn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_std_turn" title="Link to this definition"></a></dt>
<dd><p>Volatility of share turnover (GHZ). Chordia, Subrahmanyam, and Anshuman (2001)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_trend_factor">
<span class="sig-name descname"><span class="pre">c_trend_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_trend_factor" title="Link to this definition"></a></dt>
<dd><p>Trend factor. Han, Zhou, and Zhu (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_turnover_126d">
<span class="sig-name descname"><span class="pre">c_turnover_126d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_turnover_126d" title="Link to this definition"></a></dt>
<dd><p>Share turnover (JKP). Datar, Naik, and Radcliffe (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_turnover_var_126d">
<span class="sig-name descname"><span class="pre">c_turnover_var_126d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_turnover_var_126d" title="Link to this definition"></a></dt>
<dd><p>Volatility of share turnover (JKP). Chordia, Subrahmanyam, and Anshuman (2001)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_zero_trades_126d">
<span class="sig-name descname"><span class="pre">c_zero_trades_126d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_zero_trades_126d" title="Link to this definition"></a></dt>
<dd><p>Zero-trading days (6 months). Liu (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_zero_trades_21d">
<span class="sig-name descname"><span class="pre">c_zero_trades_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_zero_trades_21d" title="Link to this definition"></a></dt>
<dd><p>Zero-trading days (1 month). Liu (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_zero_trades_252d">
<span class="sig-name descname"><span class="pre">c_zero_trades_252d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_zero_trades_252d" title="Link to this definition"></a></dt>
<dd><p>Zero-trading days (12 months). Liu (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.filter_data">
<span class="sig-name descname"><span class="pre">filter_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.filter_data" title="Link to this definition"></a></dt>
<dd><p>Filter data.</p>
<p>This is a wrapping method of <a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw.filter_data" title="pyanomaly.characteristics.CRSPDRaw.filter_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CRSPDRaw.filter_data()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.get_idym_group">
<span class="sig-name descname"><span class="pre">get_idym_group</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.get_idym_group" title="Link to this definition"></a></dt>
<dd><p>Get id-month group.</p>
<p>This is a wrapping method of <a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw.get_idym_group" title="pyanomaly.characteristics.CRSPDRaw.get_idym_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CRSPDRaw.get_idym_group()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.get_idym_group_size">
<span class="sig-name descname"><span class="pre">get_idym_group_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.get_idym_group_size" title="Link to this definition"></a></dt>
<dd><p>Get id-month group sizes.</p>
<p>This is a wrapping method of <a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw.get_idym_group_size" title="pyanomaly.characteristics.CRSPDRaw.get_idym_group_size"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CRSPDRaw.get_idym_group_size()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'crspd'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.load_data" title="Link to this definition"></a></dt>
<dd><p>Load crspd data from file.</p>
<p>This is a wrapping method of <a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw.load_data" title="pyanomaly.characteristics.CRSPDRaw.load_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CRSPDRaw.load_data()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.merge_with_factors">
<span class="sig-name descname"><span class="pre">merge_with_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.merge_with_factors" title="Link to this definition"></a></dt>
<dd><p>Merge crspd with factors.</p>
<p>This is a wrapping method of <a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw.merge_with_factors" title="pyanomaly.characteristics.CRSPDRaw.merge_with_factors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CRSPDRaw.merge_with_factors()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.postprocess">
<span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.postprocess" title="Link to this definition"></a></dt>
<dd><p>Postprocess data.</p>
<p>This method deletes temporary variable columns (columns starting with ‘_’) and replaces infinite
values with nan.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.update_variables">
<span class="sig-name descname"><span class="pre">update_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.update_variables" title="Link to this definition"></a></dt>
<dd><p>Preprocess data before creating firm characteristics.</p>
<p>This method calls <a class="reference internal" href="#pyanomaly.characteristics.CRSPDRaw.update_variables" title="pyanomaly.characteristics.CRSPDRaw.update_variables"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CRSPDRaw.update_variables()</span></code></a> to update variables and initializes the <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute.</p>
</dd></dl>

</dd></dl>

</section>
<section id="merge">
<h3>Merge<a class="headerlink" href="#merge" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.characteristics.</span></span><span class="sig-name descname"><span class="pre">Merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanomaly.panel.FCPanel" title="pyanomaly.panel.FCPanel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCPanel</span></code></a></p>
<p>Class to generate firm characteristics from a combined dataset of crspm, crspd, funda, and fundq.</p>
<p>The firm characteristics defined in this class can be viewed using <a class="reference internal" href="#pyanomaly.panel.FCPanel.show_available_chars" title="pyanomaly.panel.FCPanel.show_available_chars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">show_available_chars()</span></code></a>.</p>
<p><strong>Methods</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.characteristics.Merge.preprocess" title="pyanomaly.characteristics.Merge.preprocess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">preprocess</span></code></a></p></td>
<td><p>Merge crspm, crspd, funda, and fundq.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.characteristics.Merge.postprocess" title="pyanomaly.characteristics.Merge.postprocess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">postprocess</span></code></a></p></td>
<td><p>Postprocess data.</p></td>
</tr>
</tbody>
</table>
<p>Firm characteristic generation methods have a name like <code class="docutils literal notranslate"><span class="pre">c_characteristic()</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.c_age">
<span class="sig-name descname"><span class="pre">c_age</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.c_age" title="Link to this definition"></a></dt>
<dd><p>Firm age. Jiang, Lee, and Zhang (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.c_mispricing_mgmt">
<span class="sig-name descname"><span class="pre">c_mispricing_mgmt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.c_mispricing_mgmt" title="Link to this definition"></a></dt>
<dd><p>Mispricing factor: Management. Stambaugh and Yuan (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.c_mispricing_perf">
<span class="sig-name descname"><span class="pre">c_mispricing_perf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.c_mispricing_perf" title="Link to this definition"></a></dt>
<dd><p>Mispricing factor: Performance. Stambaugh and Yuan (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.c_qmj">
<span class="sig-name descname"><span class="pre">c_qmj</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.c_qmj" title="Link to this definition"></a></dt>
<dd><p>Quality minus Junk: Composite. Assness, Frazzini, and Pedersen (2018)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.c_qmj_growth">
<span class="sig-name descname"><span class="pre">c_qmj_growth</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.c_qmj_growth" title="Link to this definition"></a></dt>
<dd><p>Quality minus Junk: Growth. Assness, Frazzini, and Pedersen (2018)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.c_qmj_prof">
<span class="sig-name descname"><span class="pre">c_qmj_prof</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.c_qmj_prof" title="Link to this definition"></a></dt>
<dd><p>Quality minus Junk: Profitability. Assness, Frazzini, and Pedersen (2018)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.c_qmj_safety">
<span class="sig-name descname"><span class="pre">c_qmj_safety</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.c_qmj_safety" title="Link to this definition"></a></dt>
<dd><p>Quality minus Junk: Safety. Assness, Frazzini, and Pedersen (2018)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.postprocess">
<span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.postprocess" title="Link to this definition"></a></dt>
<dd><p>Postprocess data.</p>
<p>This method deletes temporary variable columns (columns starting with ‘_’) and replaces infinite
values with nan.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.preprocess">
<span class="sig-name descname"><span class="pre">preprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crspm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crspd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">funda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fundq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.preprocess" title="Link to this definition"></a></dt>
<dd><p>Merge crspm, crspd, funda, and fundq.</p>
<p>The crspd, funda, and fundq are left-joined to crspm, and the resulting data has index = date/permno.
The frequency of the final data is the same as the frequency of crspm data. This method also checks
if “ingredient” firm characteristics have been generated and generates them if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crspm</strong> – <a class="reference internal" href="#pyanomaly.characteristics.CRSPM" title="pyanomaly.characteristics.CRSPM"><code class="xref py py-class docutils literal notranslate"><span class="pre">CRSPM</span></code></a> instance.</p></li>
<li><p><strong>crspd</strong> – <a class="reference internal" href="#pyanomaly.characteristics.CRSPD" title="pyanomaly.characteristics.CRSPD"><code class="xref py py-class docutils literal notranslate"><span class="pre">CRSPD</span></code></a> instance.</p></li>
<li><p><strong>funda</strong> – <a class="reference internal" href="#pyanomaly.characteristics.FUNDA" title="pyanomaly.characteristics.FUNDA"><code class="xref py py-class docutils literal notranslate"><span class="pre">FUNDA</span></code></a> instance.</p></li>
<li><p><strong>fundq</strong> – <a class="reference internal" href="#pyanomaly.characteristics.FUNDQ" title="pyanomaly.characteristics.FUNDQ"><code class="xref py py-class docutils literal notranslate"><span class="pre">FUNDQ</span></code></a> instance.</p></li>
<li><p><strong>delete_data</strong> – True to delete the data of crspm, crspd, funda, and fundq after merge to save memory.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="module-pyanomaly.config">
<span id="config"></span><h2>config<a class="headerlink" href="#module-pyanomaly.config" title="Link to this heading"></a></h2>
<p>This module defines functions to set/get package configuration.</p>
<p>A configuration can be accessed by either <code class="docutils literal notranslate"><span class="pre">get_config(attr)</span></code> or <code class="docutils literal notranslate"><span class="pre">config.attr</span></code>.</p>
<p><strong>Configurations</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>input_dir</p></td>
<td><p>Input file top-level directory</p></td>
<td><p>‘./input/’</p></td>
</tr>
<tr class="row-odd"><td><p>output_dir</p></td>
<td><p>Output file top-level directory</p></td>
<td><p>‘./output/’</p></td>
</tr>
<tr class="row-even"><td><p>log_dir</p></td>
<td><p>Log file directory</p></td>
<td><p>‘./log/’</p></td>
</tr>
<tr class="row-odd"><td><p>mapping_file_path</p></td>
<td><p>Function-characteristic mapping file path</p></td>
<td><p>‘./mapping.xlsx’</p></td>
</tr>
<tr class="row-even"><td><p>factors_monthly_fname</p></td>
<td><p>Monthly factor file name</p></td>
<td><p>‘factors_monthly’</p></td>
</tr>
<tr class="row-odd"><td><p>factors_daily_fname</p></td>
<td><p>Daily  factor file name</p></td>
<td><p>‘factors_daily’</p></td>
</tr>
<tr class="row-even"><td><p>factor_names</p></td>
<td><p>Factor name mapping dictionary. The keys are the factor names used in PyAnomaly and the values
are the factor names in monthly(daily) factor file. This configuration can be used when factor files are
obtained externally and have different factor names.</p></td>
<td><p>{‘rf’: ‘rf’, ‘mktrf’: ‘mktrf’, ‘smb_ff’: ‘smb_ff’,
‘hml’: ‘hml’, ‘smb_ff5’: ‘smb_ff5’, ‘rmw’: ‘rmw’, ‘cma’: ‘cma’, ‘smb_hxz’: ‘smb_hxz’, ‘inv’: ‘inv’,
‘roe’: ‘roe’, ‘smb_sy’: ‘smb_sy’, ‘mgmg’: ‘mgmt’, ‘perf’: ‘perf’}</p></td>
</tr>
<tr class="row-odd"><td><p>replicate_jkp</p></td>
<td><p>Whether to replicate JKP version. True or False</p></td>
<td><p>False</p></td>
</tr>
<tr class="row-even"><td><p>float_type</p></td>
<td><p>Float data type. ‘float32’ or ‘float64’</p></td>
<td><p>‘float64’</p></td>
</tr>
<tr class="row-odd"><td><p>file_format</p></td>
<td><p>File format used to save data. ‘pickle’ or ‘parquet’</p></td>
<td><p>‘pickle’</p></td>
</tr>
<tr class="row-even"><td><p>disable_jit</p></td>
<td><p>Disable jitting. Applicable only to non-cached jitted functions.</p></td>
<td><p>False</p></td>
</tr>
<tr class="row-odd"><td><p>jit_parallel</p></td>
<td><p>Enable parallel looping in jitted functions.</p></td>
<td><p>True</p></td>
</tr>
<tr class="row-even"><td><p>numba_num_threads</p></td>
<td><p>Number of threads used in Numba parallel mode. Should be fewer than the number of CPU
cores.</p></td>
<td><p>Number of CPU cores</p></td>
</tr>
<tr class="row-odd"><td><p>debug</p></td>
<td><p>Print debugging messages.</p></td>
<td><p>False</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Factor model</p></th>
<th class="head"><p>Factors</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Fama and French 3-factor model</p></td>
<td><p>mktrf, smb_ff, hml</p></td>
</tr>
<tr class="row-odd"><td><p>Fama and French 5-factor model</p></td>
<td><p>mktrf, smb_ff5, hml, rmw, cma</p></td>
</tr>
<tr class="row-even"><td><p>Hou, Xu, and Zhang 4-factor model</p></td>
<td><p>mktrf, smb_hxz, inv, roe</p></td>
</tr>
<tr class="row-odd"><td><p>Stambaugh and Yuan 4-factor model</p></td>
<td><p>mktrf, smb_sy, mgmt, perf</p></td>
</tr>
</tbody>
</table>
<p><strong>Methods</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.config.set_config" title="pyanomaly.config.set_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_config</span></code></a></p></td>
<td><p>Set configuration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.config.get_config" title="pyanomaly.config.get_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_config</span></code></a></p></td>
<td><p>Get configuration.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.config.get_config">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.config.</span></span><span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.config.get_config" title="Link to this definition"></a></dt>
<dd><p>Get configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>attr</strong> – String. A configuration attribute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the attribute.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_config</span><span class="p">(</span><span class="s1">&#39;input_dir&#39;</span><span class="p">)</span>
<span class="go">&#39;./input/&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.config.set_config">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.config.</span></span><span class="sig-name descname"><span class="pre">set_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.config.set_config" title="Link to this definition"></a></dt>
<dd><p>Set configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Keword arguments of configuration attributes and their values.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Change the float type to ‘float32’.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">set_config</span><span class="p">(</span><span class="n">float_type</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Set input and output directories to ‘./my_input/’ and ‘./my_output/’, respectively.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">set_config</span><span class="p">(</span><span class="n">input_dir</span><span class="o">=</span><span class="s1">&#39;./my_input/&#39;</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="s1">&#39;./my_output&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pyanomaly.datatools">
<span id="datatools"></span><h2>datatools<a class="headerlink" href="#module-pyanomaly.datatools" title="Link to this heading"></a></h2>
<p>This module defines functions for data handling.</p>
<p><strong>Group-and-Apply</strong></p>
<blockquote>
<div><table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.datatools.apply_to_groups" title="pyanomaly.datatools.apply_to_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_to_groups</span></code></a></p></td>
<td><p>Group data and apply a function to each group.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.datatools.apply_to_groups_jit" title="pyanomaly.datatools.apply_to_groups_jit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_to_groups_jit</span></code></a></p></td>
<td><p>Group data and apply a function to each group (jitted version).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.datatools.apply_to_groups_reduce_jit" title="pyanomaly.datatools.apply_to_groups_reduce_jit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_to_groups_reduce_jit</span></code></a></p></td>
<td><p>Group data and apply a reduce function to each group (jitted version).</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p><strong>Classify/Trim/Filter/Winsorize</strong></p>
<blockquote>
<div><table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.datatools.classify" title="pyanomaly.datatools.classify"><code class="xref py py-obj docutils literal notranslate"><span class="pre">classify</span></code></a></p></td>
<td><p>Classify array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.datatools.trim" title="pyanomaly.datatools.trim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trim</span></code></a></p></td>
<td><p>Trim array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.datatools.filter" title="pyanomaly.datatools.filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code></a></p></td>
<td><p>Filter data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.datatools.winsorize" title="pyanomaly.datatools.winsorize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">winsorize</span></code></a></p></td>
<td><p>Winsorize array.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p><strong>Merge/Populate/Shift</strong></p>
<blockquote>
<div><table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.datatools.merge" title="pyanomaly.datatools.merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge</span></code></a></p></td>
<td><p>Merge two data sets.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.datatools.populate" title="pyanomaly.datatools.populate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">populate</span></code></a></p></td>
<td><p>Populate data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.datatools.shift" title="pyanomaly.datatools.shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shift</span></code></a></p></td>
<td><p>Shift data.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p><strong>Data Inspection/Comparison</strong></p>
<blockquote>
<div><table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.datatools.inspect_data" title="pyanomaly.datatools.inspect_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inspect_data</span></code></a></p></td>
<td><p>Inspect data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.datatools.compare_data" title="pyanomaly.datatools.compare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compare_data</span></code></a></p></td>
<td><p>Compare two data sets.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p><strong>Auxiliary Functions</strong></p>
<blockquote>
<div><table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.datatools.to_month_end" title="pyanomaly.datatools.to_month_end"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_month_end</span></code></a></p></td>
<td><p>Shift dates to the last dates of the same month.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.datatools.add_months" title="pyanomaly.datatools.add_months"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_months</span></code></a></p></td>
<td><p>Add months to dates.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.add_months">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">add_months</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">months</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_month_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.add_months" title="Link to this definition"></a></dt>
<dd><p>Add months to dates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – Datetime Series.</p></li>
<li><p><strong>months</strong> – Months to add. Can be negative.</p></li>
<li><p><strong>to_month_end</strong> – If True, returned dates are end-of-month dates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Datetime Series of (<cite>date</cite> + <cite>months</cite>). Dates are end-of-month dates if <cite>to_month_end</cite> = True.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.apply_to_groups">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">apply_to_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ginfo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.apply_to_groups" title="Link to this definition"></a></dt>
<dd><p>Group data and apply a function to each group.</p>
<p>This function can be used for a complex groupby operation. The <cite>data</cite> (and <cite>data2</cite>) is grouped using the grouping
information, <cite>ginfo</cite>, and <cite>function</cite> is applied to each group. The <cite>function</cite> can be either jitted or unjitted.
If it is jitted, consider using <a class="reference internal" href="#pyanomaly.datatools.apply_to_groups_jit" title="pyanomaly.datatools.apply_to_groups_jit"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups_jit()</span></code></a> instead, which runs the for loop along the groups in
parallel. This function is faster than <code class="docutils literal notranslate"><span class="pre">groupby().apply(function)</span></code> when the size of <cite>data</cite> is large.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame or ndarray (values of a DataFrame) to be grouped.</p></li>
<li><p><strong>ginfo</strong> – Grouping information: integer (index level), str (column name), pandas GroupBy object, ndarray of
group sizes, or list of group indexes. See the note below.</p></li>
<li><p><strong>function</strong> – Function to apply to groups. Its arguments should be (<cite>gbdata</cite>, <cite>*args</cite>) or
(<cite>gbdata</cite>, <cite>gbdata2</cite>, <cite>*args</cite>), where <cite>gbdata</cite> (<cite>gbdata2</cite>) is a group of <cite>data</cite> (<cite>data2</cite>).</p></li>
<li><p><strong>*args</strong> – Additional arguments of <cite>function</cite>.</p></li>
<li><p><strong>data2</strong> – DataFrame or ndarray (values of a DataFrame) to be grouped. Optional argument when <cite>function</cite> requires
two sets of input data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Concatenated value of the outputs of <cite>function</cite>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Suppose <cite>data</cite> is a DataFrame with index = date/id, sorted on id/date.</p>
<p>To apply a function to each id, <cite>ginfo</cite> can be set to any of the followings.</p>
<ul class="simple">
<li><p>ginfo = ‘id’ (index name)</p></li>
<li><p>ginfo = 1 (index level)</p></li>
<li><p>ginfo = data.groupby(‘id’) (GroupBy object)</p></li>
<li><p>ginfo = data.groupby(‘id’).size().to_numpy() (group size)</p></li>
<li><p>ginfo = list(data.groupby(‘id’).indices.values()) (group index)</p></li>
</ul>
<p>To apply a function to each date, <cite>ginfo</cite> can be set to any of the followings.</p>
<ul class="simple">
<li><p>ginfo = ‘date’ (index name)</p></li>
<li><p>ginfo = 0 (index level)</p></li>
<li><p>ginfo = data.groupby(‘date’) (GroupBy object)</p></li>
<li><p>ginfo = list(data.groupby(‘date’).indices.values()) (group index)</p></li>
</ul>
<p>Since <cite>data</cite> is sorted on id/date, group sizes can be used only when grouped by id. The most efficient method
is to provide group sizes, followed by group indexes. Hence, if this function needs to be called repeatedly,
performance can be improved by generating group sizes (if data is sorted on the grouping index (column))
or group indexes outside and use them as <cite>ginfo</cite>.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;ret&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me_nyse&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">},</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;2023-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-04-30&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">,</span> <span class="mi">40000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">]],</span>
<span class="gp">... </span>                                     <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;permno&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;permno&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="n">data</span>
<span class="go">                     ret    me  me_nyse</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000   0.010   100      NaN</span>
<span class="go">2023-04-30 10000  -0.030   120      NaN</span>
<span class="go">2023-03-31 20000   0.050  5000 5000.000</span>
<span class="go">2023-04-30 20000  -0.010  4500 4500.000</span>
<span class="go">2023-03-31 30000   0.020  2000 2000.000</span>
<span class="go">2023-04-30 30000   0.030  2100 2100.000</span>
<span class="go">2023-03-31 40000   0.030   300  300.000</span>
<span class="go">2023-04-30 40000  -0.050   305  305.000</span>
<span class="go">2023-03-31 50000   0.110   150  150.000</span>
<span class="go">2023-04-30 50000   0.070   140  140.000</span>
</pre></div>
</div>
<p>Define the function to apply.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">rolling_sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<p>Group data by ‘permno’ and calculate rolling sum of ‘ret’ and ‘me’.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">apply_to_groups</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;ret&#39;</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">]],</span> <span class="s1">&#39;permno&#39;</span><span class="p">,</span> <span class="n">rolling_sum</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">                     ret       me</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000     NaN      NaN</span>
<span class="go">2023-04-30 10000  -0.020  220.000</span>
<span class="go">2023-03-31 20000     NaN      NaN</span>
<span class="go">2023-04-30 20000   0.040 9500.000</span>
<span class="go">2023-03-31 30000     NaN      NaN</span>
<span class="go">2023-04-30 30000   0.050 4100.000</span>
<span class="go">2023-03-31 40000     NaN      NaN</span>
<span class="go">2023-04-30 40000  -0.020  605.000</span>
<span class="go">2023-03-31 50000     NaN      NaN</span>
<span class="go">2023-04-30 50000   0.180  290.000</span>
</pre></div>
</div>
<p>The followings are equivalent to the above.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gb</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;permno&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="n">apply_to_groups</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;ret&#39;</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">]],</span> <span class="n">gb</span><span class="p">,</span> <span class="n">rolling_sum</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gsize</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="gp">... </span><span class="n">apply_to_groups</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;ret&#39;</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">]],</span> <span class="n">gsize</span><span class="p">,</span> <span class="n">rolling_sum</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Group data by ‘date’ and calculate cross-sectional mean of ‘ret’.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">apply_to_groups</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">],</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
<span class="go">[[0.044]</span>
<span class="go"> [0.002]]</span>
</pre></div>
</div>
<p>The followings are equivalent to the above.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gb</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="n">apply_to_groups</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">],</span> <span class="n">gb</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gidx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">gb</span><span class="o">.</span><span class="n">indices</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">... </span><span class="n">apply_to_groups</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">],</span> <span class="n">gidx</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.apply_to_groups_jit">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">apply_to_groups_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ginfo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ret</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.apply_to_groups_jit" title="Link to this definition"></a></dt>
<dd><p>Group data and apply a function to each group (jitted version).</p>
<p>This function is similar to <a class="reference internal" href="#pyanomaly.datatools.apply_to_groups" title="pyanomaly.datatools.apply_to_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups()</span></code></a>. The for loop along the groups is jitted for faster
performance. The first call of this function can be slow as jitting takes place when first called.
The <cite>function</cite> should be jitted, and the row size of its returns should be the same as the row size of
the input data. For reduce functions, e.g., sum and mean, use <a class="reference internal" href="#pyanomaly.datatools.apply_to_groups_reduce_jit" title="pyanomaly.datatools.apply_to_groups_reduce_jit"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups_reduce_jit()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame or ndarray (values of a DataFrame) to be grouped.</p></li>
<li><p><strong>ginfo</strong> – Grouping information: integer (index level), str (column name), pandas GroupBy object, ndarray of
group sizes, or list of group indexes. See <a class="reference internal" href="#pyanomaly.datatools.apply_to_groups" title="pyanomaly.datatools.apply_to_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups()</span></code></a> for more details.</p></li>
<li><p><strong>function</strong> – Jitted function to apply to groups. Its arguments should be (<cite>gbdata</cite>, <cite>*args</cite>) or
(<cite>gbdata</cite>, <cite>gbdata2</cite>, <cite>*args</cite>), where <cite>gbdata</cite> (<cite>gbdata2</cite>) is a group of <cite>data</cite> (<cite>data2</cite>).</p></li>
<li><p><strong>n_ret</strong> – Number of returns of <cite>function</cite>. If None, it is assumed to be the same as the column size of <cite>data</cite>.</p></li>
<li><p><strong>*args</strong> – Additional arguments of <cite>function</cite>.</p></li>
<li><p><strong>data2</strong> – DataFrame or ndarray (values of a DataFrame) to be grouped. Optional argument when <cite>function</cite> requires
two sets of input data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Concatenated value of the outputs of <cite>function</cite>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;ret&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me_nyse&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">},</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;2023-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-04-30&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">,</span> <span class="mi">40000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">]],</span>
<span class="gp">... </span>                                     <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;permno&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;permno&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="n">data</span>
<span class="go">                     ret    me  me_nyse</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000   0.010   100      NaN</span>
<span class="go">2023-04-30 10000  -0.030   120      NaN</span>
<span class="go">2023-03-31 20000   0.050  5000 5000.000</span>
<span class="go">2023-04-30 20000  -0.010  4500 4500.000</span>
<span class="go">2023-03-31 30000   0.020  2000 2000.000</span>
<span class="go">2023-04-30 30000   0.030  2100 2100.000</span>
<span class="go">2023-03-31 40000   0.030   300  300.000</span>
<span class="go">2023-04-30 40000  -0.050   305  305.000</span>
<span class="go">2023-03-31 50000   0.110   150  150.000</span>
<span class="go">2023-04-30 50000   0.070   140  140.000</span>
</pre></div>
</div>
<p>Group data by ‘permno’ and calculate rolling sum of ‘ret’ and ‘me’ using
<a class="reference internal" href="#pyanomaly.numba_support.roll_sum" title="pyanomaly.numba_support.roll_sum"><code class="xref py py-func docutils literal notranslate"><span class="pre">numba_support.roll_sum()</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">apply_to_groups_jit</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;ret&#39;</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">]],</span> <span class="s1">&#39;permno&#39;</span><span class="p">,</span> <span class="n">roll_sum</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">array([[      nan,       nan],</span>
<span class="go">       [-2.00e-02,  2.20e+02],</span>
<span class="go">       [      nan,       nan],</span>
<span class="go">       [ 4.00e-02,  9.50e+03],</span>
<span class="go">       [      nan,       nan],</span>
<span class="go">       [ 5.00e-02,  4.10e+03],</span>
<span class="go">       [      nan,       nan],</span>
<span class="go">       [-2.00e-02,  6.05e+02],</span>
<span class="go">       [      nan,       nan],</span>
<span class="go">       [ 1.80e-01,  2.90e+02]])</span>
</pre></div>
</div>
<p>The followings are equivalent to the above.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gb</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;permno&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="n">apply_to_groups_jit</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;ret&#39;</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">]],</span> <span class="n">gb</span><span class="p">,</span> <span class="n">roll_sum</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gsize</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="gp">... </span><span class="n">apply_to_groups_jit</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;ret&#39;</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">]],</span> <span class="n">gsize</span><span class="p">,</span> <span class="n">roll_sum</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.apply_to_groups_reduce_jit">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">apply_to_groups_reduce_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ginfo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ret</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.apply_to_groups_reduce_jit" title="Link to this definition"></a></dt>
<dd><p>Group data and apply a reduce function to each group (jitted version).</p>
<p>This function is similar to <a class="reference internal" href="#pyanomaly.datatools.apply_to_groups" title="pyanomaly.datatools.apply_to_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups()</span></code></a>. The for loop along the groups is jitted for faster
performance. The first call of this function can be slow as jitting takes place when first called.
The <cite>function</cite> should be jitted and a reduce function such as mean or std: the row size of the returns should be 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame or ndarray (values of a DataFrame) to be grouped.</p></li>
<li><p><strong>ginfo</strong> – Grouping information: integer (index level), str (column name), pandas GroupBy object, ndarray of
group sizes, or list of group indexes. See <a class="reference internal" href="#pyanomaly.datatools.apply_to_groups" title="pyanomaly.datatools.apply_to_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups()</span></code></a> for more details.</p></li>
<li><p><strong>function</strong> – Jitted function to apply to groups. Its arguments should be (<cite>gbdata</cite>, <cite>*args</cite>) or
(<cite>gbdata</cite>, <cite>gbdata2</cite>, <cite>*args</cite>), where <cite>gbdata</cite> (<cite>gbdata2</cite>) is a group of <cite>data</cite> (<cite>data2</cite>).</p></li>
<li><p><strong>n_ret</strong> – Number of returns of <cite>function</cite>. If None, it is assumed to be the same as the column size of <cite>data</cite>.</p></li>
<li><p><strong>*args</strong> – Additional arguments of <cite>function</cite>.</p></li>
<li><p><strong>data2</strong> – DataFrame or ndarray (values of a DataFrame) to be grouped. Optional argument when <cite>function</cite> requires
two sets of input data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Concatenated value of the outputs of <cite>function</cite>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;ret&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me_nyse&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">},</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;2023-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-04-30&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">,</span> <span class="mi">40000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">]],</span>
<span class="gp">... </span>                                     <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;permno&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;permno&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="n">data</span>
<span class="go">                     ret    me  me_nyse</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000   0.010   100      NaN</span>
<span class="go">2023-04-30 10000  -0.030   120      NaN</span>
<span class="go">2023-03-31 20000   0.050  5000 5000.000</span>
<span class="go">2023-04-30 20000  -0.010  4500 4500.000</span>
<span class="go">2023-03-31 30000   0.020  2000 2000.000</span>
<span class="go">2023-04-30 30000   0.030  2100 2100.000</span>
<span class="go">2023-03-31 40000   0.030   300  300.000</span>
<span class="go">2023-04-30 40000  -0.050   305  305.000</span>
<span class="go">2023-03-31 50000   0.110   150  150.000</span>
<span class="go">2023-04-30 50000   0.070   140  140.000</span>
</pre></div>
</div>
<p>Group data by ‘date’ and calculate cross-sectional standard deviation of ‘ret’ using
<a class="reference internal" href="#pyanomaly.numba_support.nanstd" title="pyanomaly.numba_support.nanstd"><code class="xref py py-func docutils literal notranslate"><span class="pre">numba_support.nanstd()</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">apply_to_groups_reduce_jit</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">],</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">nanstd</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">array([0.03974921, 0.04816638])</span>
</pre></div>
</div>
<p>The following is equivalent to the above.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gidx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">indices</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">... </span><span class="n">apply_to_groups_reduce_jit</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">],</span> <span class="n">gidx</span><span class="p">,</span> <span class="n">nanstd</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.classify">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">classify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ginfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.classify" title="Link to this definition"></a></dt>
<dd><p>Classify array.</p>
<p>Classify (group) <cite>array</cite> into <cite>split</cite> classes based on its value.
Class labels are set to 0, 1, … where 0 corresponds to the lowest (highest) value group if
<cite>ascending</cite> = True (False). If array contains nan, their classes are set to nan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – Nx1 ndarray or Series to be classified.</p></li>
<li><p><strong>split</strong> – Number of classes (for equal-size quantiles) or list of quantiles, e.g., (0.3, 0.7).</p></li>
<li><p><strong>ascending</strong> (<em>bool</em>) – Sorting order.</p></li>
<li><p><strong>ginfo</strong> – Grouping information: integer (index level), str (column name), pandas GroupBy object, ndarray of
group sizes, or list of group indexes. If given, <cite>array</cite> is classified within each group.
See <a class="reference internal" href="#pyanomaly.datatools.apply_to_groups" title="pyanomaly.datatools.apply_to_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups()</span></code></a> for more details.</p></li>
<li><p><strong>by_array</strong> – Array based on which cut points are determined. If None, <cite>by_array</cite> = <cite>array</cite>. E.g., array can be set
to ME and by_array to NYSE-ME to group firms on size with NYSE-size cut points.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nx1 ndarray of classes.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the array has one unique value, the class will be set to 0, and if the array has two unique values (binary
variable), the class of the smaller value will be 0 and that of the larger value will be
(number of quantiles - 1), when <cite>ascending</cite> = True.
If the number of unique values is greater than 2 and smaller than the number of quantiles, the classes are not
deterministic.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="gp">... </span><span class="n">array</span>
<span class="go">[ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11]</span>
</pre></div>
</div>
<p>Classify array into 5 equally-spaced groups.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">classify</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">[0., 0., 0., 1., 1., 2., 2., 3., 3., 4., 4.]</span>
</pre></div>
</div>
<p>Classify array into three groups that correspond to 0.3, 03-0.7, 0.7-1.0 quantiles.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">classify</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>
<span class="go">[0., 0., 0., 0., 1., 1., 1., 1., 2., 2., 2.]</span>
</pre></div>
</div>
<p>Classify array into three groups in descending order.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">classify</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[2., 2., 2., 2., 1., 1., 1., 1., 0., 0., 0.]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;ret&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me_nyse&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">},</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;2023-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-04-30&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">,</span> <span class="mi">40000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">]],</span>
<span class="gp">... </span>                                     <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;permno&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;permno&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="n">data</span>
<span class="go">                     ret    me  me_nyse</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000   0.010   100      NaN</span>
<span class="go">2023-04-30 10000  -0.030   120      NaN</span>
<span class="go">2023-03-31 20000   0.050  5000 5000.000</span>
<span class="go">2023-04-30 20000  -0.010  4500 4500.000</span>
<span class="go">2023-03-31 30000   0.020  2000 2000.000</span>
<span class="go">2023-04-30 30000   0.030  2100 2100.000</span>
<span class="go">2023-03-31 40000   0.030   300  300.000</span>
<span class="go">2023-04-30 40000  -0.050   305  305.000</span>
<span class="go">2023-03-31 50000   0.110   150  150.000</span>
<span class="go">2023-04-30 50000   0.070   140  140.000</span>
</pre></div>
</div>
<p>Cross-sectionally classify the data into three groups ([0.3, 0.7, 1.0]) on ‘me’ using ‘me_nyse’ cut points.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;me_cls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">classify</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;me&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span> <span class="n">ginfo</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">by_array</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;me_nyse&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="n">data</span>
<span class="go">                     ret    me  me_nyse  me_cls</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000   0.010   100      NaN       0</span>
<span class="go">2023-04-30 10000  -0.030   120      NaN       0</span>
<span class="go">2023-03-31 20000   0.050  5000 5000.000       2</span>
<span class="go">2023-04-30 20000  -0.010  4500 4500.000       2</span>
<span class="go">2023-03-31 30000   0.020  2000 2000.000       1</span>
<span class="go">2023-04-30 30000   0.030  2100 2100.000       1</span>
<span class="go">2023-03-31 40000   0.030   300  300.000       1</span>
<span class="go">2023-04-30 40000  -0.050   305  305.000       1</span>
<span class="go">2023-03-31 50000   0.110   150  150.000       0</span>
<span class="go">2023-04-30 50000   0.070   140  140.000       0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.compare_data">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">compare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inner'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffixes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('_x',</span> <span class="pre">'_y')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.compare_data" title="Link to this definition"></a></dt>
<dd><p>Compare two data sets.</p>
<p>This function compares the common columns of <cite>data1</cite> and <cite>data2</cite>.
This is similar to <code class="docutils literal notranslate"><span class="pre">data1.compare(data2)</span></code>, but <cite>data1</cite> and <cite>data2</cite> are not required to have the same index and
columns: Data sets are first merged and only common columns are compared. Also, a tolerance can be set to determine
whether two values are identical. Whether two columns are identical within the tolerance (‘match’), their
correlation (‘corr’), and the number of nans in <cite>data1</cite> and <cite>data2</cite> (‘nan_x’, ‘nan_y’) are printed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data1</strong> – DataFrame for comparison.</p></li>
<li><p><strong>data2</strong> – DataFrame for comparison. If None, <cite>data1</cite> is assumed to be a merged dataset of <cite>data1</cite> and <cite>data2</cite>.
If <cite>data1</cite> is a merged dataset, <cite>on</cite> and <cite>how</cite> have no effect.</p></li>
<li><p><strong>on</strong> – A column or a list of columns to merge data sets on. If None, data sets will be merged on index.</p></li>
<li><p><strong>how</strong> – How to merge: ‘inner’, ‘outer’, ‘left’, or ‘right’. If ‘inner’, only common indexes are compared.</p></li>
<li><p><strong>tolerance</strong> – Tolerance level to determine equality. Two values, <cite>val1</cite> and <cite>val2</cite>, are considered to be identical
if <cite>abs((val1 - val2) / val2) &lt; tolerance</cite>.</p></li>
<li><p><strong>suffixes</strong> – suffixes to add to common columns or suffixes used in the merged dataset.
<cite>suffixes[0]</cite>: suffix for <cite>data1</cite>, <cite>suffixes[1]</cite>: suffix for <cite>data2</cite>.</p></li>
<li><p><strong>returns</strong> – If True, return the comparison results and merged data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Comparison result. DataFrame with index = compared columns and columns = [‘match’, ‘corr’, ‘nan_x’, ‘nan_y’].</p></li>
<li><p>Merged DataFrame of <cite>data1</cite> and <cite>data2</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;ret&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">},</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;2023-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-04-30&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">,</span> <span class="mi">40000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">]],</span>
<span class="gp">... </span>                                     <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;permno&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">... </span><span class="n">data2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;ret&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">},</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;2023-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-04-30&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">,</span> <span class="mi">40000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">]],</span>
<span class="gp">... </span>                                     <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;permno&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">... </span><span class="n">compare_data</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
<span class="go">column                matched     corr    nan_x    nan_y</span>
<span class="go">ret                   0.88889  0.99773       0       1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.filter">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ginfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.filter" title="Link to this definition"></a></dt>
<dd><p>Filter data.</p>
<p>Remove rows of <cite>data</cite>, where <cite>data[on]</cite> is outside <cite>limits</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame to be filtered.</p></li>
<li><p><strong>on</strong> – Column of <cite>data</cite> to filter <cite>data</cite> on.</p></li>
<li><p><strong>limits</strong> – A pair of quantiles, e.g., (0.1, 0.1) to remove top and bottom 10%. An element of <cite>limits</cite> can be set to
None for one-sided filtering.</p></li>
<li><p><strong>ginfo</strong> – Grouping information: integer (index level), str (column name), pandas GroupBy object, ndarray of
group sizes, or list of group indexes. If given, <cite>data</cite> is filtered within each group.
See <a class="reference internal" href="#pyanomaly.datatools.apply_to_groups" title="pyanomaly.datatools.apply_to_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups()</span></code></a> for more details.</p></li>
<li><p><strong>by</strong> – Column of <cite>data</cite> on which cut points are determined. If None, <cite>by</cite> = <cite>on</cite>. E.g., <cite>on</cite> can be set
to ‘me’ and <cite>by</cite> to ‘nyse_me’ to remove small firms based on NYSE-size cut points.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame. Filtered <cite>data</cite>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;ret&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me_nyse&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">},</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;2023-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-04-30&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">,</span> <span class="mi">40000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">]],</span>
<span class="gp">... </span>                                     <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;permno&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;permno&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="n">data</span>
<span class="go">                     ret    me  me_nyse</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000   0.010   100      NaN</span>
<span class="go">2023-04-30 10000  -0.030   120      NaN</span>
<span class="go">2023-03-31 20000   0.050  5000 5000.000</span>
<span class="go">2023-04-30 20000  -0.010  4500 4500.000</span>
<span class="go">2023-03-31 30000   0.020  2000 2000.000</span>
<span class="go">2023-04-30 30000   0.030  2100 2100.000</span>
<span class="go">2023-03-31 40000   0.030   300  300.000</span>
<span class="go">2023-04-30 40000  -0.050   305  305.000</span>
<span class="go">2023-03-31 50000   0.110   150  150.000</span>
<span class="go">2023-04-30 50000   0.070   140  140.000</span>
</pre></div>
</div>
<p>Remove smallest 20% using ‘me_nyse’ cut points.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">ginfo</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;me_nyse&#39;</span><span class="p">)</span>
<span class="go">                     ret    me  me_nyse</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 20000   0.050  5000 5000.000</span>
<span class="go">2023-04-30 20000  -0.010  4500 4500.000</span>
<span class="go">2023-03-31 30000   0.020  2000 2000.000</span>
<span class="go">2023-04-30 30000   0.030  2100 2100.000</span>
<span class="go">2023-03-31 40000   0.030   300  300.000</span>
<span class="go">2023-04-30 40000  -0.050   305  305.000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.inspect_data">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">inspect_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['summary']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.inspect_data" title="Link to this definition"></a></dt>
<dd><p>Inspect data.</p>
<p>This function inspects a panel data, <cite>data</cite>, and print the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame. It should have date and id columns or index = date/id.</p></li>
<li><p><strong>option</strong> – List of items to display. See below for available options.</p></li>
<li><p><strong>date_col</strong> – Date column. If None, <cite>date.index[0]</cite> is assumed to be date.</p></li>
<li><p><strong>id_col</strong> – ID column. If None, <cite>date.index[1]</cite> is assumed to be id.</p></li>
</ul>
</dd>
</dl>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Items displayed</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘summary’</p></td>
<td><p>Data shape, number of unique dates, and number of unique ids.</p></td>
</tr>
<tr class="row-odd"><td><p>‘id_count`</p></td>
<td><p>Number of ids per date.</p></td>
</tr>
<tr class="row-even"><td><p>‘nans’</p></td>
<td><p>Number of nans and infs per column.</p></td>
</tr>
<tr class="row-odd"><td><p>‘stats’</p></td>
<td><p>Descriptive statistics. Same as <code class="docutils literal notranslate"><span class="pre">data.describe()</span></code>.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.merge">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_duplicates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffixes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.merge" title="Link to this definition"></a></dt>
<dd><p>Merge two data sets.</p>
<p>This is similar to <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code>, but often much faster and less memory-hungry when merging left.
Also, the index of <cite>left</cite> is always retained.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left</strong> – Series or DataFrame. Left data to merge.</p></li>
<li><p><strong>right</strong> – Series or DataFrame, Right data to merge.</p></li>
<li><p><strong>on</strong> – (List of) column(s) to merge on. If None, merge on index.</p></li>
<li><p><strong>right_on</strong> – (List of) column(s) of <cite>right</cite> to merge on. If None, <cite>right_on</cite> = <cite>on</cite>.</p></li>
<li><p><strong>how</strong> – Merge method: ‘inner’, ‘outer’, ‘left’, or ‘right’.</p></li>
<li><p><strong>drop_duplicates</strong> – how to handle duplicate columns. ‘left’: keep right, ‘right’: keep left,
None: keep both. If None, <cite>suffixes</cite> should be provided.</p></li>
<li><p><strong>suffixes</strong> – A tuple of suffixes for duplicate columns, e.g., suffixes=(‘_x’, ‘_y’) will add ‘_x’ and ‘_y’
to the left and right duplicate columns, respectively.</p></li>
<li><p><strong>method</strong> – None or ‘pandas’. None uses an internal merge algorithm for left-merge; ‘pandas’ uses <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code>
internally. If <cite>how</cite> is not ‘left’, this option is ignored and <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> is always used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Merged DataFrame.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The internal algorithm is much faster and more memory-efficient than <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> especially when
<cite>how</cite> = ‘left’ and <cite>right</cite> data does not have many columns. In other cases, it could be slower. Try both
<cite>method</cite> = None and ‘merge’, and choose the faster method.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <cite>left</cite> and <cite>right</cite> could be modified internally.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;ret&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">},</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;2023-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-04-30&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">,</span> <span class="mi">40000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">]],</span>
<span class="gp">... </span>                                     <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;permno&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">... </span><span class="n">data1</span>
<span class="go">                     ret    me</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000   0.010   100</span>
<span class="go">           20000   0.050  5000</span>
<span class="go">           30000   0.020  2000</span>
<span class="go">           40000   0.030   300</span>
<span class="go">           50000   0.110   150</span>
<span class="go">2023-04-30 10000  -0.030   120</span>
<span class="go">           20000  -0.010  4500</span>
<span class="go">           30000   0.030  2100</span>
<span class="go">           40000  -0.050   305</span>
<span class="go">           50000   0.070   140</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;me&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me_nyse&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">},</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;2023-04-30&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">,</span> <span class="mi">40000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">]],</span>
<span class="gp">... </span>                                     <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;permno&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">... </span><span class="n">data2</span>
<span class="go">                     me  me_nyse</span>
<span class="go">date       permno</span>
<span class="go">2023-04-30 10000    120      NaN</span>
<span class="go">           20000   4500 4500.000</span>
<span class="go">           30000   2100 2100.000</span>
<span class="go">           40000    305  305.000</span>
<span class="go">           50000    140  140.000</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">merge</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
<span class="go">                     ret    me  me_nyse</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000   0.010   100      NaN</span>
<span class="go">           20000   0.050  5000      NaN</span>
<span class="go">           30000   0.020  2000      NaN</span>
<span class="go">           40000   0.030   300      NaN</span>
<span class="go">           50000   0.110   150      NaN</span>
<span class="go">2023-04-30 10000  -0.030   120      NaN</span>
<span class="go">           20000  -0.010  4500 4500.000</span>
<span class="go">           30000   0.030  2100 2100.000</span>
<span class="go">           40000  -0.050   305  305.000</span>
<span class="go">           50000   0.070   140  140.000</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">merge</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="go">                     ret    me  me_nyse</span>
<span class="go">date       permno</span>
<span class="go">2023-04-30 10000  -0.030   120      NaN</span>
<span class="go">           20000  -0.010  4500 4500.000</span>
<span class="go">           30000   0.030  2100 2100.000</span>
<span class="go">           40000  -0.050   305  305.000</span>
<span class="go">           50000   0.070   140  140.000</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">merge</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">drop_duplicates</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="go">                     ret       me  me_nyse</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000   0.010      NaN      NaN</span>
<span class="go">           20000   0.050      NaN      NaN</span>
<span class="go">           30000   0.020      NaN      NaN</span>
<span class="go">           40000   0.030      NaN      NaN</span>
<span class="go">           50000   0.110      NaN      NaN</span>
<span class="go">2023-04-30 10000  -0.030  120.000      NaN</span>
<span class="go">           20000  -0.010 4500.000 4500.000</span>
<span class="go">           30000   0.030 2100.000 2100.000</span>
<span class="go">           40000  -0.050  305.000  305.000</span>
<span class="go">           50000   0.070  140.000  140.000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.populate">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">populate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ffill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_date_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.populate" title="Link to this definition"></a></dt>
<dd><p>Populate data.</p>
<p>Populate <cite>data</cite> to <cite>freq</cite> frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame with index = date/id, sorted on id/date.</p></li>
<li><p><strong>freq</strong> – Frequency to populate: ANNUAL, QUARTERLY, MONTHLY, or DAILY.</p></li>
<li><p><strong>method</strong> – Filling method for newly added rows. ‘ffill’: forward fill, None: nan.</p></li>
<li><p><strong>limit</strong> – Maximum number of rows to forward-fill. Default to None (no fill).</p></li>
<li><p><strong>new_date_idx</strong> – Name of the new (populated) date index. If None, use the current date index name. If given,
the original date index is kept as a column.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Populated data with index = new_date/id.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;ret&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">4500</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">},</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s1">&#39;2023-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-03-31&#39;</span><span class="p">]),</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">]],</span>
<span class="gp">... </span>                                     <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;permno&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">... </span><span class="n">data</span>
<span class="go">                    ret    me</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000  0.010   100</span>
<span class="go">           20000  0.050  5000</span>
<span class="go">2024-03-31 10000  0.020   120</span>
<span class="go">           20000  0.030  4500</span>
</pre></div>
</div>
<p>Populate to monthly and forward-fill up to 12 months.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">populate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">MONTHLY</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="go">                    ret       me</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000  0.010  100.000</span>
<span class="go">2023-04-30 10000  0.010  100.000</span>
<span class="go">2023-05-31 10000  0.010  100.000</span>
<span class="go">2023-06-30 10000  0.010  100.000</span>
<span class="go">2023-07-31 10000  0.010  100.000</span>
<span class="go">2023-08-31 10000  0.010  100.000</span>
<span class="go">2023-09-30 10000  0.010  100.000</span>
<span class="go">2023-10-31 10000  0.010  100.000</span>
<span class="go">2023-11-30 10000  0.010  100.000</span>
<span class="go">2023-12-31 10000  0.010  100.000</span>
<span class="go">2024-01-31 10000  0.010  100.000</span>
<span class="go">2024-02-29 10000  0.010  100.000</span>
<span class="go">2024-03-31 10000  0.020  120.000</span>
<span class="go">2023-03-31 20000  0.050 5000.000</span>
<span class="go">2023-04-30 20000  0.050 5000.000</span>
<span class="go">2023-05-31 20000  0.050 5000.000</span>
<span class="go">2023-06-30 20000  0.050 5000.000</span>
<span class="go">2023-07-31 20000  0.050 5000.000</span>
<span class="go">2023-08-31 20000  0.050 5000.000</span>
<span class="go">2023-09-30 20000  0.050 5000.000</span>
<span class="go">2023-10-31 20000  0.050 5000.000</span>
<span class="go">2023-11-30 20000  0.050 5000.000</span>
<span class="go">2023-12-31 20000  0.050 5000.000</span>
<span class="go">2024-01-31 20000  0.050 5000.000</span>
<span class="go">2024-02-29 20000  0.050 5000.000</span>
<span class="go">2024-03-31 20000  0.030 4500.000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.shift">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excl_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.shift" title="Link to this definition"></a></dt>
<dd><p>Shift data.</p>
<p>Shift <cite>data</cite> by <cite>n</cite>. If <cite>cols</cite> is given, only <cite>cols</cite> columns are shifted. If <cite>excl_cols</cite> is given, columns
excluding <cite>excl_cols</cite> are shifted. Either <cite>cols</cite> or <cite>excl_cols</cite> should be None. The shifted data contains both
shifted and not-shifted columns. If <cite>data</cite> has a MultiIndex of date/id, data is shifted within each id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Series or DataFrame with index = date or date/id. If index = date/id, <cite>data</cite> must be sorted on id/date.</p></li>
<li><p><strong>n</strong> – Shift size</p></li>
<li><p><strong>cols</strong> – Columns to shift.</p></li>
<li><p><strong>excl_cols</strong> – Columns to not shift.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Series or DataFrame. Shifted <cite>data</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.to_month_end">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">to_month_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.to_month_end" title="Link to this definition"></a></dt>
<dd><p>Shift dates to the last dates of the same month.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>date</strong> – Datetime Series.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Datetime Series shifted to month end.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.trim">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">trim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ginfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.trim" title="Link to this definition"></a></dt>
<dd><p>Trim array.</p>
<p>Trim <cite>array</cite> values that are outside <cite>limits</cite>. The returned value is a bool array that indicates which to be
trimmed (True to keep and False to remove).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – Nx1 ndarray or Series to be trimmed.</p></li>
<li><p><strong>limits</strong> – A pair of quantiles, e.g., (0.1, 0.1) to trim top and bottom 10%. An element of <cite>limits</cite> can be set to
None for one-sided trim.</p></li>
<li><p><strong>ginfo</strong> – Grouping information: integer (index level), str (column name), pandas GroupBy object, ndarray of
group sizes, or list of group indexes. If given, <cite>array</cite> is trimmed within each group.
See <a class="reference internal" href="#pyanomaly.datatools.apply_to_groups" title="pyanomaly.datatools.apply_to_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups()</span></code></a> for more details.</p></li>
<li><p><strong>by_array</strong> – Array based on which cut points are determined. If None, <cite>by_array</cite> = <cite>array</cite>. E.g., <cite>array</cite> can be
set to ME and <cite>by_array</cite> to NYSE-ME to remove small firms based on NYSE-size cut points.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nx1 bool ndarray. Elements corresponding to trimmed values are set to False.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="gp">... </span><span class="n">array</span>
<span class="go">[ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11]</span>
</pre></div>
</div>
<p>Trim top/bottom 10% values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trim</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
<span class="go">[False,  True,  True,  True,  True,  True,  True,  True,  True, True, False]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;ret&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me_nyse&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">},</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;2023-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-04-30&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">,</span> <span class="mi">40000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">]],</span>
<span class="gp">... </span>                                     <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;permno&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;permno&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="n">data</span>
<span class="go">                     ret    me  me_nyse</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000   0.010   100      NaN</span>
<span class="go">2023-04-30 10000  -0.030   120      NaN</span>
<span class="go">2023-03-31 20000   0.050  5000 5000.000</span>
<span class="go">2023-04-30 20000  -0.010  4500 4500.000</span>
<span class="go">2023-03-31 30000   0.020  2000 2000.000</span>
<span class="go">2023-04-30 30000   0.030  2100 2100.000</span>
<span class="go">2023-03-31 40000   0.030   300  300.000</span>
<span class="go">2023-04-30 40000  -0.050   305  305.000</span>
<span class="go">2023-03-31 50000   0.110   150  150.000</span>
<span class="go">2023-04-30 50000   0.070   140  140.000</span>
</pre></div>
</div>
<p>Trim smallest 20% cross-sectionally using ‘me_nyse’ cut points.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;trimmed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trim</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;me&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">ginfo</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">by_array</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;me_nyse&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="n">data</span>
<span class="go">                     ret    me  me_nyse  trimmed</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000   0.010   100      NaN    False</span>
<span class="go">2023-04-30 10000  -0.030   120      NaN    False</span>
<span class="go">2023-03-31 20000   0.050  5000 5000.000     True</span>
<span class="go">2023-04-30 20000  -0.010  4500 4500.000     True</span>
<span class="go">2023-03-31 30000   0.020  2000 2000.000     True</span>
<span class="go">2023-04-30 30000   0.030  2100 2100.000     True</span>
<span class="go">2023-03-31 40000   0.030   300  300.000     True</span>
<span class="go">2023-04-30 40000  -0.050   305  305.000     True</span>
<span class="go">2023-03-31 50000   0.110   150  150.000    False</span>
<span class="go">2023-04-30 50000   0.070   140  140.000    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.winsorize">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">winsorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ginfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.winsorize" title="Link to this definition"></a></dt>
<dd><p>Winsorize array.</p>
<p>Winsorize <cite>array</cite> values that are outside <cite>limits</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – Nx1 ndarray or Series to be winsorized.</p></li>
<li><p><strong>limits</strong> – A pair of quantiles, e.g., (0.1, 0.1) to winsorize top and bottom 10%. An element of <cite>limits</cite> can be
set to None for one-sided winsorization.</p></li>
<li><p><strong>ginfo</strong> – Grouping information: integer (index level), str (column name), pandas GroupBy object, ndarray of
group sizes, or list of group indexes. If given, <cite>array</cite> is winsorized within each group.
See <a class="reference internal" href="#pyanomaly.datatools.apply_to_groups" title="pyanomaly.datatools.apply_to_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups()</span></code></a> for more details.</p></li>
<li><p><strong>by_array</strong> – Array based on which cut points are determined. If None, <cite>by_array</cite> = <cite>array</cite>. E.g., <cite>array</cite> can be
set to ME and <cite>by_array</cite> to NYSE-ME to winsorize large firms’ weights based on NYSE-size cut points.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nx1 ndarray of winsorized values.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="gp">... </span><span class="n">array</span>
<span class="go">[ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11]</span>
</pre></div>
</div>
<p>Winsorize top/bottom 10% values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">winsorize</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
<span class="go">[ 2,  2,  3,  4,  5,  6,  7,  8,  9, 10, 10]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;ret&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;me_nyse&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">},</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;2023-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-04-30&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">,</span> <span class="mi">40000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">]],</span>
<span class="gp">... </span>                                     <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;permno&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;permno&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="n">data</span>
<span class="go">                     ret    me  me_nyse</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000   0.010   100      NaN</span>
<span class="go">2023-04-30 10000  -0.030   120      NaN</span>
<span class="go">2023-03-31 20000   0.050  5000 5000.000</span>
<span class="go">2023-04-30 20000  -0.010  4500 4500.000</span>
<span class="go">2023-03-31 30000   0.020  2000 2000.000</span>
<span class="go">2023-04-30 30000   0.030  2100 2100.000</span>
<span class="go">2023-03-31 40000   0.030   300  300.000</span>
<span class="go">2023-04-30 40000  -0.050   305  305.000</span>
<span class="go">2023-03-31 50000   0.110   150  150.000</span>
<span class="go">2023-04-30 50000   0.070   140  140.000</span>
</pre></div>
</div>
<p>Winsorize top 10% returns cross-sectionally.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ret_winsorized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">winsorize</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">],</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">ginfo</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;ret&#39;</span><span class="p">,</span> <span class="s1">&#39;ret_winsorized&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="go">                     ret  ret_winsorized</span>
<span class="go">date       permno</span>
<span class="go">2023-03-31 10000   0.010           0.010</span>
<span class="go">           20000   0.050           0.050</span>
<span class="go">           30000   0.020           0.020</span>
<span class="go">           40000   0.030           0.030</span>
<span class="go">           50000   0.110           0.050</span>
<span class="go">2023-04-30 10000  -0.030          -0.030</span>
<span class="go">           20000  -0.010          -0.010</span>
<span class="go">           30000   0.030           0.030</span>
<span class="go">           40000  -0.050          -0.050</span>
<span class="go">           50000   0.070           0.030</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pyanomaly.factors">
<span id="factors"></span><h2>factors<a class="headerlink" href="#module-pyanomaly.factors" title="Link to this heading"></a></h2>
<p>This module defines functions to generate factor portfolios and characteristic portfolios.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.factors.prepare_data_for_factors" title="pyanomaly.factors.prepare_data_for_factors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data_for_factors</span></code></a></p></td>
<td><p>Prepare data for factor portfolio generation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.factors.make_factor_portfolio" title="pyanomaly.factors.make_factor_portfolio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_factor_portfolio</span></code></a></p></td>
<td><p>Make a factor portfolio.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.factors.make_factor_portfolios" title="pyanomaly.factors.make_factor_portfolios"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_factor_portfolios</span></code></a></p></td>
<td><p>Make factor portfolios.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.factors.make_all_factor_portfolios" title="pyanomaly.factors.make_all_factor_portfolios"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_all_factor_portfolios</span></code></a></p></td>
<td><p>Make all factor portfolios.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.factors.make_char_portfolios" title="pyanomaly.factors.make_char_portfolios"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_char_portfolios</span></code></a></p></td>
<td><p>Make characteristic portfolios.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.factors.make_all_factor_portfolios">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.factors.</span></span><span class="sig-name descname"><span class="pre">make_all_factor_portfolios</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monthly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">daily</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.factors.make_all_factor_portfolios" title="Link to this definition"></a></dt>
<dd><p>Make all factor portfolios.</p>
<p>Currently, this function generates the following factors:</p>
<blockquote>
<div><ul class="simple">
<li><p>Fama-French 3 factors: mktrf, smb_ff, hml</p></li>
<li><p>Fama-French 5 factors: mktrf, smb_ff5, hml, rmw, cma</p></li>
<li><p>Hou-Xue-Zhang 4 factors: mktrf, smb_hxz, inv, roe</p></li>
<li><p>Stambaugh-Yuan 4 factors: mktrf, smb_sy, mgmt, perf</p></li>
</ul>
</div></blockquote>
<p>The DataFrame of factors is saved to <code class="docutils literal notranslate"><span class="pre">config.factors_monthly(daily)_fname</span></code> in <code class="docutils literal notranslate"><span class="pre">config.output_dir</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>monthly</strong> – If True, generate monthly factors.</p></li>
<li><p><strong>daily</strong> – If True, generate daily factors.</p></li>
<li><p><strong>sdate</strong> – Start date (‘yyyy-mm-dd’).</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyanomaly.factors.make_factor_portfolios" title="pyanomaly.factors.make_factor_portfolios"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_factor_portfolios()</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.factors.make_char_portfolios">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.factors.</span></span><span class="sig-name descname"><span class="pre">make_char_portfolios</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">panel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">char_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighting</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.factors.make_char_portfolios" title="Link to this definition"></a></dt>
<dd><p>Make characteristic portfolios.</p>
<p>Make characteristic portfolios using the method of JKP.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Split stocks into terciles (1:1:1) based on a firm characteristic. Use only NYSE stocks
(excluding bottom 20%) to determine the cut points.</p></li>
<li><p>Make a characteristic portfolio: First Quantile - Last Quantile.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>panel</strong> – <code class="docutils literal notranslate"><span class="pre">FCPanel</span></code> that contains firm characteristics in <cite>char_list</cite>.
It should also have ‘exret’, ‘me’, ‘primary’, and ‘exchcd’ columns.</p></li>
<li><p><strong>char_list</strong> – List of firm characteristics to generate.</p></li>
<li><p><strong>weighting</strong> – ‘ew’ (equal-weight), ‘vw’ (value-weight), or
‘vw_cap’ (value-weight capped at 0.8 NYSE-size quantile).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Characteristic portfolio DataFrame with index = ‘date’ and
columns = [‘group’, ‘char’, ‘ret’, ‘signal’, ‘n_firms’].</p>
<blockquote>
<div><ul class="simple">
<li><p>group: ‘h’, ‘m’, ‘l’, or ‘hml’.</p></li>
<li><p>char: characteristic name</p></li>
<li><p>ret: characteristic portfolio return</p></li>
<li><p>signal: average characteristic value</p></li>
<li><p>n_firms: number of firms</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.factors.make_factor_portfolio">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.factors.</span></span><span class="sig-name descname"><span class="pre">make_factor_portfolio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">panel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">char</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">char_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.3,</span> <span class="pre">0.7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nyse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.factors.make_factor_portfolio" title="Link to this definition"></a></dt>
<dd><p>Make a factor portfolio.</p>
<p>The procedure is as follows.</p>
<ol class="arabic">
<li><p>Split stocks into terciles based on the values of <cite>char</cite> column.</p>
<blockquote>
<div><ul class="simple">
<li><p>If <cite>nyse</cite> = True, cut points are determined by <cite>char</cite> of NYSE stocks.</p></li>
<li><p>If <cite>ascending</cite> is True, the first quantile contains stocks with the lowest <cite>char</cite> values.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Make the factor portfolio.</p>
<blockquote>
<div><ul>
<li><p>If <cite>size_class</cite> is given,</p>
<blockquote>
<div><p>Factor portfolio (hml) = 1/2(Small High + Big High) − 1/2(Small Low + Big Low)</p>
<p>Size portfolio (smb) = 1/3(Small High + Small Mid + Small Low) - 1/3(Big High + Big Mid + Big Low)</p>
</div></blockquote>
</li>
<li><p>Otherwise,</p>
<blockquote>
<div><p>Factor portfolio (hml) = High - Low.</p>
</div></blockquote>
</li>
<li><p>High (Low) is the first (last) quantile, i.e., the factor portfolio is (high - low) when <cite>ascending</cite> = False
and (low - high) when <cite>ascending</cite> = True.</p></li>
<li><p>If <cite>weight_col</cite> is given, the factor portfolio is a <cite>weight_col</cite>-weighted portfolio; otherwise, it is an
equal-weight portfolio.</p></li>
</ul>
</div></blockquote>
</li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>panel</strong> – <code class="docutils literal notranslate"><span class="pre">FCPanel</span></code> that contains data for factor generation. It should have <cite>char</cite>, <cite>ret_col</cite>, <cite>size_class</cite>, and
<cite>weight_col</cite> (optional) columns.</p></li>
<li><p><strong>ret_col</strong> – Return column.</p></li>
<li><p><strong>char</strong> – Firm characteristic column to make a factor portfolio from.</p></li>
<li><p><strong>char_split</strong> – Tuple of splits for terciles. (0.3, 0.7) means 3:4:3 split.</p></li>
<li><p><strong>nyse</strong> – If True, cut points are determined by <cite>char</cite> of NYSE stocks.</p></li>
<li><p><strong>ascending</strong> – If True, the first quantile contains stocks with the lowest <cite>char</cite> values.</p></li>
<li><p><strong>size_class</strong> – Size class column. If given, a factor portfolio is constructed in each size group and the
factor portfolio is the average of them.</p></li>
<li><p><strong>weight_col</strong> – Weight column. If None, stocks are equally weighted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>DataFrame of the factor and its ingredient portfolios. Index = ‘date’.</p>
<ul>
<li><p>If <cite>size_class</cite> is given,</p>
<blockquote>
<div><p>columns: [‘sh’, ‘sm’, ‘sl’, ‘bh’, ‘bm’, ‘bl’, ‘hml’, ‘smb’].</p>
</div></blockquote>
</li>
<li><p>Otherwise,</p>
<blockquote>
<div><p>columns: [‘h’, ‘m’, ‘l’, ‘hml’].</p>
</div></blockquote>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.factors.make_factor_portfolios">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.factors.</span></span><span class="sig-name descname"><span class="pre">make_factor_portfolios</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">panel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor_groups</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.factors.make_factor_portfolios" title="Link to this definition"></a></dt>
<dd><p>Make factor portfolios.</p>
<p>Generate factor portfolios defined in <cite>factor_groups</cite>, which is a “factor group” or a list of them.</p>
<p><strong>Factor group</strong></p>
<p>A “factor group” is a dictionary that defines a factor model and has the following structure.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s1">&#39;factor_name&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">&#39;char&#39;</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Firm</span> <span class="n">characteristic</span> <span class="n">to</span> <span class="n">use</span> <span class="n">to</span> <span class="n">make</span> <span class="n">the</span> <span class="n">factor</span>
      <span class="s1">&#39;ascending&#39;</span><span class="p">(</span><span class="nb">bool</span><span class="p">):</span> <span class="n">If</span> <span class="kc">True</span> <span class="p">(</span><span class="kc">False</span><span class="p">),</span> <span class="n">the</span> <span class="n">factor</span> <span class="n">portfolio</span> <span class="ow">is</span> <span class="n">low</span><span class="o">-</span><span class="n">high</span> <span class="p">(</span><span class="n">high</span><span class="o">-</span><span class="n">low</span><span class="p">)</span><span class="o">.</span> <span class="n">Default</span> <span class="n">to</span> <span class="kc">False</span>
      <span class="s1">&#39;char_split&#39;</span><span class="p">(</span><span class="nb">tuple</span><span class="p">):</span> <span class="n">How</span> <span class="n">to</span> <span class="n">split</span> <span class="n">stocks</span> <span class="n">into</span> <span class="n">three</span> <span class="n">groups</span><span class="o">.</span> <span class="n">Default</span> <span class="n">to</span> <span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
      <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Example (Fama-French 5 factors):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ff5</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;smb_ff5&#39;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s1">&#39;hml&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">char</span><span class="o">=</span><span class="s1">&#39;be_me&#39;</span><span class="p">),</span>
    <span class="s1">&#39;rmw&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">char</span><span class="o">=</span><span class="s1">&#39;ope_be&#39;</span><span class="p">),</span>
    <span class="s1">&#39;cma&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">char</span><span class="o">=</span><span class="s1">&#39;at_gr1&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that</p>
<blockquote>
<div><ul class="simple">
<li><p>Any firm characteristic defined in <code class="docutils literal notranslate"><span class="pre">FUNDA</span></code>, <code class="docutils literal notranslate"><span class="pre">FUNDQ</span></code>, <code class="docutils literal notranslate"><span class="pre">CRSPM</span></code>, <code class="docutils literal notranslate"><span class="pre">CRSPD</span></code>, and <code class="docutils literal notranslate"><span class="pre">Merge</span></code> can be used
to generate a factor portfolio.</p></li>
<li><p>Size factor should have an empty dict.</p></li>
<li><p>Default value items can be omitted.</p></li>
</ul>
</div></blockquote>
<p><strong>Procedure</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Split stocks into two size groups (50:50) using NYSE-size cut points.</p></li>
<li><p>Make market factor portfolio: weighted mean excess returns of all stocks.</p></li>
<li><p>Make factor portfolios. See <a class="reference internal" href="#pyanomaly.factors.make_factor_portfolio" title="pyanomaly.factors.make_factor_portfolio"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_factor_portfolio()</span></code></a>.</p></li>
<li><p>Make size factor portfolio: average of the size factor portfolios (smb) from each factor.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>panel</strong> – <code class="docutils literal notranslate"><span class="pre">FCPanel</span></code> that contains data for factor generation, generated by <a class="reference internal" href="#pyanomaly.factors.prepare_data_for_factors" title="pyanomaly.factors.prepare_data_for_factors"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_data_for_factors()</span></code></a>.</p></li>
<li><p><strong>factor_groups</strong> – (List of) factor group(s).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Factor portfolio dataframe with index = ‘date’ and columns = [‘mktrf’, ‘rf’] + factor names in <cite>factor_groups</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.factors.prepare_data_for_factors">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.factors.</span></span><span class="sig-name descname"><span class="pre">prepare_data_for_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monthly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">daily</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.factors.prepare_data_for_factors" title="Link to this definition"></a></dt>
<dd><p>Prepare data for factor portfolio generation.</p>
<p>Generate firm characteristics needed to make factors.
The output data are used as input for <a class="reference internal" href="#pyanomaly.factors.make_factor_portfolios" title="pyanomaly.factors.make_factor_portfolios"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_factor_portfolios()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chars</strong> – List of firm characteristics to generate.</p></li>
<li><p><strong>monthly</strong> – If True, generate firm characteristics monthly.</p></li>
<li><p><strong>daily</strong> – If True, generate firm characteristics daily.</p></li>
<li><p><strong>sdate</strong> – Start date (‘yyyy-mm-dd’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>mdata. <code class="docutils literal notranslate"><span class="pre">FCPanel</span></code> of monthly data. None if <cite>monthly</cite> = False.</p></li>
<li><p>ddata. <code class="docutils literal notranslate"><span class="pre">FCPanel</span></code> of daily data. None if <cite>daily</cite> = False.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyanomaly.ff">
<span id="ff"></span><h2>ff<a class="headerlink" href="#module-pyanomaly.ff" title="Link to this heading"></a></h2>
<p>This module defines functions to generate Fama-French factors. This module is for validation only.
The Fama-French factors used in this library are generated by <a class="reference internal" href="#pyanomaly.factors.make_all_factor_portfolios" title="pyanomaly.factors.make_all_factor_portfolios"><code class="xref py py-func docutils literal notranslate"><span class="pre">factors.make_all_factor_portfolios()</span></code></a>.</p>
<blockquote>
<div><table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.ff.make_ff_factors" title="pyanomaly.ff.make_ff_factors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_ff_factors</span></code></a></p></td>
<td><p>Generate Fama-French 3 factors.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.ff.make_ff_factors_wrds" title="pyanomaly.ff.make_ff_factors_wrds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_ff_factors_wrds</span></code></a></p></td>
<td><p>Generate Fama-French 3 factors (copy of the WRDS code).</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.ff.make_ff_factors">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.ff.</span></span><span class="sig-name descname"><span class="pre">make_ff_factors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.ff.make_ff_factors" title="Link to this definition"></a></dt>
<dd><p>Generate Fama-French 3 factors.</p>
<p>This function refers to the WRDS code, but the results are slightly different as the code is written under
the architecture of PyAnomaly. Compared to the data from the K. French website, HML has a correlation of 0.967,
and SMB has a correlation of 0.989. Compared to the WRDS code, HML has a correlation of 0.991,
and SMB has a correlation of 0.993.</p>
<p>Major differences from WRDS code:</p>
<ol class="arabic simple">
<li><p>Primary stock identification: for our method, refer to <a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.add_gvkey_to_crsp" title="pyanomaly.wrdsdata.WRDS.add_gvkey_to_crsp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WRDS.add_gvkey_to_crsp()</span></code></a>.</p></li>
<li><p>Delist return: for our method, refer to <a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.merge_sf_with_seall" title="pyanomaly.wrdsdata.WRDS.merge_sf_with_seall"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WRDS.merge_sf_with_seall()</span></code></a>.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>Factors. DataFrame with index = ‘date’, columns = [‘bh’, ‘bm’, ‘bl’, ‘sh’, ‘sm’, ‘sl’, ‘hml’, ‘smb’].</p></li>
<li><p>Number of firms. DataFrame with index = ‘date’, columns = [‘bh’, ‘bm’, ‘bl’, ‘sh’, ‘sm’, ‘sl’, ‘hml’, ‘smb’].</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>WRDS code: <a class="reference external" href="https://wrds-www.wharton.upenn.edu/pages/support/applications/python-replications/fama-french-factors-python/">https://wrds-www.wharton.upenn.edu/pages/support/applications/python-replications/fama-french-factors-python/</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.ff.make_ff_factors_wrds">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.ff.</span></span><span class="sig-name descname"><span class="pre">make_ff_factors_wrds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.ff.make_ff_factors_wrds" title="Link to this definition"></a></dt>
<dd><p>Generate Fama-French 3 factors (copy of the WRDS code).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>Factors. DataFrame with index = ‘date’, columns = [‘bh’, ‘bm’, ‘bl’, ‘sh’, ‘sm’, ‘sl’, ‘hml’, ‘smb’].</p></li>
<li><p>Number of firms. DataFrame with index = ‘date’, columns = [‘bh’, ‘bm’, ‘bl’, ‘sh’, ‘sm’, ‘sl’, ‘hml’, ‘smb’].</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>WRDS code: <a class="reference external" href="https://wrds-www.wharton.upenn.edu/pages/support/applications/python-replications/fama-french-factors-python/">https://wrds-www.wharton.upenn.edu/pages/support/applications/python-replications/fama-french-factors-python/</a></p>
</dd></dl>

</section>
<section id="module-pyanomaly.fileio">
<span id="fileio"></span><h2>fileio<a class="headerlink" href="#module-pyanomaly.fileio" title="Link to this heading"></a></h2>
<p>This module defines functions for file IO.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.fileio.write_to_file" title="pyanomaly.fileio.write_to_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_to_file</span></code></a></p></td>
<td><p>Write data to a file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.fileio.read_from_file" title="pyanomaly.fileio.read_from_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_from_file</span></code></a></p></td>
<td><p>Read data from a file.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.fileio.read_from_file">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.fileio.</span></span><span class="sig-name descname"><span class="pre">read_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typecast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.fileio.read_from_file" title="Link to this definition"></a></dt>
<dd><p>Read data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> – File name without extension.</p></li>
<li><p><strong>fdir</strong> – Directory. If None, <code class="docutils literal notranslate"><span class="pre">config.output_dir</span></code>.</p></li>
<li><p><strong>typecast</strong> – If True, cast float to <code class="docutils literal notranslate"><span class="pre">config.float_type</span></code> and object to string after reading from a file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame read from <cite>fdir/fname</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.fileio.write_to_file">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.fileio.</span></span><span class="sig-name descname"><span class="pre">write_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typecast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.fileio.write_to_file" title="Link to this definition"></a></dt>
<dd><p>Write data to a file.</p>
<p>The <cite>data</cite> is saved to <cite>fdir/fname</cite>. The file format is determined by <code class="docutils literal notranslate"><span class="pre">config.file_format</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame to save.</p></li>
<li><p><strong>fname</strong> – File name without extension.</p></li>
<li><p><strong>fdir</strong> – Directory. If None, <code class="docutils literal notranslate"><span class="pre">config.output_dir</span></code>.</p></li>
<li><p><strong>typecast</strong> – If True, cast float to <code class="docutils literal notranslate"><span class="pre">config.float_type</span></code> and object to string before writing to a file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyanomaly.globals">
<span id="globals"></span><h2>globals<a class="headerlink" href="#module-pyanomaly.globals" title="Link to this heading"></a></h2>
<p>This module defines global constants. Importing this module will also import frequently used modules:
<a class="reference internal" href="#module-pyanomaly.config" title="pyanomaly.config"><code class="xref py py-mod docutils literal notranslate"><span class="pre">config</span></code></a>, <a class="reference internal" href="#module-pyanomaly.log" title="pyanomaly.log"><code class="xref py py-mod docutils literal notranslate"><span class="pre">log</span></code></a>, and <a class="reference internal" href="#module-pyanomaly.util" title="pyanomaly.util"><code class="xref py py-mod docutils literal notranslate"><span class="pre">util</span></code></a>.</p>
<section id="constants">
<h3>Constants<a class="headerlink" href="#constants" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>Weight_scheme</dt><dd><ul class="simple">
<li><p>VW: value-weight</p></li>
<li><p>EW: equal-weight</p></li>
</ul>
</dd>
<dt>Data frequency</dt><dd><ul class="simple">
<li><p>ANNUAL</p></li>
<li><p>QUARTERLY</p></li>
<li><p>MONTHLY</p></li>
<li><p>DAILY</p></li>
</ul>
</dd>
</dl>
</section>
</section>
<section id="module-pyanomaly.log">
<span id="log"></span><span id="pyanomaly-jkp"></span><h2>log<a class="headerlink" href="#module-pyanomaly.log" title="Link to this heading"></a></h2>
<p>This module defines logging functions.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.log.set_log_path" title="pyanomaly.log.set_log_path"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_log_path</span></code></a></p></td>
<td><p>Set log file path.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.log.log" title="pyanomaly.log.log"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log</span></code></a></p></td>
<td><p>Write log message.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.log.err" title="pyanomaly.log.err"><code class="xref py py-obj docutils literal notranslate"><span class="pre">err</span></code></a></p></td>
<td><p>Write error message.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.log.warn" title="pyanomaly.log.warn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">warn</span></code></a></p></td>
<td><p>Write warning message.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.log.debug" title="pyanomaly.log.debug"><code class="xref py py-obj docutils literal notranslate"><span class="pre">debug</span></code></a></p></td>
<td><p>Write debugging message.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.log.drawline" title="pyanomaly.log.drawline"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drawline</span></code></a></p></td>
<td><p>Draw line in the log file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.log.start_timer" title="pyanomaly.log.start_timer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">start_timer</span></code></a></p></td>
<td><p>Start timer.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.log.elapsed_time" title="pyanomaly.log.elapsed_time"><code class="xref py py-obj docutils literal notranslate"><span class="pre">elapsed_time</span></code></a></p></td>
<td><p>Get elapsed time.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.log.debug">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.log.</span></span><span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.log.debug" title="Link to this definition"></a></dt>
<dd><p>Write debugging message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msg</strong> – Debugging message.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.log.drawline">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.log.</span></span><span class="sig-name descname"><span class="pre">drawline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.log.drawline" title="Link to this definition"></a></dt>
<dd><p>Draw line in the log file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – Shape of line. 0: ‘#’, 1: ‘*’, 2: ‘-’</p></li>
<li><p><strong>width</strong> – Line width.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.log.elapsed_time">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.log.</span></span><span class="sig-name descname"><span class="pre">elapsed_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headmsg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.log.elapsed_time" title="Link to this definition"></a></dt>
<dd><p>Get elapsed time.</p>
<p>The total elapsed time (‘hh:mm:ss’) since the timer started and the elapsed time (in seconds) since the last
call of this function are printed. If <a class="reference internal" href="#pyanomaly.log.start_timer" title="pyanomaly.log.start_timer"><code class="xref py py-func docutils literal notranslate"><span class="pre">start_timer()</span></code></a> was never called before, this function starts timer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> – Message to print.</p></li>
<li><p><strong>headmsg</strong> – Message header.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">start_timer</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">)</span>
<span class="go">[2024/02/06 01:14] Timer On: start</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">elapsed_time</span><span class="p">(</span><span class="s1">&#39;check1&#39;</span><span class="p">)</span>
<span class="go">[2024/02/06 01:15] Elapsed [0:00:35.564, 35.564]: check1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">elapsed_time</span><span class="p">(</span><span class="s1">&#39;check2&#39;</span><span class="p">,</span> <span class="s1">&#39;parallel1&#39;</span><span class="p">)</span>
<span class="go">[2024/02/06 01:15: parallel1] Elapsed [0:00:53.802, 18.238]: check1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.log.err">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.log.</span></span><span class="sig-name descname"><span class="pre">err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.log.err" title="Link to this definition"></a></dt>
<dd><p>Write error message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msg</strong> – Error message.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.log.log">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.log.</span></span><span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headmsg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.log.log" title="Link to this definition"></a></dt>
<dd><p>Write log message.</p>
<p>The format is [yyyy/mm/dd hh:mm: <cite>headmsg</cite>] <cite>msg</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> – Log message.</p></li>
<li><p><strong>headmsg</strong> – Message header.</p></li>
<li><p><strong>header</strong> – If True, write the header.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.log.set_log_path">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.log.</span></span><span class="sig-name descname"><span class="pre">set_log_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.log.set_log_path" title="Link to this definition"></a></dt>
<dd><p>Set log file path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fpath</strong> – Log file name or path or <code class="docutils literal notranslate"><span class="pre">__file__</span></code>. If it’s a name, the path becomes <code class="docutils literal notranslate"><span class="pre">config.log_dir</span></code> + <cite>fpath</cite>.
If <code class="docutils literal notranslate"><span class="pre">__file__</span></code> , the name of the module calling this function is retrieved from <code class="docutils literal notranslate"><span class="pre">__file__</span></code> and
the path is set to <code class="docutils literal notranslate"><span class="pre">config.log_dir</span></code> + module name. If None, the path is <code class="docutils literal notranslate"><span class="pre">config.log_dir</span></code> + ‘log.log’.</p></li>
<li><p><strong>append</strong> – If True, append to the existing log file. Otherwise, delete the current log file.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">set_log_path</span><span class="p">(</span><span class="s1">&#39;./log/example.log&#39;</span><span class="p">)</span>  <span class="c1"># Full file path.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_log_path</span><span class="p">(</span><span class="s1">&#39;example.log&#39;</span><span class="p">)</span>  <span class="c1"># file name. Path = config.log_dir + &#39;example.log&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_log_path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>  <span class="c1"># Make path from a module name. Path = config.log_dir + module name</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.log.start_timer">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.log.</span></span><span class="sig-name descname"><span class="pre">start_timer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headmsg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.log.start_timer" title="Link to this definition"></a></dt>
<dd><p>Start timer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> – Message to print.</p></li>
<li><p><strong>headmsg</strong> – Message header.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.log.warn">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.log.</span></span><span class="sig-name descname"><span class="pre">warn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.log.warn" title="Link to this definition"></a></dt>
<dd><p>Write warning message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msg</strong> – Warning message.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyanomaly.numba_support">
<span id="numba-support"></span><h2>numba_support<a class="headerlink" href="#module-pyanomaly.numba_support" title="Link to this heading"></a></h2>
<p>This module defines jitted function.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.numba_support.nansum" title="pyanomaly.numba_support.nansum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nansum</span></code></a></p></td>
<td><p>Sum excluding nan.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.numba_support.nanmean" title="pyanomaly.numba_support.nanmean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nanmean</span></code></a></p></td>
<td><p>Mean excluding nan.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.numba_support.nanvar" title="pyanomaly.numba_support.nanvar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nanvar</span></code></a></p></td>
<td><p>Variance excluding nan.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.numba_support.nanstd" title="pyanomaly.numba_support.nanstd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nanstd</span></code></a></p></td>
<td><p>Standard deviation excluding nan.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.numba_support.nanskew" title="pyanomaly.numba_support.nanskew"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nanskew</span></code></a></p></td>
<td><p>Skewness excluding nan.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.numba_support.shift" title="pyanomaly.numba_support.shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shift</span></code></a></p></td>
<td><p>Shift.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.numba_support.roll_sum" title="pyanomaly.numba_support.roll_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">roll_sum</span></code></a></p></td>
<td><p>Rolling sum.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.numba_support.roll_mean" title="pyanomaly.numba_support.roll_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">roll_mean</span></code></a></p></td>
<td><p>Rolling mean.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.numba_support.roll_var" title="pyanomaly.numba_support.roll_var"><code class="xref py py-obj docutils literal notranslate"><span class="pre">roll_var</span></code></a></p></td>
<td><p>Rolling variance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.numba_support.roll_std" title="pyanomaly.numba_support.roll_std"><code class="xref py py-obj docutils literal notranslate"><span class="pre">roll_std</span></code></a></p></td>
<td><p>Rolling standard deviation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.numba_support.rank" title="pyanomaly.numba_support.rank"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rank</span></code></a></p></td>
<td><p>Rank.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.numba_support.set_to_nan" title="pyanomaly.numba_support.set_to_nan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_to_nan</span></code></a></p></td>
<td><p>Set rows to nan.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.numba_support.isnan1" title="pyanomaly.numba_support.isnan1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">isnan1</span></code></a></p></td>
<td><p>Check nan along columns.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.numba_support.add_constant" title="pyanomaly.numba_support.add_constant"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_constant</span></code></a></p></td>
<td><p>Add a constant column to a matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.numba_support.bivariate_regression" title="pyanomaly.numba_support.bivariate_regression"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bivariate_regression</span></code></a></p></td>
<td><p>Bivariate regression.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.numba_support.regression" title="pyanomaly.numba_support.regression"><code class="xref py py-obj docutils literal notranslate"><span class="pre">regression</span></code></a></p></td>
<td><p>Multivariate regression.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.numba_support.rolling_regression" title="pyanomaly.numba_support.rolling_regression"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_regression</span></code></a></p></td>
<td><p>Rolling regression.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.add_constant">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">add_constant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.add_constant" title="Link to this definition"></a></dt>
<dd><p>Add a constant column to a matrix.</p>
<p>A vector of 1’s is prepended to <cite>x</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – N x K ndarray.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N x (K+1) ndarray (<cite>x</cite> with a vector of 1’s prepended).</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">... </span><span class="n">x</span>
<span class="go">[[1 2]</span>
<span class="go"> [3 4]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[[1 1 2]</span>
<span class="go"> [1 3 4]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.bivariate_regression">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">bivariate_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.bivariate_regression" title="Link to this definition"></a></dt>
<dd><p>Bivariate regression.</p>
<p>A constant is added internally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> – Nx1 ndarray. Dependent variable.</p></li>
<li><p><strong>x</strong> – Nx1 ndarray. Independent variable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Coefficients. 2x1 ndarray of [constant, beta].</p></li>
<li><p>R-squared.</p></li>
<li><p>Residuals. Nx1 ndarray.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.isnan1">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">isnan1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.isnan1" title="Link to this definition"></a></dt>
<dd><p>Check nan along columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – NxK ndarray.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nx1 bool ndarray. True if any value in the corresponding row of <cite>x</cite> is nan, False otherwise.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="gp">... </span><span class="n">x</span>
<span class="go">[[nan  1.  2.]</span>
<span class="go"> [ 1.  2.  3.]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">isnan1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[ True, False]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.nanmean">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">nanmean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.nanmean" title="Link to this definition"></a></dt>
<dd><p>Mean excluding nan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – 1D ndarray.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mean of <cite>x</cite> excluding nan.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.nanskew">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">nanskew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.nanskew" title="Link to this definition"></a></dt>
<dd><p>Skewness excluding nan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – 1D ndarray.</p></li>
<li><p><strong>dof</strong> – Degrees of freedom. 0 (1) for biased (unbiased) estimate. Default to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Skewness of <cite>x</cite> excluding nan.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.nanstd">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">nanstd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.nanstd" title="Link to this definition"></a></dt>
<dd><p>Standard deviation excluding nan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – 1D ndarray.</p></li>
<li><p><strong>dof</strong> – Degrees of freedom. 0 (1) for biased (unbiased) estimate. Default to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Standard deviation of <cite>x</cite> excluding nan.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.nansum">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">nansum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.nansum" title="Link to this definition"></a></dt>
<dd><p>Sum excluding nan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – 1D ndarray.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sum of <cite>x</cite> excluding nan.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.nanvar">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">nanvar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.nanvar" title="Link to this definition"></a></dt>
<dd><p>Variance excluding nan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – 1D ndarray.</p></li>
<li><p><strong>dof</strong> – Degrees of freedom. 0 (1) for biased (unbiased) estimate. Default to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Variance of <cite>x</cite> excluding nan.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.rank">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.rank" title="Link to this definition"></a></dt>
<dd><p>Rank.</p>
<p>Calculate ranks of the elements of <cite>x</cite> within each column. Nan values are excluded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Ndarray.</p></li>
<li><p><strong>ascending</strong> – If True, rank increases with value starting from 1.</p></li>
<li><p><strong>pct</strong> – If True, percentile ranks are returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(Percentile) ranks of <cite>x</cite>. Ndarray of the same size as <cite>x</cite>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">... </span><span class="n">x</span>
<span class="go">array([[ 1.,  1.],</span>
<span class="go">       [ 2.,  2.],</span>
<span class="go">       [ 0.,  3.],</span>
<span class="go">       [nan,  4.],</span>
<span class="go">       [ 3.,  5.],</span>
<span class="go">       [-1.,  6.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rank</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">array([[ 3.,  1.],</span>
<span class="go">       [ 4.,  2.],</span>
<span class="go">       [ 2.,  3.],</span>
<span class="go">       [nan,  4.],</span>
<span class="go">       [ 5.,  5.],</span>
<span class="go">       [ 1.,  6.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rank</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">array([[0.6       , 0.16666667],</span>
<span class="go">       [0.8       , 0.33333333],</span>
<span class="go">       [0.4       , 0.5       ],</span>
<span class="go">       [       nan, 0.66666667],</span>
<span class="go">       [1.        , 0.83333333],</span>
<span class="go">       [0.2       , 1.        ]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.regression">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.regression" title="Link to this definition"></a></dt>
<dd><p>Multivariate regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> – Nx1 ndarray. Dependent variable.</p></li>
<li><p><strong>X</strong> – NxK ndarray. Independent variables (including constant).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Coefficients. Kx1 ndarray.</p></li>
<li><p>R-squared.</p></li>
<li><p>Residuals. Nx1 ndarray.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.roll_mean">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">roll_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.roll_mean" title="Link to this definition"></a></dt>
<dd><p>Rolling mean.</p>
<p>The <cite>x</cite> is rolled along the first axis with the window size <cite>n</cite>, and the mean of each window is calculated.
Nan values are excluded: The result will be nan if the number of not-nan values is smaller than <cite>min_n</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Ndarray.</p></li>
<li><p><strong>n</strong> – Window size.</p></li>
<li><p><strong>min_n</strong> – Minimum number of observations. Default to <cite>n</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rolling mean. Ndarray of the same size as <cite>x</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.roll_std">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">roll_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.roll_std" title="Link to this definition"></a></dt>
<dd><p>Rolling standard deviation.</p>
<p>The <cite>x</cite> is rolled along the first axis with the window size <cite>n</cite>, and the standard deviation of each window is
calculated. Nan values are excluded: The result will be nan if the number of not-nan values is smaller than <cite>min_n</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Ndarray.</p></li>
<li><p><strong>n</strong> – Window size.</p></li>
<li><p><strong>min_n</strong> – Minimum number of observations. Default to <cite>n</cite>.</p></li>
<li><p><strong>dof</strong> – Degrees of freedom. 0 (1) for biased (unbiased) estimate. Default to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rolling standard deviation. Ndarray of the same size as <cite>x</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.roll_sum">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">roll_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.roll_sum" title="Link to this definition"></a></dt>
<dd><p>Rolling sum.</p>
<p>The <cite>x</cite> is rolled along the first axis with the window size <cite>n</cite>, and the sum of each window is calculated.
Nan values are excluded: The result will be nan if the number of not-nan values is smaller than <cite>min_n</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Ndarray.</p></li>
<li><p><strong>n</strong> – Window size.</p></li>
<li><p><strong>min_n</strong> – Minimum number of observations. Default to <cite>n</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rolling sum. Ndarray of the same size as <cite>x</cite>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">... </span><span class="n">x</span>
<span class="go">array([[ 1.,  1.],</span>
<span class="go">       [ 2.,  2.],</span>
<span class="go">       [ 0.,  3.],</span>
<span class="go">       [nan,  4.],</span>
<span class="go">       [ 3.,  5.],</span>
<span class="go">       [-1.,  6.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">roll_sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">array([[nan, nan],</span>
<span class="go">       [nan, nan],</span>
<span class="go">       [ 3.,  6.],</span>
<span class="go">       [nan,  9.],</span>
<span class="go">       [nan, 12.],</span>
<span class="go">       [nan, 15.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">roll_sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">array([[nan, nan],</span>
<span class="go">       [ 3.,  3.],</span>
<span class="go">       [ 3.,  6.],</span>
<span class="go">       [ 2.,  9.],</span>
<span class="go">       [ 3., 12.],</span>
<span class="go">       [ 2., 15.]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.roll_var">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">roll_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.roll_var" title="Link to this definition"></a></dt>
<dd><p>Rolling variance.</p>
<p>The <cite>x</cite> is rolled along the first axis with the window size <cite>n</cite>, and the variance of each window is calculated.
Nan values are excluded: The result will be nan if the number of not-nan values is smaller than <cite>min_n</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Ndarray.</p></li>
<li><p><strong>n</strong> – Window size.</p></li>
<li><p><strong>min_n</strong> – Minimum number of observations. Default to <cite>n</cite>.</p></li>
<li><p><strong>dof</strong> – Degrees of freedom. 0 (1) for biased (unbiased) estimate. Default to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rolling variance. Ndarray of the same size as <cite>x</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.rolling_regression">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">rolling_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_const</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.rolling_regression" title="Link to this definition"></a></dt>
<dd><p>Rolling regression.</p>
<p>The <cite>data</cite> is rolled along the first axis with the window size <cite>n</cite>, and the regression is conducted for each window.
Nan values are excluded: The result will be nan if the number of not-nan values is smaller than <cite>min_n</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – NxK ndarray. The first column is the dependent variable and the rest are the independent variables.</p></li>
<li><p><strong>n</strong> – Window size.</p></li>
<li><p><strong>min_n</strong> – Minimum number of observations. Default to <cite>n</cite>.</p></li>
<li><p><strong>add_const</strong> – If True, add a constant to the independent variables.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Nx(K’+2) ndarray. K’ = K if add_const is True, else K’ = K-1.</p>
<blockquote>
<div><ul class="simple">
<li><p>First K’ columns: Coefficients.</p></li>
<li><p>K’+1-th column: R-squared.</p></li>
<li><p>K’+2-th column: Idiosyncratic volatility (standard deviation of residuals).</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.set_to_nan">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">set_to_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.set_to_nan" title="Link to this definition"></a></dt>
<dd><p>Set rows to nan.</p>
<p>Set the first <cite>n</cite> (last <cite>-n</cite> if <cite>n</cite> &lt; 0) rows of <cite>x</cite> to nan. The <cite>x</cite> is changed in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Ndarray.</p></li>
<li><p><strong>n</strong> – Number of rows to set to nan.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.numba_support.shift">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.numba_support.</span></span><span class="sig-name descname"><span class="pre">shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.numba_support.shift" title="Link to this definition"></a></dt>
<dd><p>Shift.</p>
<p><cite>x</cite> is shifted by <cite>n</cite> along the first axis. A negative <cite>n</cite> shifts <cite>x</cite> backward.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Ndarray.</p></li>
<li><p><strong>n</strong> – Shift size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Shifted <cite>x</cite>. Ndarray of the same size as <cite>x</cite>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyanomaly.panel">
<span id="panel"></span><h2>panel<a class="headerlink" href="#module-pyanomaly.panel" title="Link to this heading"></a></h2>
<p>This module defines classes for panel data analysis.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel" title="pyanomaly.panel.Panel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Panel</span></code></a></p></td>
<td><p>Base class for panel data analysis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.FCPanel" title="pyanomaly.panel.FCPanel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FCPanel</span></code></a></p></td>
<td><p>Base class for firm characteristic generation.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.panel.</span></span><span class="sig-name descname"><span class="pre">FCPanel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.FCPanel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanomaly.panel.Panel" title="pyanomaly.panel.Panel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Panel</span></code></a></p>
<p>Base class for firm characteristic generation.</p>
<p>For each firm characteristic, there should be one method to generate it and the method name should start with ‘c_’.
Generated firm characteristics are added to the <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute with column names equal to their method names
(without ‘c_’).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias</strong> (<em>str</em><em>, </em><em>list</em><em>, or </em><em>dict</em>) – <p>Firm characteristics to generate and their aliases. If None, all available firm
characteristics are generated.</p>
<ul>
<li><p>str: A column name in the mapping file (<code class="docutils literal notranslate"><span class="pre">config.mapping_file_path</span></code>). The firm characteristics defined
in this class and in the <cite>alias</cite> column of the mapping file are generated. See <a class="reference internal" href="getting_started.html#sec-mapping-file"><span class="std std-ref">Mapping File</span></a>.</p></li>
<li><p>list: List of firm characteristics (method names).</p></li>
<li><p>dict: Dict of firm characteristics and their aliases of the form {method name: alias}.</p></li>
</ul>
<p>If aliases are not specified, method names are used as aliases.</p>
</p></li>
<li><p><strong>data</strong> – Raw data DataFrame with index = date/id, sorted on id/date.</p></li>
<li><p><strong>freq</strong> – Frequency of <cite>data</cite>. ANNUAL, QUARTERLY, MONTHLY, or DAILY.</p></li>
<li><p><strong>base_freq</strong> – Frequency of <cite>data</cite> values. ANNUAL, QUARTERLY, MONTHLY, or DAILY.
For example, if funda is populated monthly, <cite>freq</cite> = MONTHLY and <cite>base_freq</cite> = ANNUAL.
If None, <cite>base_freq</cite> = <cite>freq</cite>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Firm characteristics are stored in the <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute with column names equal to their method
names (without ‘c_’). When a <code class="docutils literal notranslate"><span class="pre">FCPanel</span></code> is saved to a file using <a class="reference internal" href="#pyanomaly.panel.FCPanel.save" title="pyanomaly.panel.FCPanel.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a>, the firm characteristic
columns are renamed by the aliases , and when a saved <code class="docutils literal notranslate"><span class="pre">FCPanel</span></code> is loaded using <a class="reference internal" href="#pyanomaly.panel.FCPanel.load" title="pyanomaly.panel.FCPanel.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a>,
the firm characteristic columns are renamed by the method names.</p>
</div>
<p><strong>Attributes</strong></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#pyanomaly.panel.FCPanel.data" title="Link to this definition"></a></dt>
<dd><p>DataFrame with index = date/id, sorted on id/date that stores a panel data.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel.freq">
<span class="sig-name descname"><span class="pre">freq</span></span><a class="headerlink" href="#pyanomaly.panel.FCPanel.freq" title="Link to this definition"></a></dt>
<dd><p>Frequency of <code class="docutils literal notranslate"><span class="pre">data</span></code>. ANNUAL, QUARTERLY, MONTHLY, or DAILY.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel.base_freq">
<span class="sig-name descname"><span class="pre">base_freq</span></span><a class="headerlink" href="#pyanomaly.panel.FCPanel.base_freq" title="Link to this definition"></a></dt>
<dd><p>Frequency of <code class="docutils literal notranslate"><span class="pre">data</span></code> values. ANNUAL, QUARTERLY, MONTHLY, or DAILY.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel.char_map">
<span class="sig-name descname"><span class="pre">char_map</span></span><a class="headerlink" href="#pyanomaly.panel.FCPanel.char_map" title="Link to this definition"></a></dt>
<dd><p>Dictionary to map firm characteristic generation methods with aliases: <code class="docutils literal notranslate"><span class="pre">char_map['method']</span></code> returns
the alias.</p>
</dd></dl>

<p><strong>Methods</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.FCPanel.show_available_chars" title="pyanomaly.panel.FCPanel.show_available_chars"><code class="xref py py-obj docutils literal notranslate"><span class="pre">show_available_chars</span></code></a></p></td>
<td><p>Display firm characteristics available in this class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.FCPanel.get_available_chars" title="pyanomaly.panel.FCPanel.get_available_chars"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_available_chars</span></code></a></p></td>
<td><p>Get all firm characteristics available in this class.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.FCPanel.get_char_list" title="pyanomaly.panel.FCPanel.get_char_list"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_char_list</span></code></a></p></td>
<td><p>Get the firm characteristics to generate.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.FCPanel.create_chars" title="pyanomaly.panel.FCPanel.create_chars"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_chars</span></code></a></p></td>
<td><p>Generate firm characteristics.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.FCPanel.created" title="pyanomaly.panel.FCPanel.created"><code class="xref py py-obj docutils literal notranslate"><span class="pre">created</span></code></a></p></td>
<td><p>Check if a firm characteristic has already been created.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.FCPanel.prepare" title="pyanomaly.panel.FCPanel.prepare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare</span></code></a></p></td>
<td><p>Prepare characteristics that are required to generate a characteristic.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.FCPanel.rename_chars" title="pyanomaly.panel.FCPanel.rename_chars"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rename_chars</span></code></a></p></td>
<td><p>Rename the firm characteristic columns.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.FCPanel.remove_rawdata" title="pyanomaly.panel.FCPanel.remove_rawdata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_rawdata</span></code></a></p></td>
<td><p>Remove raw data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.FCPanel.save" title="pyanomaly.panel.FCPanel.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a></p></td>
<td><p>Save this object to a file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.FCPanel.load" title="pyanomaly.panel.FCPanel.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a></p></td>
<td><p>Load a FCPanel object from a file.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel.create_chars">
<span class="sig-name descname"><span class="pre">create_chars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">char_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.FCPanel.create_chars" title="Link to this definition"></a></dt>
<dd><p>Generate firm characteristics.</p>
<p>Generated firm characteristics are added to <a class="reference internal" href="#pyanomaly.panel.FCPanel.data" title="pyanomaly.panel.FCPanel.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> using their method names as the column names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>char_list</strong> – List or dict of firm characteristics (method names) to generate. If dict, keys should be method
names and values aliases. If None, all firm characteristics available in this class and specified by the
<cite>alias</cite> argument are generated.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel.created">
<span class="sig-name descname"><span class="pre">created</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">char</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.FCPanel.created" title="Link to this definition"></a></dt>
<dd><p>Check if a firm characteristic has already been created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>char</strong> – Firm characteristic (the method name without ‘c_’) to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the firm characteristic has been created.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel.get_available_chars">
<span class="sig-name descname"><span class="pre">get_available_chars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.FCPanel.get_available_chars" title="Link to this definition"></a></dt>
<dd><p>Get all firm characteristics available in this class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of characteristics (method names)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel.get_char_list">
<span class="sig-name descname"><span class="pre">get_char_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.FCPanel.get_char_list" title="Link to this definition"></a></dt>
<dd><p>Get the firm characteristics to generate.</p>
<p>Among all the firm characteristics to generate, the firm characteristics defined in this class are returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary of firm characteristics with keys equal to method names and values equal to aliases.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.FCPanel.load" title="Link to this definition"></a></dt>
<dd><p>Load a FCPanel object from a file.</p>
<p>Firm characteristic columns are renamed by method names after loading.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> – File name without extension. If None, <cite>fname</cite> = lower-case class name .</p></li>
<li><p><strong>fdir</strong> – Directory to read the file from. If None, <cite>fdir</cite> = <code class="docutils literal notranslate"><span class="pre">config.output_dir</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel.prepare">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">char_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.FCPanel.prepare" title="Link to this definition"></a></dt>
<dd><p>Prepare characteristics that are required to generate a characteristic.</p>
<p>If a characteristic is defined as a function of other characteristics, this function will check whether they
already exist and generate them if they don’t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>char_list</strong> – list of firm characteristics (method names without ‘c_’) to prepare.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel.remove_rawdata">
<span class="sig-name descname"><span class="pre">remove_rawdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">excl_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.FCPanel.remove_rawdata" title="Link to this definition"></a></dt>
<dd><p>Remove raw data.</p>
<p>Raw data columns of <a class="reference internal" href="#pyanomaly.panel.FCPanel.data" title="pyanomaly.panel.FCPanel.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> except <cite>excl_columns</cite> are deleted. If raw data are not needed after generating
firm characteristics, calling this method can reduce memory and hard disc usage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>excl_columns</strong> – List of columns to exclude.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel.rename_chars">
<span class="sig-name descname"><span class="pre">rename_chars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.FCPanel.rename_chars" title="Link to this definition"></a></dt>
<dd><p>Rename the firm characteristic columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>to_alias</strong> – If True, rename firm characteristic columns from method names to aliases, and vice versa.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.FCPanel.save" title="Link to this definition"></a></dt>
<dd><p>Save this object to a file.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute is saved to a <code class="docutils literal notranslate"><span class="pre">config.file_format</span></code> file and the other attributes are saved to a json
file. Firm characteristic columns are renamed by aliases before saving.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> – File name without extension. If None, <cite>fname</cite> = lower-case class name.</p></li>
<li><p><strong>fdir</strong> – Directory to save the file. If None, <cite>fdir</cite> = <code class="docutils literal notranslate"><span class="pre">config.output_dir</span></code>.</p></li>
<li><p><strong>other_columns</strong> – List of columns other than firm characteristic columns to save. If None, only firm
characteristics are saved; if ‘all’, all columns are saved; if list, firm characteristic columns plus
<cite>other_columns</cite> are saved.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.FCPanel.show_available_chars">
<span class="sig-name descname"><span class="pre">show_available_chars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.FCPanel.show_available_chars" title="Link to this definition"></a></dt>
<dd><p>Display firm characteristics available in this class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>all</strong> – If True, display all firm characteristics available in this class, otherwise, display only the firm
characteristics to generate.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.panel.</span></span><span class="sig-name descname"><span class="pre">Panel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for panel data analysis.</p>
<p>This class stores a panel data, <cite>data</cite>, and offers various tools to handle and analyze it.
The <cite>data</cite> should be a Pandas DataFrame with a MultiIndex = date/id, i.e., the first  index should be a time-series
identifier (Pandas datetime type) and the second index a cross-section identifier. It should be sorted on id/date.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Panel data DataFrame with index = date/id, sorted on id/date.</p></li>
<li><p><strong>freq</strong> – Frequency of <cite>data</cite>. ANNUAL, QUARTERLY, MONTHLY, or DAILY.</p></li>
<li><p><strong>base_freq</strong> – Frequency of <cite>data</cite> values. For example, if <cite>data</cite> has annual values populated monthly,
<cite>freq</cite> = MONTHLY and <cite>base_freq</cite> = ANNUAL. If None, <cite>base_freq</cite> = <cite>freq</cite>.</p></li>
</ul>
</dd>
</dl>
<p><strong>Attributes</strong></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#pyanomaly.panel.Panel.data" title="Link to this definition"></a></dt>
<dd><p>DataFrame with index = date/id, sorted on id/date that stores a panel data.
The items of <cite>data</cite> can be accessed by <code class="docutils literal notranslate"><span class="pre">Panel.__get_item__()</span></code>: For a <code class="docutils literal notranslate"><span class="pre">Panel</span></code> instance <code class="docutils literal notranslate"><span class="pre">panel</span></code>,
<code class="docutils literal notranslate"><span class="pre">panel[cols]</span></code> and <code class="docutils literal notranslate"><span class="pre">panel[rows,</span> <span class="pre">cols]</span></code> are equivalent to <code class="docutils literal notranslate"><span class="pre">panel.data[col]</span></code> and
<code class="docutils literal notranslate"><span class="pre">panel.data.loc[rows,</span> <span class="pre">cols]</span></code>, respectively.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.freq">
<span class="sig-name descname"><span class="pre">freq</span></span><a class="headerlink" href="#pyanomaly.panel.Panel.freq" title="Link to this definition"></a></dt>
<dd><p>Frequency of <code class="docutils literal notranslate"><span class="pre">data</span></code>. ANNUAL, QUARTERLY, MONTHLY, or DAILY.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.base_freq">
<span class="sig-name descname"><span class="pre">base_freq</span></span><a class="headerlink" href="#pyanomaly.panel.Panel.base_freq" title="Link to this definition"></a></dt>
<dd><p>Frequency of <code class="docutils literal notranslate"><span class="pre">data</span></code> values. ANNUAL, QUARTERLY, MONTHLY, or DAILY.</p>
</dd></dl>

<p><strong>Methods</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.is_sorted" title="pyanomaly.panel.Panel.is_sorted"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_sorted</span></code></a></p></td>
<td><p>Check if a panel data is sorted on id/date.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.id_idx" title="pyanomaly.panel.Panel.id_idx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">id_idx</span></code></a></p></td>
<td><p>Get id index name.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.date_idx" title="pyanomaly.panel.Panel.date_idx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">date_idx</span></code></a></p></td>
<td><p>Get date index name.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.id_values" title="pyanomaly.panel.Panel.id_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">id_values</span></code></a></p></td>
<td><p>Get id index values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.date_values" title="pyanomaly.panel.Panel.date_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">date_values</span></code></a></p></td>
<td><p>Get date index values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.get_id_group" title="pyanomaly.panel.Panel.get_id_group"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_id_group</span></code></a></p></td>
<td><p>Get id group.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.get_date_group" title="pyanomaly.panel.Panel.get_date_group"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_date_group</span></code></a></p></td>
<td><p>Get date group.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.get_id_group_size" title="pyanomaly.panel.Panel.get_id_group_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_id_group_size</span></code></a></p></td>
<td><p>Get id group sizes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.get_date_group_size" title="pyanomaly.panel.Panel.get_date_group_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_date_group_size</span></code></a></p></td>
<td><p>Get date group sizes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.get_id_group_index" title="pyanomaly.panel.Panel.get_id_group_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_id_group_index</span></code></a></p></td>
<td><p>Get id group indices.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.get_date_group_index" title="pyanomaly.panel.Panel.get_date_group_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_date_group_index</span></code></a></p></td>
<td><p>Get date group indices.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.apply_to_ids" title="pyanomaly.panel.Panel.apply_to_ids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_to_ids</span></code></a></p></td>
<td><p>Apply a function to each id group.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.apply_to_dates" title="pyanomaly.panel.Panel.apply_to_dates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_to_dates</span></code></a></p></td>
<td><p>Apply a function to each date group.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.populate" title="pyanomaly.panel.Panel.populate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">populate</span></code></a></p></td>
<td><p>Populate data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.merge" title="pyanomaly.panel.Panel.merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge</span></code></a></p></td>
<td><p>Merge with another data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.inspect_data" title="pyanomaly.panel.Panel.inspect_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inspect_data</span></code></a></p></td>
<td><p>Inspect data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.filter" title="pyanomaly.panel.Panel.filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code></a></p></td>
<td><p>Filter data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.get_row_count" title="pyanomaly.panel.Panel.get_row_count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_row_count</span></code></a></p></td>
<td><p>Get row count per id.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.remove_rows" title="pyanomaly.panel.Panel.remove_rows"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_rows</span></code></a></p></td>
<td><p>Remove rows.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.shift" title="pyanomaly.panel.Panel.shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shift</span></code></a></p></td>
<td><p>Shift data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.diff" title="pyanomaly.panel.Panel.diff"><code class="xref py py-obj docutils literal notranslate"><span class="pre">diff</span></code></a></p></td>
<td><p>Get the difference of data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.pct_change" title="pyanomaly.panel.Panel.pct_change"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pct_change</span></code></a></p></td>
<td><p>Get the percentage change of data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.cumret" title="pyanomaly.panel.Panel.cumret"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cumret</span></code></a></p></td>
<td><p>Cumulative returns.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.futret" title="pyanomaly.panel.Panel.futret"><code class="xref py py-obj docutils literal notranslate"><span class="pre">futret</span></code></a></p></td>
<td><p>Get future returns.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.rolling" title="pyanomaly.panel.Panel.rolling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling</span></code></a></p></td>
<td><p>Apply a function to a rolling window.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.rolling_regression" title="pyanomaly.panel.Panel.rolling_regression"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_regression</span></code></a></p></td>
<td><p>Conduct rolling regression.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.copy" title="pyanomaly.panel.Panel.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a></p></td>
<td><p>Make a copy of this object and return it.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.copy_from" title="pyanomaly.panel.Panel.copy_from"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_from</span></code></a></p></td>
<td><p>Copy from another Panel object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.save" title="pyanomaly.panel.Panel.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a></p></td>
<td><p>Save this object to a file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.load" title="pyanomaly.panel.Panel.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a></p></td>
<td><p>Load a Panel object from a file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.panel.Panel.clean_memory" title="pyanomaly.panel.Panel.clean_memory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clean_memory</span></code></a></p></td>
<td><p>Clean memory.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.apply_to_dates">
<span class="sig-name descname"><span class="pre">apply_to_dates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ret</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">looper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.apply_to_dates" title="Link to this definition"></a></dt>
<dd><p>Apply a function to each date group.</p>
<p>This method groups <cite>data</cite> by date and applies <cite>function</cite> to each date group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame, Series, ndarray, or (list of) columns. It should have the same length and order as the
<code class="docutils literal notranslate"><span class="pre">data</span></code> attribute.</p></li>
<li><p><strong>function</strong> – Function to apply to groups. Its arguments should be (<cite>gbdata</cite>, <cite>*args</cite>) or
(<cite>gbdata</cite>, <cite>gbdata2</cite>, <cite>*args</cite>), where <cite>gbdata</cite> (<cite>gbdata2</cite>) is a group of <cite>data</cite> (<cite>data2</cite>).</p></li>
<li><p><strong>n_ret</strong> – Number of returns of <cite>function</cite>. If None, it is assumed to be the same as the column size of <cite>data</cite>.
If <cite>looper</cite> is <code class="docutils literal notranslate"><span class="pre">apply_to_groups</span></code>, this argument is ignored.</p></li>
<li><p><strong>*args</strong> – Additional arguments of <cite>function</cite>.</p></li>
<li><p><strong>data2</strong> – DataFrame, Series, ndarray, str, or int. Optional argument when <cite>function</cite>
requires two sets of input data.</p></li>
<li><p><strong>looper</strong> – Looping function: <a class="reference internal" href="#pyanomaly.datatools.apply_to_groups" title="pyanomaly.datatools.apply_to_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups()</span></code></a>, <a class="reference internal" href="#pyanomaly.datatools.apply_to_groups_jit" title="pyanomaly.datatools.apply_to_groups_jit"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups_jit()</span></code></a>, or
<a class="reference internal" href="#pyanomaly.datatools.apply_to_groups_reduce_jit" title="pyanomaly.datatools.apply_to_groups_reduce_jit"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups_reduce_jit()</span></code></a>. If <cite>looper</cite> is None, <code class="docutils literal notranslate"><span class="pre">apply_to_groups_jit</span></code> is used if
<cite>function</cite> is jitted, otherwise, <code class="docutils literal notranslate"><span class="pre">apply_to_groups</span></code> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Concatenated value of the outputs of <cite>function</cite>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyanomaly.datatools.apply_to_groups" title="pyanomaly.datatools.apply_to_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups()</span></code></a>
<a class="reference internal" href="#pyanomaly.datatools.apply_to_groups_jit" title="pyanomaly.datatools.apply_to_groups_jit"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups_jit()</span></code></a>
<a class="reference internal" href="#pyanomaly.datatools.apply_to_groups_reduce_jit" title="pyanomaly.datatools.apply_to_groups_reduce_jit"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups_reduce_jit()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.apply_to_ids">
<span class="sig-name descname"><span class="pre">apply_to_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ret</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">looper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.apply_to_ids" title="Link to this definition"></a></dt>
<dd><p>Apply a function to each id group.</p>
<p>This method groups <cite>data</cite> by id and applies <cite>function</cite> to each id group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame, Series, ndarray, or (list of) columns. It should have the same length and order as the
<code class="docutils literal notranslate"><span class="pre">data</span></code> attribute.</p></li>
<li><p><strong>function</strong> – Function to apply to groups. Its arguments should be (<cite>gbdata</cite>, <cite>*args</cite>) or
(<cite>gbdata</cite>, <cite>gbdata2</cite>, <cite>*args</cite>), where <cite>gbdata</cite> (<cite>gbdata2</cite>) is a group of <cite>data</cite> (<cite>data2</cite>).</p></li>
<li><p><strong>n_ret</strong> – Number of returns of <cite>function</cite>. If None, it is assumed to be the same as the column size of <cite>data</cite>.
If <cite>looper</cite> is <code class="docutils literal notranslate"><span class="pre">apply_to_groups</span></code>, this argument is ignored.</p></li>
<li><p><strong>*args</strong> – Additional arguments of <cite>function</cite>.</p></li>
<li><p><strong>data2</strong> – DataFrame, Series, ndarray, str, or int. Optional argument when <cite>function</cite>
requires two sets of input data.</p></li>
<li><p><strong>looper</strong> – Looping function: <a class="reference internal" href="#pyanomaly.datatools.apply_to_groups" title="pyanomaly.datatools.apply_to_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups()</span></code></a>, <a class="reference internal" href="#pyanomaly.datatools.apply_to_groups_jit" title="pyanomaly.datatools.apply_to_groups_jit"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups_jit()</span></code></a>, or
<a class="reference internal" href="#pyanomaly.datatools.apply_to_groups_reduce_jit" title="pyanomaly.datatools.apply_to_groups_reduce_jit"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups_reduce_jit()</span></code></a>. If <cite>looper</cite> is None, <code class="docutils literal notranslate"><span class="pre">apply_to_groups_jit</span></code> is used if
<cite>function</cite> is jitted, otherwise, <code class="docutils literal notranslate"><span class="pre">apply_to_groups</span></code> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Concatenated value of the outputs of <cite>function</cite>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyanomaly.datatools.apply_to_groups" title="pyanomaly.datatools.apply_to_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups()</span></code></a>
<a class="reference internal" href="#pyanomaly.datatools.apply_to_groups_jit" title="pyanomaly.datatools.apply_to_groups_jit"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups_jit()</span></code></a>
<a class="reference internal" href="#pyanomaly.datatools.apply_to_groups_reduce_jit" title="pyanomaly.datatools.apply_to_groups_reduce_jit"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_groups_reduce_jit()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.clean_memory">
<span class="sig-name descname"><span class="pre">clean_memory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.clean_memory" title="Link to this definition"></a></dt>
<dd><p>Clean memory.</p>
<p>Deleting rows/columns of the <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute may not release memory immediately. If a <code class="docutils literal notranslate"><span class="pre">Panel</span></code> object
consumes unusually large memory, call this function to release memory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.copy" title="Link to this definition"></a></dt>
<dd><p>Make a copy of this object and return it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> – Columns to copy. If None, copy all columns.</p></li>
<li><p><strong>deep</strong> – If True, deep copy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Copy of this object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.copy_from">
<span class="sig-name descname"><span class="pre">copy_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">panel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.copy_from" title="Link to this definition"></a></dt>
<dd><p>Copy from another Panel object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>panel</strong> – A <code class="docutils literal notranslate"><span class="pre">Panel</span></code> object to be copied.</p></li>
<li><p><strong>columns</strong> – Columns of <cite>panel</cite> to copy. If None, copy all columns.</p></li>
<li><p><strong>deep</strong> – If True, deep copy.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.cumret">
<span class="sig-name descname"><span class="pre">cumret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ret</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.cumret" title="Link to this definition"></a></dt>
<dd><p>Cumulative returns.</p>
<p>Compute cumulative returns between t-<cite>period</cite> and t-<cite>lag</cite>.
If <cite>ret</cite> is monthly returns, 12-month momentum can be obtained by setting <cite>period</cite> = 12 and <cite>lag</cite> = 1.
A negative <cite>period</cite> will generate future returns: e.g., <cite>period</cite> = -1 and <cite>lag</cite> = 0 for one-period ahead
return; <cite>period</cite> = -3 and <cite>lag</cite> = -1 for two-period ahead
return starting from t+1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ret</strong> – Series of returns or a return column name. If <cite>ret</cite> is a Series, it should have the same length and
order as the <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute.</p></li>
<li><p><strong>period</strong> – Target horizon (in base frequency). (+) for past returns and (-) for future returns.</p></li>
<li><p><strong>lag</strong> – Period (in base frequency) to calculate returns from.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Series of cumulative returns.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.date_idx">
<span class="sig-name descname"><span class="pre">date_idx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.date_idx" title="Link to this definition"></a></dt>
<dd><p>Get date index name.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Date index name.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.date_values">
<span class="sig-name descname"><span class="pre">date_values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.date_values" title="Link to this definition"></a></dt>
<dd><p>Get date index values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Date Index.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.diff">
<span class="sig-name descname"><span class="pre">diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.diff" title="Link to this definition"></a></dt>
<dd><p>Get the difference of data.</p>
<p>Calculate difference within each id accounting for data frequency. The period between two data points is
determined by <a class="reference internal" href="#pyanomaly.panel.Panel.freq" title="pyanomaly.panel.Panel.freq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">freq</span></code></a> and <a class="reference internal" href="#pyanomaly.panel.Panel.base_freq" title="pyanomaly.panel.Panel.base_freq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">base_freq</span></code></a>. See <a class="reference internal" href="#pyanomaly.panel.Panel.shift" title="pyanomaly.panel.Panel.shift"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shift()</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame, Series, ndarray, or (list of) columns. It should have the same length and order as the
<code class="docutils literal notranslate"><span class="pre">data</span></code> attribute. If None, <cite>data</cite> = <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p></li>
<li><p><strong>n</strong> – Shift size in the base frequency.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Series or DataFrame of differenced data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.filter" title="Link to this definition"></a></dt>
<dd><p>Filter data.</p>
<p>Filter the panel data  using <cite>filters</cite>. A filter is a tuple of three elements:</p>
<blockquote>
<div><ul class="simple">
<li><p>filter[0]: column to apply the filter to.</p></li>
<li><p>filter[1]: filter condition: ‘==’, ‘!=’, ‘&gt;’, ‘&lt;’, ‘&gt;=’, ‘&lt;=’, ‘in’, or ‘not in’.</p></li>
<li><p>filter[2]: rhs value.</p></li>
</ul>
</div></blockquote>
<p>If <cite>filters</cite> is a list of filters, they are applied sequentially.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filters</strong> – A filter or list of filters.</p></li>
<li><p><strong>keep_row</strong> – Whether to keep or remove the filtered out rows. If True, the values of the filtered rows are
set to nan.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To remove rows, where the value of column ‘x’ is less than 10,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">panel</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<p>This is equivalent to</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">panel</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">panel</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.futret">
<span class="sig-name descname"><span class="pre">futret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ret</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.futret" title="Link to this definition"></a></dt>
<dd><p>Get future returns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ret</strong> – Series of returns or a return column name. If <cite>ret</cite> is a Series, it should have the same length and
order as the <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute.</p></li>
<li><p><strong>period</strong> – Target horizon (in base frequency).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Series of future returns.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.get_date_group">
<span class="sig-name descname"><span class="pre">get_date_group</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.get_date_group" title="Link to this definition"></a></dt>
<dd><p>Get date group.</p>
<p>Same as <code class="docutils literal notranslate"><span class="pre">Panel.data.groupby(level=0)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pandas GroupBy object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.get_date_group_index">
<span class="sig-name descname"><span class="pre">get_date_group_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.get_date_group_index" title="Link to this definition"></a></dt>
<dd><p>Get date group indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of date group indices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.get_date_group_size">
<span class="sig-name descname"><span class="pre">get_date_group_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.get_date_group_size" title="Link to this definition"></a></dt>
<dd><p>Get date group sizes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Ndarray of date group sizes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.get_id_group">
<span class="sig-name descname"><span class="pre">get_id_group</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.get_id_group" title="Link to this definition"></a></dt>
<dd><p>Get id group.</p>
<p>Same as <code class="docutils literal notranslate"><span class="pre">Panel.data.groupby(level=1)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pandas GroupBy object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.get_id_group_index">
<span class="sig-name descname"><span class="pre">get_id_group_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.get_id_group_index" title="Link to this definition"></a></dt>
<dd><p>Get id group indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of id group indices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.get_id_group_size">
<span class="sig-name descname"><span class="pre">get_id_group_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.get_id_group_size" title="Link to this definition"></a></dt>
<dd><p>Get id group sizes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Ndarray of id group sizes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.get_row_count">
<span class="sig-name descname"><span class="pre">get_row_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.get_row_count" title="Link to this definition"></a></dt>
<dd><p>Get row count per id.</p>
<p>The row count is a sequential number starting from 0 for each id. If <cite>ascending</cite> is True (False), its value is
0 on the first (last) date. It can be used, e.g., to remove first (last) <cite>n</cite> rows of <a class="reference internal" href="#pyanomaly.panel.Panel.data" title="pyanomaly.panel.Panel.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ascending</strong> – If True, the row count increases with date.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ndarray of row counts.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.id_idx">
<span class="sig-name descname"><span class="pre">id_idx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.id_idx" title="Link to this definition"></a></dt>
<dd><p>Get id index name.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Id index name.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.id_values">
<span class="sig-name descname"><span class="pre">id_values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.id_values" title="Link to this definition"></a></dt>
<dd><p>Get id index values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Id Index.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.inspect_data">
<span class="sig-name descname"><span class="pre">inspect_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['summary']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.inspect_data" title="Link to this definition"></a></dt>
<dd><p>Inspect data.</p>
<p>See <a class="reference internal" href="#pyanomaly.datatools.inspect_data" title="pyanomaly.datatools.inspect_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">datatools.inspect_data()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> – List of columns to inspect.</p></li>
<li><p><strong>option</strong> – List of items to display.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.is_sorted">
<span class="sig-name descname"><span class="pre">is_sorted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.is_sorted" title="Link to this definition"></a></dt>
<dd><p>Check if a panel data is sorted on id/date.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Panel DataFrame with index = date/id. If None, <cite>data</cite> = <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Bool. True if <cite>data</cite> is sorted on id/date.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.load" title="Link to this definition"></a></dt>
<dd><p>Load a Panel object from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> – File name without extension. If None, <cite>fname</cite> = lower-case class name.</p></li>
<li><p><strong>fdir</strong> – Directory to load the file from. If None, <cite>fdir</cite> = <code class="docutils literal notranslate"><span class="pre">config.output_dir</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_duplicates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffixes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.merge" title="Link to this definition"></a></dt>
<dd><p>Merge with another data.</p>
<p>Merge the <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute with <cite>right</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>right</strong> – Panel, Series, or DataFrame to merge with.</p></li>
<li><p><strong>on</strong> – (List of) column(s) to merge on. If None, merge on index.</p></li>
<li><p><strong>right_on</strong> – (List of) column(s) of <cite>right</cite> to merge on. If None, <cite>right_on</cite> = <cite>on</cite>.</p></li>
<li><p><strong>how</strong> – Merge method: ‘inner’, ‘outer’, ‘left’, or ‘right’.</p></li>
<li><p><strong>drop_duplicates</strong> – how to handle duplicate columns. ‘left’: keep right, ‘right’: keep left,
None: keep both. If None, <cite>suffixes</cite> should be provided.</p></li>
<li><p><strong>suffixes</strong> – A tuple of suffixes for duplicate columns, e.g., suffixes=(‘_x’, ‘_y’) will add ‘_x’ and ‘_y’
to the left and right duplicate columns, respectively.</p></li>
<li><p><strong>method</strong> – None or ‘pandas’. None uses an internal merge algorithm for left-merge; ‘pandas’ uses <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code>
internally. If <cite>how</cite> is not ‘left’, this option is ignored and <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> is always used.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyanomaly.datatools.merge" title="pyanomaly.datatools.merge"><code class="xref py py-func docutils literal notranslate"><span class="pre">datatools.merge()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.pct_change">
<span class="sig-name descname"><span class="pre">pct_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_negative_denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.pct_change" title="Link to this definition"></a></dt>
<dd><p>Get the percentage change of data.</p>
<p>Calculate percentage change within each id accounting for data frequency. The period between two data points is
determined by <a class="reference internal" href="#pyanomaly.panel.Panel.freq" title="pyanomaly.panel.Panel.freq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">freq</span></code></a> and <a class="reference internal" href="#pyanomaly.panel.Panel.base_freq" title="pyanomaly.panel.Panel.base_freq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">base_freq</span></code></a>. See <a class="reference internal" href="#pyanomaly.panel.Panel.shift" title="pyanomaly.panel.Panel.shift"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shift()</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame, Series, ndarray, or (list of) columns. It should have the same length and order as the
<code class="docutils literal notranslate"><span class="pre">data</span></code> attribute. If None, <cite>data</cite> = <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p></li>
<li><p><strong>n</strong> – Shift size in the base frequency.</p></li>
<li><p><strong>allow_negative_denom</strong> – If False, set the output to nan when the denominator is not positive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Series or DataFrame of percentage changes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.populate">
<span class="sig-name descname"><span class="pre">populate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ffill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_date_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.populate" title="Link to this definition"></a></dt>
<dd><p>Populate data.</p>
<p>Populate data to <cite>freq</cite> frequency and shift the populated data by <cite>lag</cite> period(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>freq</strong> – Frequency to populate: ANNUAL, QUARTERLY, MONTHLY, or DAILY. If None, <cite>freq</cite> is set to the data
frequency (<code class="docutils literal notranslate"><span class="pre">freq</span></code>), and missing dates are added.</p></li>
<li><p><strong>method</strong> – Filling method for newly added rows. ‘ffill’: forward fill, None: nan.</p></li>
<li><p><strong>limit</strong> – Maximum number of rows to forward-fill.</p></li>
<li><p><strong>lag</strong> – Minimum periods between new date and original date. If <cite>freq</cite> = MONTHLY, <cite>lag</cite> = 4 shifts data by
4 months, which means data are available at least 4 months later.</p></li>
<li><p><strong>new_date_idx</strong> – Name of the new (populated) date index. If None, use the current date index name. If given,
the original date index is kept as a column.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyanomaly.datatools.populate" title="pyanomaly.datatools.populate"><code class="xref py py-func docutils literal notranslate"><span class="pre">datatools.populate()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.remove_rows">
<span class="sig-name descname"><span class="pre">remove_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.remove_rows" title="Link to this definition"></a></dt>
<dd><p>Remove rows.</p>
<p>Remove (set to nan) the first <cite>n</cite> periods of <cite>data</cite> per id. If <cite>n</cite> &lt; 0, the last <cite>-n</cite> periods are
removed. Data frequency is accounted for: e.g., if <code class="docutils literal notranslate"><span class="pre">freq</span></code> = MONTHLY and <code class="docutils literal notranslate"><span class="pre">base_freq</span></code> = ANNUAL, <cite>n</cite> = 1
removes the first 12 rows per id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame, Series, or ndarray. It should have the same length and order as the <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute.</p></li>
<li><p><strong>n</strong> – Number of rows (in base frequency) to remove (set to nan).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The <cite>data</cite> with removed rows set to nan.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.rolling">
<span class="sig-name descname"><span class="pre">rolling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.rolling" title="Link to this definition"></a></dt>
<dd><p>Apply a function to a rolling window.</p>
<p>For each id, apply <cite>function</cite> to rolling windows of size <cite>n</cite>. The rolling window is determined by <a class="reference internal" href="#pyanomaly.panel.Panel.freq" title="pyanomaly.panel.Panel.freq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">freq</span></code></a>
and <a class="reference internal" href="#pyanomaly.panel.Panel.base_freq" title="pyanomaly.panel.Panel.base_freq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">base_freq</span></code></a>. For instance, if <code class="docutils literal notranslate"><span class="pre">freq</span> <span class="pre">=</span> <span class="pre">MONTHLY</span></code> and <code class="docutils literal notranslate"><span class="pre">base_freq</span> <span class="pre">=</span> <span class="pre">ANNUAL</span></code>, <cite>n</cite> = 3 means three-year
rolling window and the first window consists of the 1st, 13th, and 25th rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame, Series, ndarray, or (list of) columns. It should have the same length and order as the
<code class="docutils literal notranslate"><span class="pre">data</span></code> attribute. If None, <cite>data</cite> = <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p></li>
<li><p><strong>function</strong> – Function to apply: ‘sum’, ‘mean’, ‘std’, or ‘var’.</p></li>
<li><p><strong>n</strong> – Window size in the base frequency.</p></li>
<li><p><strong>min_n</strong> – Minimum number of observations in a window. If observations &lt; <cite>min_n</cite>, result is nan. Default to <cite>n</cite>.</p></li>
<li><p><strong>lag</strong> – Lag size in the base frequency. The <cite>data</cite> is shifted by <cite>lag</cite> before rolling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Series or DataFrame. Rolling calculation result.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For other user-defined functions, use <a class="reference internal" href="#pyanomaly.panel.Panel.apply_to_ids" title="pyanomaly.panel.Panel.apply_to_ids"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply_to_ids()</span></code></a>.</p>
</div>
<p class="rubric">Examples</p>
<p>Suppose <code class="docutils literal notranslate"><span class="pre">funda</span></code> is a <code class="docutils literal notranslate"><span class="pre">Panel</span></code> object with <code class="docutils literal notranslate"><span class="pre">freq</span> <span class="pre">=</span> <span class="pre">MONTHLY</span></code> and <code class="docutils literal notranslate"><span class="pre">base_freq</span> <span class="pre">=</span> <span class="pre">ANNUAL</span></code> (annual data
populated monthly), and <code class="docutils literal notranslate"><span class="pre">funda.data</span></code> has a return column, ‘ret’. The past three-year average return
starting from one year ago can be calculated (with a condition of at least two non-missing values within
the sample window) and saved as ‘avg_ret3y’ as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">funda</span><span class="p">[</span><span class="s1">&#39;avg_ret3y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">funda</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="s1">&#39;ret&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.rolling_regression">
<span class="sig-name descname"><span class="pre">rolling_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_const</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.rolling_regression" title="Link to this definition"></a></dt>
<dd><p>Conduct rolling regression.</p>
<p>Run rolling OLS for each id accounting for the data frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame, ndarray, or (list of) columns. It should have the same length and order as the
<code class="docutils literal notranslate"><span class="pre">data</span></code> attribute. The first column is used as the dependent variable and the rest as the independent
variables.</p></li>
<li><p><strong>n</strong> – Window size in the base frequency.</p></li>
<li><p><strong>min_n</strong> – Minimum number of observations in a window. If observations &lt; <cite>min_n</cite>, result is nan. Default to <cite>n</cite>.</p></li>
<li><p><strong>add_const</strong> – If True, add a constant to the independent variables.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Nx(K+2) ndarray, where N is the length of <cite>data</cite> and K is the number of independent variables.</p>
<blockquote>
<div><ul class="simple">
<li><p>First K columns: Coefficients.</p></li>
<li><p>K+1-th column: R-squared.</p></li>
<li><p>K+2-th column: Idiosyncratic volatility (standard deviation of residuals).</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.save" title="Link to this definition"></a></dt>
<dd><p>Save this object to a file.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute is saved to a <code class="docutils literal notranslate"><span class="pre">config.file_format</span></code> file and the other attributes are saved to a json
file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> – File name without extension. If None, <cite>fname</cite> = lower-case class name.</p></li>
<li><p><strong>fdir</strong> – Directory to save the file. If None, <cite>fdir</cite> = <code class="docutils literal notranslate"><span class="pre">config.output_dir</span></code>.</p></li>
<li><p><strong>columns</strong> – List of columns to save. If None, the entire dataset is saved.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.shift">
<span class="sig-name descname"><span class="pre">shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.shift" title="Link to this definition"></a></dt>
<dd><p>Shift data.</p>
<p>Shift data within each id accounting for data frequency. The shift period is determined by <a class="reference internal" href="#pyanomaly.panel.Panel.freq" title="pyanomaly.panel.Panel.freq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">freq</span></code></a> and
<a class="reference internal" href="#pyanomaly.panel.Panel.base_freq" title="pyanomaly.panel.Panel.base_freq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">base_freq</span></code></a>. E.g., if <code class="docutils literal notranslate"><span class="pre">freq</span> <span class="pre">=</span> <span class="pre">MONTHLY</span></code> and <code class="docutils literal notranslate"><span class="pre">base_freq</span> <span class="pre">=</span> <span class="pre">ANNUAL</span></code>, <cite>n</cite> = 1 means 1-year shift, and
<cite>data</cite> is shifted by 12 (12 months). That is, if <code class="docutils literal notranslate"><span class="pre">base_freq</span> <span class="pre">=</span> <span class="pre">ANNUAL</span> <span class="pre">(QUARTERLY)</span></code>, <code class="docutils literal notranslate"><span class="pre">shift(data,</span> <span class="pre">n)</span></code> will
always shift <cite>data</cite> by <cite>n</cite> years (quarters) regardless of the data frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame, Series, ndarray, or (list of) columns. It should have the same length and order as the
<code class="docutils literal notranslate"><span class="pre">data</span></code> attribute. If None, <cite>data</cite> = <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p></li>
<li><p><strong>n</strong> – Shift size in the base frequency.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Series or DataFrame of shifted data.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyanomaly.portfolio">
<span id="portfolio"></span><h2>portfolio<a class="headerlink" href="#module-pyanomaly.portfolio" title="Link to this heading"></a></h2>
<p>This module defines classes for portfolio analysis.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio" title="pyanomaly.portfolio.Portfolio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Portfolio</span></code></a></p></td>
<td><p>Portfolio class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolios" title="pyanomaly.portfolio.Portfolios"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Portfolios</span></code></a></p></td>
<td><p>Class for a group of portfolios.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.portfolio.</span></span><span class="sig-name descname"><span class="pre">Portfolio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pfval0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">costfcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio" title="Link to this definition"></a></dt>
<dd><p>Portfolio class.</p>
<p>This class makes a portfolio from positions and evaluate it.</p>
<p>Position information is saved in <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.position" title="pyanomaly.portfolio.Portfolio.position"><code class="xref py py-attr docutils literal notranslate"><span class="pre">position</span></code></a> and portfolio information is saved in <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.value" title="pyanomaly.portfolio.Portfolio.value"><code class="xref py py-attr docutils literal notranslate"><span class="pre">value</span></code></a>.
If positive weights of the positions on a date don’t add up to 1, (1 - sum(positive weights)) will be assumed to be
invested in a risk-free asset, and its information is saved in <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.fposition" title="pyanomaly.portfolio.Portfolio.fposition"><code class="xref py py-attr docutils literal notranslate"><span class="pre">fposition</span></code></a>.
The transaction cost is assumed to be 0 for risk-free assets.
Once the portfolio is evaluated by calling <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.eval" title="pyanomaly.portfolio.Portfolio.eval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eval()</span></code></a>, <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.performance" title="pyanomaly.portfolio.Portfolio.performance"><code class="xref py py-attr docutils literal notranslate"><span class="pre">performance</span></code></a> attribute is generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Portfolio name.</p></li>
<li><p><strong>position</strong> – Position DataFrame. It should have index = ‘date’ and columns = ‘id’ (security ID), ‘ret’ (return),
and ‘wgt’ (portfolio weight). If it has other columns such as price, they will be kept in <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.position" title="pyanomaly.portfolio.Portfolio.position"><code class="xref py py-attr docutils literal notranslate"><span class="pre">position</span></code></a>.
If it has ‘rf’ (risk-free rate) column, its values are used as risk-free rates.</p></li>
<li><p><strong>rf</strong> – Risk-free rate DataFrame with index = ‘date’ and columns = [‘rf’]. The <cite>rf</cite> has priority over ‘rf’ column in
<cite>position</cite>. If <cite>rf</cite> = None and <cite>position</cite> does not have ‘rf’ column, the risk-free rate is assumed to be 0.</p></li>
<li><p><strong>pfval0</strong> – Initial portfolio value. Default to 1.</p></li>
<li><p><strong>costfcn</strong> – <a class="reference internal" href="#pyanomaly.tcost.TransactionCost" title="pyanomaly.tcost.TransactionCost"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransactionCost</span></code></a> class, a transaction cost function, or value.
See <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.costfcn" title="pyanomaly.portfolio.Portfolio.costfcn"><code class="xref py py-attr docutils literal notranslate"><span class="pre">costfcn</span></code></a>.</p></li>
<li><p><strong>keep_position</strong> – If False, position information (<a class="reference internal" href="#pyanomaly.portfolio.Portfolio.position" title="pyanomaly.portfolio.Portfolio.position"><code class="xref py py-attr docutils literal notranslate"><span class="pre">position</span></code></a>) is deleted after the portfolio is constructed.</p></li>
</ul>
</dd>
</dl>
<p><strong>Attributes</strong></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.name" title="Link to this definition"></a></dt>
<dd><p>Portfolio name.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.position">
<span class="sig-name descname"><span class="pre">position</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.position" title="Link to this definition"></a></dt>
<dd><p>Position DataFrame. Its index is ‘date’ and has the following columns:</p>
<p>Columns from the input</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>Security ID.</p></td>
</tr>
<tr class="row-odd"><td><p>ret</p></td>
<td><p>Return between t-1 and t.</p></td>
</tr>
<tr class="row-even"><td><p>wgt</p></td>
<td><p>Weight at the beginning of t (at t-1 after rebalancing).</p></td>
</tr>
<tr class="row-odd"><td><p>Other columns</p></td>
<td><p>Any other columns that are in the input position data.</p></td>
</tr>
</tbody>
</table>
<p>Columns generated internally.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>exret</p></td>
<td><p>Excess return over risk-free rate between t-1 and t.</p></td>
</tr>
<tr class="row-odd"><td><p>val1</p></td>
<td><p>Value at t.</p></td>
</tr>
<tr class="row-even"><td><p>val</p></td>
<td><p>Value at the beginning of t.</p></td>
</tr>
<tr class="row-odd"><td><p>val0</p></td>
<td><p>Value at t-1 (before rebalancing). val1 at t-1 = val0 at t.</p></td>
</tr>
<tr class="row-even"><td><p>cost</p></td>
<td><p>Transaction cost incurred at the beginning of t.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.value">
<span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.value" title="Link to this definition"></a></dt>
<dd><p>Portfolio value DataFrame. Its index is ‘date’ and has the following columns:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ret</p></td>
<td><p>Return between t-1 and t. This can be either net (excess) return or gross (excess) return                         depending on the return type. See <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.eval" title="pyanomaly.portfolio.Portfolio.eval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eval()</span></code></a>. ret = netexret by default.</p></td>
</tr>
<tr class="row-odd"><td><p>val1</p></td>
<td><p>Value at t.</p></td>
</tr>
<tr class="row-even"><td><p>val</p></td>
<td><p>Value at the beginning of t.</p></td>
</tr>
<tr class="row-odd"><td><p>cost</p></td>
<td><p>Transaction cost incurred at the beginning of t.</p></td>
</tr>
<tr class="row-even"><td><p>tover</p></td>
<td><p>Turnover incurred at the beginning of t.</p></td>
</tr>
<tr class="row-odd"><td><p>netret</p></td>
<td><p>Return between t-1 and t, net of transaction cost.</p></td>
</tr>
<tr class="row-even"><td><p>grossret</p></td>
<td><p>Gross return between t-1 and t.</p></td>
</tr>
<tr class="row-odd"><td><p>netexret</p></td>
<td><p>Excess return between t-1 and t, net of transaction cost.</p></td>
</tr>
<tr class="row-even"><td><p>grossexret</p></td>
<td><p>Gross excess return between t-1 and t.</p></td>
</tr>
<tr class="row-odd"><td><p>lposition</p></td>
<td><p>Number of long positions.</p></td>
</tr>
<tr class="row-even"><td><p>sposition</p></td>
<td><p>Number of short positions.</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>tover = sum(abs(position.val - position.val0)) / value.val</p></li>
</ul>
<p>The following columns are added to <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.value" title="pyanomaly.portfolio.Portfolio.value"><code class="xref py py-attr docutils literal notranslate"><span class="pre">value</span></code></a> once the portfolio is evaluated by calling
<a class="reference internal" href="#pyanomaly.portfolio.Portfolio.eval" title="pyanomaly.portfolio.Portfolio.eval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eval()</span></code></a>.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cumret</p></td>
<td><p>Cumulative return since the first date.</p></td>
</tr>
<tr class="row-odd"><td><p>drawdown</p></td>
<td><p>Drawdown.</p></td>
</tr>
<tr class="row-even"><td><p>drawdur</p></td>
<td><p>Duration of drawdown in the frequency of data, e.g., if monthly, 3 means 3 months.</p></td>
</tr>
<tr class="row-odd"><td><p>drawstart</p></td>
<td><p>Beginning date of drawdown.</p></td>
</tr>
<tr class="row-even"><td><p>succdown</p></td>
<td><p>Successive down; down without any up during a period.</p></td>
</tr>
<tr class="row-odd"><td><p>succdur</p></td>
<td><p>Duration of successive down.</p></td>
</tr>
<tr class="row-even"><td><p>succstart</p></td>
<td><p>Beginning date of successive down.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.fposition">
<span class="sig-name descname"><span class="pre">fposition</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.fposition" title="Link to this definition"></a></dt>
<dd><p>Risk-free asset position DataFrame. Its index is ‘date’ and has the following columns:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ret</p></td>
<td><p>Return between t-1 and t.</p></td>
</tr>
<tr class="row-odd"><td><p>wgt</p></td>
<td><p>Weight at the beginning of t.</p></td>
</tr>
<tr class="row-even"><td><p>val1</p></td>
<td><p>Value at t.</p></td>
</tr>
<tr class="row-odd"><td><p>val</p></td>
<td><p>Value at the beginning of t.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.performance">
<span class="sig-name descname"><span class="pre">performance</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.performance" title="Link to this definition"></a></dt>
<dd><p>Portfolio performance DataFrame. Its column is equal to the portfolio name and has the following
indexes:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>mean</p></td>
<td><p>Mean return.</p></td>
</tr>
<tr class="row-odd"><td><p>std</p></td>
<td><p>Standard deviation.</p></td>
</tr>
<tr class="row-even"><td><p>sharpe</p></td>
<td><p>Sharpe ratio.</p></td>
</tr>
<tr class="row-odd"><td><p>cum</p></td>
<td><p>Cumulative return.</p></td>
</tr>
<tr class="row-even"><td><p>mdd</p></td>
<td><p>Maximum drawdown.</p></td>
</tr>
<tr class="row-odd"><td><p>mdd start</p></td>
<td><p>Maximum drawdown start date.</p></td>
</tr>
<tr class="row-even"><td><p>mdd end</p></td>
<td><p>Maximum drawdown end date.</p></td>
</tr>
<tr class="row-odd"><td><p>msd</p></td>
<td><p>Maximum successive down.</p></td>
</tr>
<tr class="row-even"><td><p>msd start</p></td>
<td><p>Maximum successive down start date.</p></td>
</tr>
<tr class="row-odd"><td><p>msd end</p></td>
<td><p>Maximum successive down end date.</p></td>
</tr>
<tr class="row-even"><td><p>turnover</p></td>
<td><p>Average turnover.</p></td>
</tr>
<tr class="row-odd"><td><p>lposotion</p></td>
<td><p>Average number of long positions.</p></td>
</tr>
<tr class="row-even"><td><p>sposition</p></td>
<td><p>Average number of short positions.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.costfcn">
<span class="sig-name descname"><span class="pre">costfcn</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.costfcn" title="Link to this definition"></a></dt>
<dd><p><a class="reference internal" href="#pyanomaly.tcost.TransactionCost" title="pyanomaly.tcost.TransactionCost"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransactionCost</span></code></a> object, a transaction cost function, or
a value. For example, if a constant transaction cost of 20 basis points is assumed, <cite>costfcn</cite> can be set
to 0.002.</p>
<p>If <cite>costfcn</cite> is a <a class="reference internal" href="#pyanomaly.tcost.TransactionCost" title="pyanomaly.tcost.TransactionCost"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransactionCost</span></code></a> object,
<a class="reference internal" href="#pyanomaly.tcost.TransactionCost.get_cost" title="pyanomaly.tcost.TransactionCost.get_cost"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TransactionCost.get_cost()</span></code></a> is called to get
transaction costs. <a class="reference internal" href="#pyanomaly.tcost.TransactionCost" title="pyanomaly.tcost.TransactionCost"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransactionCost</span></code></a> allows transaction costs
varying across time and securities.</p>
<p>When <cite>costfcn</cite> is defined as a function, it should have arguments <cite>val</cite> (value after rebalancing) and
<cite>val0</cite> (value before rebalancing) and return the transaction cost. For example, if the transaction cost
to buy (sell) is 20 (30) bps, the function can be defined as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cost_fcn</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">val0</span><span class="p">):</span>
    <span class="n">dval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">val0</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">0.002</span> <span class="o">*</span> <span class="n">dval</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">val0</span> <span class="k">else</span> <span class="mf">0.003</span> <span class="o">*</span> <span class="n">dval</span>
</pre></div>
</div>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a position exists at t-1 but not at t, it will be added at t with 0 weight.
This is to compute the transaction cost.</p>
<p>The ‘val’, ‘val1’, and ‘val0’ in <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.position" title="pyanomaly.portfolio.Portfolio.position"><code class="xref py py-attr docutils literal notranslate"><span class="pre">position</span></code></a> and <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.value" title="pyanomaly.portfolio.Portfolio.value"><code class="xref py py-attr docutils literal notranslate"><span class="pre">value</span></code></a> do not take transaction costs into account.
For the value changes net of transaction costs, use the cumulative return.</p>
</div>
<p><strong>Methods</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.set_position" title="pyanomaly.portfolio.Portfolio.set_position"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_position</span></code></a></p></td>
<td><p>Set positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.from_portfolo_return" title="pyanomaly.portfolio.Portfolio.from_portfolo_return"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_portfolo_return</span></code></a></p></td>
<td><p>Make a portfolio given portfolio returns.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.copy" title="pyanomaly.portfolio.Portfolio.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a></p></td>
<td><p>Copy this object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.set_return_type" title="pyanomaly.portfolio.Portfolio.set_return_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_return_type</span></code></a></p></td>
<td><p>Set the return to use for portfolio evaluation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.returns" title="pyanomaly.portfolio.Portfolio.returns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">returns</span></code></a></p></td>
<td><p>Get returns.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.cum_returns" title="pyanomaly.portfolio.Portfolio.cum_returns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cum_returns</span></code></a></p></td>
<td><p>Get cumulative returns.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.mean_return" title="pyanomaly.portfolio.Portfolio.mean_return"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mean_return</span></code></a></p></td>
<td><p>Get mean return.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.std_return" title="pyanomaly.portfolio.Portfolio.std_return"><code class="xref py py-obj docutils literal notranslate"><span class="pre">std_return</span></code></a></p></td>
<td><p>Get standard deviation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.cum_return" title="pyanomaly.portfolio.Portfolio.cum_return"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cum_return</span></code></a></p></td>
<td><p>Get cumulative return.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.sharpe_ratio" title="pyanomaly.portfolio.Portfolio.sharpe_ratio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sharpe_ratio</span></code></a></p></td>
<td><p>Get Sharpe ratio.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.succdown" title="pyanomaly.portfolio.Portfolio.succdown"><code class="xref py py-obj docutils literal notranslate"><span class="pre">succdown</span></code></a></p></td>
<td><p>Get successive downs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.max_succdown" title="pyanomaly.portfolio.Portfolio.max_succdown"><code class="xref py py-obj docutils literal notranslate"><span class="pre">max_succdown</span></code></a></p></td>
<td><p>Get maximum successive down.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.drawdown" title="pyanomaly.portfolio.Portfolio.drawdown"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drawdown</span></code></a></p></td>
<td><p>Get drawdowns.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.max_drawdown" title="pyanomaly.portfolio.Portfolio.max_drawdown"><code class="xref py py-obj docutils literal notranslate"><span class="pre">max_drawdown</span></code></a></p></td>
<td><p>Get maximum drawdown.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.eval" title="pyanomaly.portfolio.Portfolio.eval"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code></a></p></td>
<td><p>Evaluate the portfolio.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.eval_series" title="pyanomaly.portfolio.Portfolio.eval_series"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval_series</span></code></a></p></td>
<td><p>Evaluate the portfolio repeatedly over a period.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.copy" title="Link to this definition"></a></dt>
<dd><p>Copy this object.</p>
<p>Copy this object for the given period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date (‘yyyy-mm-dd’).</p></li>
<li><p><strong>edate</strong> – End date (‘yyyy-mm-dd’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">Portfolio</span></code> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.cum_return">
<span class="sig-name descname"><span class="pre">cum_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.cum_return" title="Link to this definition"></a></dt>
<dd><p>Get cumulative return.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
<li><p><strong>logscale</strong> – If True, return log-scale cumulative return.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Cumulative return over the period.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.cum_returns">
<span class="sig-name descname"><span class="pre">cum_returns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.cum_returns" title="Link to this definition"></a></dt>
<dd><p>Get cumulative returns.</p>
<p>Both <cite>sdate</cite> and <cite>edate</cite> are inclusive, i.e., the first cumulative return is the return over <cite>sdate</cite>-1 and
<cite>sdate</cite> and the last cumulative return is the return over <cite>sdate</cite>-1 and <cite>edate</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
<li><p><strong>logscale</strong> – If True, return log-scale cumulative returns.</p></li>
<li><p><strong>zero_start</strong> – If True, a cumulative return of 0 is prepended with date = <cite>sdate</cite> - 1 day.
This is useful when plotting several cumulative returns as all curves will start at 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Cumulative return Series with index = ‘date’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.drawdown">
<span class="sig-name descname"><span class="pre">drawdown</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.drawdown" title="Link to this definition"></a></dt>
<dd><p>Get drawdowns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Drawdowns. DataFrame with index = ‘date’ and columns = [‘value’, ‘duration’, ‘start’].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annualize_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'net'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.eval" title="Link to this definition"></a></dt>
<dd><p>Evaluate the portfolio.</p>
<p>This method evaluates the portfolio over a period and create <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.performance" title="pyanomaly.portfolio.Portfolio.performance"><code class="xref py py-attr docutils literal notranslate"><span class="pre">performance</span></code></a>. It also adds
performance-related columns to <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.value" title="pyanomaly.portfolio.Portfolio.value"><code class="xref py py-attr docutils literal notranslate"><span class="pre">value</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
<li><p><strong>logscale</strong> – If True, cumulative returns are in log-scale.</p></li>
<li><p><strong>annualize_factor</strong> – ‘mean’, ‘std’, ‘sharpe’, and ‘turnover’ are annualized by this factor, e.g.,
‘mean’ is multiplied by <cite>annualize_factor</cite> and ‘std’ by its square-root.
If the data is monthly, the results can be annualized by setting <cite>annualize_factor</cite> = 12. Default to 1.</p></li>
<li><p><strong>return_type</strong> – Which return to use for evaluation. See <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.set_return_type" title="pyanomaly.portfolio.Portfolio.set_return_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_return_type()</span></code></a> for available options.
Default to ‘net’.</p></li>
<li><p><strong>percentage</strong> – If True, ‘mean’, ‘std’, ‘cum’, ‘mdd’, ‘msd’, and ‘turnover’ are multiplied by 100.
Default to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolio.performance" title="pyanomaly.portfolio.Portfolio.performance"><code class="xref py py-attr docutils literal notranslate"><span class="pre">performance</span></code></a>, <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.value" title="pyanomaly.portfolio.Portfolio.value"><code class="xref py py-attr docutils literal notranslate"><span class="pre">value</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.eval_series">
<span class="sig-name descname"><span class="pre">eval_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annualize_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'net'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.eval_series" title="Link to this definition"></a></dt>
<dd><p>Evaluate the portfolio repeatedly over a period.</p>
<p>Evaluate the portfolio repeatedly for the periods [<cite>sdate-1</cite>, <cite>sdate</cite>], [<cite>sdate-1</cite>, <cite>sdate+1</cite>], …,
[<cite>sdate-1</cite>, <cite>edate</cite>]. For the description of the arguments, see <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.eval" title="pyanomaly.portfolio.Portfolio.eval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eval()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Performance for each period. DataFrame with index values equal to the period end dates and columns
equal to the indexes of <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.performance" title="pyanomaly.portfolio.Portfolio.performance"><code class="xref py py-attr docutils literal notranslate"><span class="pre">performance</span></code></a>, i.e., a row with index t contains
the performance up to t.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.from_portfolo_return">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_portfolo_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pfret</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.from_portfolo_return" title="Link to this definition"></a></dt>
<dd><p>Make a portfolio given portfolio returns.</p>
<p>If portfolio returns are already known, this method can be used to construct a <code class="docutils literal notranslate"><span class="pre">Portfoliio</span></code> object
without position information and evaluate the portfolio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pfret</strong> – Portfolio returns. DataFrame with index = ‘date’ and columns = ‘ret’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">Portfolio</span></code> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.max_drawdown">
<span class="sig-name descname"><span class="pre">max_drawdown</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.max_drawdown" title="Link to this definition"></a></dt>
<dd><p>Get maximum drawdown.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Maximum drawdown. Series with index = [‘value’, ‘duration’, ‘start’].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.max_succdown">
<span class="sig-name descname"><span class="pre">max_succdown</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.max_succdown" title="Link to this definition"></a></dt>
<dd><p>Get maximum successive down.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Maximum successive down. Series with index = [‘value’, ‘duration’, ‘start’].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.mean_return">
<span class="sig-name descname"><span class="pre">mean_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.mean_return" title="Link to this definition"></a></dt>
<dd><p>Get mean return.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mean return over the period.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.returns">
<span class="sig-name descname"><span class="pre">returns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.returns" title="Link to this definition"></a></dt>
<dd><p>Get returns.</p>
<p>Both <cite>sdate</cite> and <cite>edate</cite> are inclusive, i.e., the first return is the return over <cite>sdate</cite>-1 and <cite>sdate</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return Series with index = ‘date’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.set_position">
<span class="sig-name descname"><span class="pre">set_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pfval0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.set_position" title="Link to this definition"></a></dt>
<dd><p>Set positions.</p>
<p>This method sets <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.position" title="pyanomaly.portfolio.Portfolio.position"><code class="xref py py-attr docutils literal notranslate"><span class="pre">position</span></code></a> from <cite>position</cite>. Any existing positions will be deleted.
For the details of the input arguments, See the class parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.set_return_type">
<span class="sig-name descname"><span class="pre">set_return_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'net'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.set_return_type" title="Link to this definition"></a></dt>
<dd><p>Set the return to use for portfolio evaluation.</p>
<p>The ‘ret’ and ‘exret’ of <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.value" title="pyanomaly.portfolio.Portfolio.value"><code class="xref py py-attr docutils literal notranslate"><span class="pre">value</span></code></a> are set according to <cite>return_type</cite> and used to compute portfolio
evaluation metrics. Mean, std, and Sharpe ratio use <code class="docutils literal notranslate"><span class="pre">value.exret</span></code> and cumulative return, mdd, and msd
use <code class="docutils literal notranslate"><span class="pre">value.ret</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>return_type</strong> – Return to use. ‘net’, ‘gross’, ‘netexret’, ‘grossexret’, ‘netret’, or ‘grossret’.
<code class="docutils literal notranslate"><span class="pre">value.ret</span></code> and <code class="docutils literal notranslate"><span class="pre">value.exret</span></code> are set as follows.</p>
</dd>
</dl>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Return_type</p></th>
<th class="head"><p>Ret</p></th>
<th class="head"><p>Exret</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘net’</p></td>
<td><p>net return</p></td>
<td><p>net excess return</p></td>
</tr>
<tr class="row-odd"><td><p>‘gross’</p></td>
<td><p>gross return</p></td>
<td><p>gross excess return</p></td>
</tr>
<tr class="row-even"><td><p>‘netexret’</p></td>
<td><p>net excess return</p></td>
<td><p>net excess return</p></td>
</tr>
<tr class="row-odd"><td><p>‘grossexret’</p></td>
<td><p>gross excess return</p></td>
<td><p>gross excess return</p></td>
</tr>
<tr class="row-even"><td><p>‘netret’</p></td>
<td><p>net return</p></td>
<td><p>net return</p></td>
</tr>
<tr class="row-odd"><td><p>‘grossret’</p></td>
<td><p>gross return</p></td>
<td><p>gross return</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.sharpe_ratio">
<span class="sig-name descname"><span class="pre">sharpe_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.sharpe_ratio" title="Link to this definition"></a></dt>
<dd><p>Get Sharpe ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sharpe ratio over the period.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.std_return">
<span class="sig-name descname"><span class="pre">std_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.std_return" title="Link to this definition"></a></dt>
<dd><p>Get standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Standard deviation of the returns over the period.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.succdown">
<span class="sig-name descname"><span class="pre">succdown</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.succdown" title="Link to this definition"></a></dt>
<dd><p>Get successive downs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Successive downs. DataFrame with index = ‘date’ and columns = [‘value’, ‘duration’, ‘start’].</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolios">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.portfolio.</span></span><span class="sig-name descname"><span class="pre">Portfolios</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">portfolios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolios" title="Link to this definition"></a></dt>
<dd><p>Class for a group of portfolios.</p>
<p>This class can have several portfolios as its members and evaluate them together.
This class facilitates portfolio comparison by evaluating them and saving the results in a single DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>portfolios</strong> – List or dict of <a class="reference internal" href="#pyanomaly.portfolio.Portfolio" title="pyanomaly.portfolio.Portfolio"><code class="xref py py-class docutils literal notranslate"><span class="pre">Portfolio</span></code></a> objects to add. If it is a dict, its keys are used as
portfolio names. Portfolios can also be added later using <a class="reference internal" href="#pyanomaly.portfolio.Portfolios.add" title="pyanomaly.portfolio.Portfolios.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add()</span></code></a> or
<a class="reference internal" href="#pyanomaly.portfolio.Portfolios.set" title="pyanomaly.portfolio.Portfolios.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set()</span></code></a>.</p>
</dd>
</dl>
<p><strong>Attributes</strong></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolios.members">
<span class="sig-name descname"><span class="pre">members</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolios.members" title="Link to this definition"></a></dt>
<dd><p>Dict of portfolio members. A <a class="reference internal" href="#pyanomaly.portfolio.Portfolio" title="pyanomaly.portfolio.Portfolio"><code class="xref py py-class docutils literal notranslate"><span class="pre">Portfolio</span></code></a> object is added to <cite>members</cite> with its name as the key.
A member portfolio can be accessed using <code class="docutils literal notranslate"><span class="pre">__getitem__()</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pf1</span> <span class="o">=</span> <span class="n">Portfolio</span><span class="p">(</span><span class="s1">&#39;pf1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">portfolios</span> <span class="o">=</span> <span class="n">Portfolios</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">portfolios</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pf1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pf1</span> <span class="o">=</span> <span class="n">portfolios</span><span class="p">[</span><span class="s1">&#39;pf1&#39;</span><span class="p">]</span>  <span class="c1"># This and the next line are equivalent.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pf1</span> <span class="o">=</span> <span class="n">portfolios</span><span class="o">.</span><span class="n">members</span><span class="p">[</span><span class="s1">&#39;pf1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolios.value">
<span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolios.value" title="Link to this definition"></a></dt>
<dd><p>Portfolios’ values. This is a concatenated (outer-joined) DataFrame of the <code class="docutils literal notranslate"><span class="pre">value</span></code> attributes of the
members. Its index is ‘date’ and columns are two-level: the first level is the same as the columns of
<a class="reference internal" href="#pyanomaly.portfolio.Portfolio.value" title="pyanomaly.portfolio.Portfolio.value"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Portfolio.value</span></code></a> and the second level is the portfolio names.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolios.performance">
<span class="sig-name descname"><span class="pre">performance</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolios.performance" title="Link to this definition"></a></dt>
<dd><p>Portfolios’ performances. This is a concatenated DataFrame of the <code class="docutils literal notranslate"><span class="pre">performance</span></code> attributes of
the members. Its index is the same as the index of <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.performance" title="pyanomaly.portfolio.Portfolio.performance"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Portfolio.performance</span></code></a> and columns are
portfolio names.</p>
</dd></dl>

<p><strong>Methods</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolios.add" title="pyanomaly.portfolio.Portfolios.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add</span></code></a></p></td>
<td><p>Add a portfolio.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolios.set" title="pyanomaly.portfolio.Portfolios.set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set</span></code></a></p></td>
<td><p>Set portfolios.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolios.eval" title="pyanomaly.portfolio.Portfolios.eval"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code></a></p></td>
<td><p>Evaluate the portfolios.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolios.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">portfolio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolios.add" title="Link to this definition"></a></dt>
<dd><p>Add a portfolio.</p>
<p>Add <cite>portfolio</cite> to <a class="reference internal" href="#pyanomaly.portfolio.Portfolios.members" title="pyanomaly.portfolio.Portfolios.members"><code class="xref py py-attr docutils literal notranslate"><span class="pre">members</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>portfolio</strong> (<a class="reference internal" href="#pyanomaly.portfolio.Portfolio" title="pyanomaly.portfolio.Portfolio"><em>Portfolio</em></a>) – Portfolio to add.</p></li>
<li><p><strong>alias</strong> – Portfolio alias. If not None, this is used as the portfolio name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolios.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annualize_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'net'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolios.eval" title="Link to this definition"></a></dt>
<dd><p>Evaluate the portfolios.</p>
<p>For the arguments, see <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.eval" title="pyanomaly.portfolio.Portfolio.eval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Portfolio.eval()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyanomaly.portfolio.Portfolios.performance" title="pyanomaly.portfolio.Portfolios.performance"><code class="xref py py-attr docutils literal notranslate"><span class="pre">performance</span></code></a>, <a class="reference internal" href="#pyanomaly.portfolio.Portfolios.value" title="pyanomaly.portfolio.Portfolios.value"><code class="xref py py-attr docutils literal notranslate"><span class="pre">value</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolios.set">
<span class="sig-name descname"><span class="pre">set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">portfolios</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolios.set" title="Link to this definition"></a></dt>
<dd><p>Set portfolios.</p>
<p>Any existing portfolios are deleted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>portfolios</strong> – List or dict of <a class="reference internal" href="#pyanomaly.portfolio.Portfolio" title="pyanomaly.portfolio.Portfolio"><code class="xref py py-class docutils literal notranslate"><span class="pre">Portfolio</span></code></a> objects. If it is a dict, its keys are used as
portfolio names.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyanomaly.tcost">
<span id="tcost"></span><span id="pyanomaly-tcost"></span><h2>tcost<a class="headerlink" href="#module-pyanomaly.tcost" title="Link to this heading"></a></h2>
<p>This module defines classes for transaction costs.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.tcost.TransactionCost" title="pyanomaly.tcost.TransactionCost"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionCost</span></code></a></p></td>
<td><p>Transaction cost class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.tcost.TimeVaryingCost" title="pyanomaly.tcost.TimeVaryingCost"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TimeVaryingCost</span></code></a></p></td>
<td><p>Transaction cost that varies with time and firm size.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.tcost.TimeVaryingCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.tcost.</span></span><span class="sig-name descname"><span class="pre">TimeVaryingCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">me</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.tcost.TimeVaryingCost" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanomaly.tcost.TransactionCost" title="pyanomaly.tcost.TransactionCost"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransactionCost</span></code></a></p>
<p>Transaction cost that varies with time and firm size.</p>
<p>This class implements the time-varying transaction costs used in, e.g., Brandt et al. (2009), Hand and Green (2011),
DeMiguel et al. (2020), and Han (2021). Transaction cost parameter <cite>k</cite> is defined as <cite>k</cite> = <cite>y</cite> * <cite>z</cite>,
where <cite>y</cite> decreases linearly from 4.0 in 1974.01 to 1.0 in 2002.01 and remains at 1.0 thereafter, and
<cite>z</cite> = 0.006 - 0.0025 * <cite>nme</cite>, where <cite>nme</cite> is a cross-sectionally normalized market equity that has a value
between 0 and 1.</p>
<p>The maximum transaction cost is 240 basis points (the smallest firm before 1974) and the minimum transaction cost is
35 basis points (the largest firm after 2002).</p>
<p>We find this assumption is too conservative since the normalized me is sensitive to the largest firm.
In 1974, the mean of the normalized me is only 0.0045 and most firms have the transaction cost of 240 basis points,
and in 2002, the mean of the normalized me is only 0.0059 and most firms have the transaction cost of 60 basis
points.</p>
<p>Using the logarithm of the market equity or capping the me of the largest firms may make more sense.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>me</strong> – See <a class="reference internal" href="#pyanomaly.tcost.TimeVaryingCost.set_params" title="pyanomaly.tcost.TimeVaryingCost.set_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_params()</span></code></a>.</p></li>
<li><p><strong>normalize</strong> – See <a class="reference internal" href="#pyanomaly.tcost.TimeVaryingCost.set_params" title="pyanomaly.tcost.TimeVaryingCost.set_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_params()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.tcost.TimeVaryingCost.set_params" title="pyanomaly.tcost.TimeVaryingCost.set_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code></a></p></td>
<td><p>Set transaction cost parameters.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.tcost.TimeVaryingCost.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">me</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.tcost.TimeVaryingCost.set_params" title="Link to this definition"></a></dt>
<dd><p>Set transaction cost parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>me</strong> – DataFrame or Series of market equity with index = date/id.</p></li>
<li><p><strong>normalize</strong> – If True, cross-sectionally normalize <cite>me</cite> so that its values are between 0 and 1.
If <cite>me</cite> is already normalized, set <cite>normalize</cite> to False.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the input contains only a subset of all listed stocks, normalizing the market equity can result in
over- or underestimation of the transaction costs. For example, if <cite>me</cite> contains only top 80% of the stocks,
the transaction costs will be overestimated. Use all listed stocks in the market or normalize the market equity
outside and set <cite>normalize = False</cite>.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.tcost.TransactionCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.tcost.</span></span><span class="sig-name descname"><span class="pre">TransactionCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.tcost.TransactionCost" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Transaction cost class.</p>
<p>Transaction cost can be set at the security level. It can also vary over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Transaction cost parameters. See <a class="reference internal" href="#pyanomaly.tcost.TransactionCost.set_params" title="pyanomaly.tcost.TransactionCost.set_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_params()</span></code></a>.</p>
</dd>
</dl>
<p><strong>Attributes</strong></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.tcost.TransactionCost.params">
<span class="sig-name descname"><span class="pre">params</span></span><a class="headerlink" href="#pyanomaly.tcost.TransactionCost.params" title="Link to this definition"></a></dt>
<dd><p>Transaction cost parameters. This can be a float number, dict, or DataFrame. See <a class="reference internal" href="#pyanomaly.tcost.TransactionCost.set_params" title="pyanomaly.tcost.TransactionCost.set_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_params()</span></code></a>
for details.</p>
</dd></dl>

<p><strong>Methods</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.tcost.TransactionCost.set_params" title="pyanomaly.tcost.TransactionCost.set_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code></a></p></td>
<td><p>Set transaction cost parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.tcost.TransactionCost.get_cost" title="pyanomaly.tcost.TransactionCost.get_cost"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_cost</span></code></a></p></td>
<td><p>Get transaction costs.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.tcost.TransactionCost.get_cost">
<span class="sig-name descname"><span class="pre">get_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.tcost.TransactionCost.get_cost" title="Link to this definition"></a></dt>
<dd><p>Get transaction costs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>position</strong> – Portfolio positions. <a class="reference internal" href="#pyanomaly.portfolio.Portfolio" title="pyanomaly.portfolio.Portfolio"><code class="xref py py-class docutils literal notranslate"><span class="pre">Portfolio</span></code></a> object calls this function with the
argument, <a class="reference internal" href="#pyanomaly.portfolio.Portfolio.position" title="pyanomaly.portfolio.Portfolio.position"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Portfolio.position</span></code></a>, to get transaction costs.
The <cite>position</cite> argument should have index = ‘date’ and columns = [<cite>id</cite>, ‘val’, ‘val0’], where ‘val’ is
the value after rebalancing and ‘val0’ is the value before rebalancing.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transaction costs. A ndarray with the same length as <cite>position</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.tcost.TransactionCost.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.tcost.TransactionCost.set_params" title="Link to this definition"></a></dt>
<dd><p>Set transaction cost parameters.</p>
<p>Parameters can be set either by this method or at class initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – <p>Transaction cost parameters. The <cite>kwargs</cite> can have the following keywords:</p>
<ul class="simple">
<li><p>’cost’: For a constant (scalar) transaction cost.</p></li>
<li><p>’buy_fixed`, ‘buy_linear`, ‘buy_quad’, ‘sell_fixed’, ‘sell_linear’, ‘sell_quad’: For
a quadratic transaction cost.</p></li>
<li><p>’params’: DataFrame. For a transaction cost that varies across securities (and over time).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>A constant transaction cost of 20 basis points.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tc</span> <span class="o">=</span> <span class="n">TransactionCost</span><span class="p">(</span><span class="n">cost</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>
</pre></div>
</div>
<p>Asymmetric quadratic cost function.</p>
<blockquote>
<div><p><cite>cost = fixed + linear * Amount + quad * Amount^2</cite></p>
<ul class="simple">
<li><p>To buy: fixed cost = $5, linear cost = 0.002, and quadratic cost = 0.001</p></li>
<li><p>To sell: fixed cost = $0, linear cost = 0.003, and quadratic cost = 0.001</p></li>
</ul>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tc</span> <span class="o">=</span> <span class="n">TransactionCost</span><span class="p">(</span><span class="n">buy_fixed</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">buy_linear</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">buy_quad</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">sell_linear</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">sell_quad</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><ul class="simple">
<li><p>Only non-zero parameters need to be provided.</p></li>
</ul>
</div></blockquote>
<p>Transaction costs that vary across securities.</p>
<blockquote>
<div><ul class="simple">
<li><p>Security 1 (id: 0001): 0.002, security 2 (id: 0002): 0.003</p></li>
</ul>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.002</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;0001&#39;</span><span class="p">,</span> <span class="s1">&#39;0002&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span>
<span class="go">      cost</span>
<span class="go">id</span>
<span class="go">0001 0.002</span>
<span class="go">0002 0.003</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tc</span> <span class="o">=</span> <span class="n">TransactionCost</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<p>Transaction costs that vary across securities and dates.</p>
<blockquote>
<div><ul class="simple">
<li><p>Security 1 (id: 0001): 0.004 on ‘2000-03-31’, 0.003 on ‘2000-04-30’</p></li>
<li><p>Security 2 (id: 0002): 0.005 on ‘2000-03-31’, 0.004 on ‘2000-04-30’</p></li>
</ul>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2000-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-04-30&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0001&#39;</span><span class="p">,</span> <span class="s1">&#39;0002&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([</span><span class="n">dates</span><span class="p">,</span> <span class="n">ids</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;cost&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.004</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span>
<span class="go">                 cost</span>
<span class="go">date       id</span>
<span class="go">2000-03-31 0001 0.004</span>
<span class="go">           0002 0.005</span>
<span class="go">2000-04-30 0001 0.003</span>
<span class="go">           0002 0.004</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tc</span> <span class="o">=</span> <span class="n">TransactionCost</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><ul class="simple">
<li><p>The <cite>params</cite> DataFrame must have index = id or date/id. It can have columns such as ‘buy_fixed’ instead
of ‘cost’ for a more complex transaction cost structure.</p></li>
</ul>
</div></blockquote>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyanomaly.util">
<span id="util"></span><h2>util<a class="headerlink" href="#module-pyanomaly.util" title="Link to this heading"></a></h2>
<p>This module defines utility functions.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.util.is_iterable" title="pyanomaly.util.is_iterable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_iterable</span></code></a></p></td>
<td><p>Check if a variable is iterable.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.util.to_list" title="pyanomaly.util.to_list"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_list</span></code></a></p></td>
<td><p>Convert a variable to a list.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.util.unique_list" title="pyanomaly.util.unique_list"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unique_list</span></code></a></p></td>
<td><p>Get a list of unique elements of a list.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.util.drop_columns" title="pyanomaly.util.drop_columns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_columns</span></code></a></p></td>
<td><p>Delete columns of a DataFrame.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.util.keep_columns" title="pyanomaly.util.keep_columns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">keep_columns</span></code></a></p></td>
<td><p>Keep columns of a DataFrame.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.util.is_zero" title="pyanomaly.util.is_zero"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_zero</span></code></a></p></td>
<td><p>Check if a variable or its element is zero.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.util.is_float" title="pyanomaly.util.is_float"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_float</span></code></a></p></td>
<td><p>Check if a variable's data type is float.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.util.is_numeric" title="pyanomaly.util.is_numeric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_numeric</span></code></a></p></td>
<td><p>Check if a variable's data type is numeric (int or float).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.util.is_bool_array" title="pyanomaly.util.is_bool_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_bool_array</span></code></a></p></td>
<td><p>Check if an array is a bool array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.util.nansum1" title="pyanomaly.util.nansum1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nansum1</span></code></a></p></td>
<td><p>Summation treating nan values as zero.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.drop_columns">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">drop_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.drop_columns" title="Link to this definition"></a></dt>
<dd><p>Delete columns of a DataFrame.</p>
<p>Columns are deleted in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame.</p></li>
<li><p><strong>cols</strong> – List of columns to drop.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.is_bool_array">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">is_bool_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.is_bool_array" title="Link to this definition"></a></dt>
<dd><p>Check if an array is a bool array.</p>
<p>The <cite>array</cite> is identified as a bool array if:</p>
<blockquote>
<div><ul class="simple">
<li><p>its dtype is ‘bool’ or ‘boolean’; or</p></li>
<li><p>it contains only True, False, or None.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>array</strong> – Series or ndarray.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if <cite>array</cite> is a bool array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.is_float">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">is_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.is_float" title="Link to this definition"></a></dt>
<dd><p>Check if a variable’s data type is float.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – A scalar or array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Bool. True if the data type of <cite>x</cite> is float.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.is_int">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">is_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.is_int" title="Link to this definition"></a></dt>
<dd><p>Check if a variable’s data type is int.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – A scalar or array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Bool. True if the data type of <cite>x</cite> is int.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.is_iterable">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">is_iterable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.is_iterable" title="Link to this definition"></a></dt>
<dd><p>Check if a variable is iterable.</p>
<p>Check if <cite>x</cite> is iterable. A string, an iterable object, is considered not iterable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – A variable to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Bool. True if <cite>x</cite> is iterable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.is_numeric">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">is_numeric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.is_numeric" title="Link to this definition"></a></dt>
<dd><p>Check if a variable’s data type is numeric (int or float).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – A scalar or array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Bool. True if the data type of <cite>x</cite> is numeric.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.is_zero">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">is_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.is_zero" title="Link to this definition"></a></dt>
<dd><p>Check if a variable or its element is zero.</p>
<p>A value is considered 0 if it is in the range (-1.e-7, 1.e-7).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – A scalar or array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Bool or an array of bool. True if 0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.keep_columns">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">keep_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.keep_columns" title="Link to this definition"></a></dt>
<dd><p>Keep columns of a DataFrame.</p>
<p>Keep <cite>cols</cite> columns of <cite>data</cite> and delete the rest in-place.
Much more memory-efficient than the following two methods: these methods momentarily consume a lot of memory when
<cite>data</cite> is large.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">cols</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use this function when handling a large dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame.</p></li>
<li><p><strong>cols</strong> – List of columns to keep.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.nansum1">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">nansum1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.nansum1" title="Link to this definition"></a></dt>
<dd><p>Summation treating nan values as zero.</p>
<p>This is similar to <code class="docutils literal notranslate"><span class="pre">sum()</span></code> of SAS: nan’s of <cite>args</cite> are replaced by 0. If all elements are nan, the result is nan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – List of Series.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Series. Sum of <cite>args</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">... </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nansum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">0     NaN</span>
<span class="go">1   1.000</span>
<span class="go">2   2.000</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nansum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">0     NaN</span>
<span class="go">1   1.000</span>
<span class="go">2   3.000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.to_list">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">to_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.to_list" title="Link to this definition"></a></dt>
<dd><p>Convert a variable to a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – A scalar or an iterable item.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>x</cite> converted to list.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">... </span><span class="n">to_list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">... </span><span class="n">to_list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span><span class="n">to_list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.unique_list">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">unique_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.unique_list" title="Link to this definition"></a></dt>
<dd><p>Get a list of unique elements of a list.</p>
<p>If <cite>x</cite> contains a list, its elements are considered elements of <cite>x</cite>, not the list itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – A list.</p></li>
<li><p><strong>exclude_nan</strong> – If True, exclude None and np.nan elements.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of unique elements of <cite>x</cite>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">... </span><span class="n">unique_list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">... </span><span class="n">unique_list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pyanomaly.wrdsdata">
<span id="wrdsdata"></span><h2>wrdsdata<a class="headerlink" href="#module-pyanomaly.wrdsdata" title="Link to this heading"></a></h2>
<p>This module defines WRDS class that is used to download and handle WRDS data.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS" title="pyanomaly.wrdsdata.WRDS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WRDS</span></code></a></p></td>
<td><p>Class to download/handle WRDS data.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.wrdsdata.</span></span><span class="sig-name descname"><span class="pre">WRDS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrds_username</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS" title="Link to this definition"></a></dt>
<dd><p>Class to download/handle WRDS data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wrds_username</strong> – WRDS username. Required only when downloading data: can be set to None when reading
data from files.</p>
</dd>
</dl>
<p><strong>Attributes</strong></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.db">
<span class="sig-name descname"><span class="pre">db</span></span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.db" title="Link to this definition"></a></dt>
<dd><p>A <code class="docutils literal notranslate"><span class="pre">wrds</span></code> object to connect to WRDS database.</p>
</dd></dl>

<p><strong>Methods for Data Download</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.download_table" title="pyanomaly.wrdsdata.WRDS.download_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">download_table</span></code></a></p></td>
<td><p>Download a table from WRDS library.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.download_table_async" title="pyanomaly.wrdsdata.WRDS.download_table_async"><code class="xref py py-obj docutils literal notranslate"><span class="pre">download_table_async</span></code></a></p></td>
<td><p>Asynchronous download of a WRDS table.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.download_sf" title="pyanomaly.wrdsdata.WRDS.download_sf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">download_sf</span></code></a></p></td>
<td><p>Download crsp.m(d)sf joined with crsp.m(d)senames.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.download_seall" title="pyanomaly.wrdsdata.WRDS.download_seall"><code class="xref py py-obj docutils literal notranslate"><span class="pre">download_seall</span></code></a></p></td>
<td><p>Download delist and dividend info from crsp.m(d)seall.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.download_funda" title="pyanomaly.wrdsdata.WRDS.download_funda"><code class="xref py py-obj docutils literal notranslate"><span class="pre">download_funda</span></code></a></p></td>
<td><p>Download comp.funda.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.download_fundq" title="pyanomaly.wrdsdata.WRDS.download_fundq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">download_fundq</span></code></a></p></td>
<td><p>Download comp.fundq.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.download_secd" title="pyanomaly.wrdsdata.WRDS.download_secd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">download_secd</span></code></a></p></td>
<td><p>Download comp.secd.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.download_g_secd" title="pyanomaly.wrdsdata.WRDS.download_g_secd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">download_g_secd</span></code></a></p></td>
<td><p>Download comp.g_secd.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.download_all" title="pyanomaly.wrdsdata.WRDS.download_all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">download_all</span></code></a></p></td>
<td><p>Download all tables.</p></td>
</tr>
</tbody>
</table>
<p><strong>Other Methods</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.create_pgpass_file" title="pyanomaly.wrdsdata.WRDS.create_pgpass_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_pgpass_file</span></code></a></p></td>
<td><p>Create pgpass file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.merge_sf_with_seall" title="pyanomaly.wrdsdata.WRDS.merge_sf_with_seall"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_sf_with_seall</span></code></a></p></td>
<td><p>Merge m(d)sf with m(d)seall.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.add_gvkey_to_crsp" title="pyanomaly.wrdsdata.WRDS.add_gvkey_to_crsp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gvkey_to_crsp</span></code></a></p></td>
<td><p>Add gvkey to m(d)sf and identify primary stocks.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.create_crsp_comp_linktable" title="pyanomaly.wrdsdata.WRDS.create_crsp_comp_linktable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_crsp_comp_linktable</span></code></a></p></td>
<td><p>Create a CRSP-Compustat link table using cusip.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.add_gvkey_to_crsp_cusip" title="pyanomaly.wrdsdata.WRDS.add_gvkey_to_crsp_cusip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_gvkey_to_crsp_cusip</span></code></a></p></td>
<td><p>Add gvkey to m(d)sf and identify primary stocks using internal link table.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.preprocess_crsp" title="pyanomaly.wrdsdata.WRDS.preprocess_crsp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">preprocess_crsp</span></code></a></p></td>
<td><p>Create crspm and crspd files.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.get_risk_free_rate" title="pyanomaly.wrdsdata.WRDS.get_risk_free_rate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_risk_free_rate</span></code></a></p></td>
<td><p>Get risk-free rate.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.convert_fund_currency_to_usd" title="pyanomaly.wrdsdata.WRDS.convert_fund_currency_to_usd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_fund_currency_to_usd</span></code></a></p></td>
<td><p>Convert non-USD values of funda(q) to USD values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.save_data" title="pyanomaly.wrdsdata.WRDS.save_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_data</span></code></a></p></td>
<td><p>Save downloaded table to a file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.read_data" title="pyanomaly.wrdsdata.WRDS.read_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_data</span></code></a></p></td>
<td><p>Read data from a saved table.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.save_as_csv" title="pyanomaly.wrdsdata.WRDS.save_as_csv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_as_csv</span></code></a></p></td>
<td><p>Read a file and save it to a csv file.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>CRSP overview: <a class="reference external" href="https://wrds-www.wharton.upenn.edu/pages/support/data-overview/wrds-overview-crsp-us-stock-database/">https://wrds-www.wharton.upenn.edu/pages/support/data-overview/wrds-overview-crsp-us-stock-database/</a></p>
<p>CRSP-Compustat merge: <a class="reference external" href="https://wrds-www.wharton.upenn.edu/pages/support/manuals-and-overviews/crsp/crspcompustat-merged-ccm/wrds-overview-crspcompustat-merged-ccm/">https://wrds-www.wharton.upenn.edu/pages/support/manuals-and-overviews/crsp/crspcompustat-merged-ccm/wrds-overview-crspcompustat-merged-ccm/</a></p>
<p>CRSP annual update tables: <a class="reference external" href="https://wrds-www.wharton.upenn.edu/data-dictionary/crsp_a_indexes/">https://wrds-www.wharton.upenn.edu/data-dictionary/crsp_a_indexes/</a></p>
<p>shrcd: <a class="reference external" href="https://wrds-www.wharton.upenn.edu/data-dictionary/form_metadata/crsp_a_stock_msf_identifyinginformation/shrcd/">https://wrds-www.wharton.upenn.edu/data-dictionary/form_metadata/crsp_a_stock_msf_identifyinginformation/shrcd/</a></p>
<p>exchcd: <a class="reference external" href="https://wrds-www.wharton.upenn.edu/data-dictionary/form_metadata/crsp_a_stock_msf_identifyinginformation/exchcd/">https://wrds-www.wharton.upenn.edu/data-dictionary/form_metadata/crsp_a_stock_msf_identifyinginformation/exchcd/</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.add_gvkey_to_crsp">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_gvkey_to_crsp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.add_gvkey_to_crsp" title="Link to this definition"></a></dt>
<dd><p>Add gvkey to m(d)sf and identify primary stocks.</p>
<p>The permno and gvkey are mapped using crsp.ccmxpf_linktable.</p>
<p>Primary stocks are identified in the following order.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>If linkprim = ‘P’ or ‘C’, set the security as primary.</p></li>
<li><p>If permno and gvkey have 1:1 mapping, set the security as primary.</p></li>
<li><p>Among the securities with the same gvkey, set the one with the maximum trading volume as primary.</p></li>
<li><p>Among the securities with the same permco and missing gvkey, set the one with the maximum trading volume
as primary.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sf</strong> – m(d)sf DataFrame with index = date/permno.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>m(d)sf with ‘gveky’ and ‘primary’ (primary stock indicator) columns added.</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://wrds-www.wharton.upenn.edu/pages/support/research-wrds/macros/wrds-macros-cvccmlnksas/">https://wrds-www.wharton.upenn.edu/pages/support/research-wrds/macros/wrds-macros-cvccmlnksas/</a></p>
<p><a class="reference external" href="https://wrds-www.wharton.upenn.edu/pages/support/applications/linking-databases/linking-crsp-and-compustat/">https://wrds-www.wharton.upenn.edu/pages/support/applications/linking-databases/linking-crsp-and-compustat/</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.add_gvkey_to_crsp_cusip">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_gvkey_to_crsp_cusip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.add_gvkey_to_crsp_cusip" title="Link to this definition"></a></dt>
<dd><p>Add gvkey to m(d)sf and identify primary stocks using internal link table.</p>
<p>The permno and gvkey are mapped using crsp_comp_linktable.</p>
<p>Primary stocks are identified in the following order.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>If linkprim = True, set the security as primary.</p></li>
<li><p>If permno and gvkey have 1:1 mapping, set the security as primary.</p></li>
<li><p>Among the securities with the same gvkey, set the one with the maximum trading volume as primary.</p></li>
<li><p>Among the securities with the same permco and missing gvkey, set the one with the maximum trading volume
as primary.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sf</strong> – m(d)sf DataFrame with index = date/permno.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Compared to using ccmxpf_linktable, about 13% of gvkey’s and 3% of primary’s are different.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>m(d)sf with ‘gveky’ and ‘primary’ (primary stock indicator) columns added.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.convert_fund_currency_to_usd">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convert_fund_currency_to_usd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fund</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'funda'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.convert_fund_currency_to_usd" title="Link to this definition"></a></dt>
<dd><p>Convert non-USD values of funda(q) to USD values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fund</strong> – funda(q) DataFrame with index = datadate/gvkey.</p></li>
<li><p><strong>table</strong> – ‘funda’ or ‘fundq’: indicator whether <cite>fund</cite> is funda or fundq.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted <cite>fund</cite> DataFrame.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In Compustat North America, the accounting data can be either in USD and CAD. This is no problem if firm
characteristics are generated using only Compustat. However, if data from different sources are mixed, e.g.,
if CRSP’s market equity (in USD) is combined with Compustat, Compustat data should be converted to USD.</p>
<p>Following JKP, we use compustat.exrt_dly to obtain exchange rates. The exrt_dly starts from 1982-02-01.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.create_crsp_comp_linktable">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_crsp_comp_linktable</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.create_crsp_comp_linktable" title="Link to this definition"></a></dt>
<dd><p>Create a CRSP-Compustat link table using cusip.</p>
<p>This method creates a CRSP-Compustat link table by merging crsp.msf with comp.security on cusip.
This method can be used if the user does not have a WRDS subscription for ccmxpf_linktable.
The link table has the columns [‘cusip’, ‘gvkey’, ‘permno’, ‘linkdt’, ‘linkenddt’, ‘linkprim’] and is saved to
<code class="docutils literal notranslate"><span class="pre">config.input_dir/crsp_comp_linktable</span></code>. The linkprim column value is True if a security is primary.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The sql in the reference uses historical cusip (ncusip in msenames). However, we use cusip in msf as it
renders more matches.</p>
<p>A security is considered primary (linkprim = True) if its cusip is in funda or fundq.</p>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="https://wrds-www.wharton.upenn.edu/pages/support/applications/linking-databases/linking-crsp-and-compustat/">https://wrds-www.wharton.upenn.edu/pages/support/applications/linking-databases/linking-crsp-and-compustat/</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.create_pgpass_file">
<span class="sig-name descname"><span class="pre">create_pgpass_file</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.create_pgpass_file" title="Link to this definition"></a></dt>
<dd><p>Create pgpass file.</p>
<p>Need to be called only once (after logging in to WRDS for the first time using passwords).
Once pgpass file is created, password is not required when connecting to WRDS.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_all">
<span class="sig-name descname"><span class="pre">download_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_all" title="Link to this definition"></a></dt>
<dd><p>Download all tables.</p>
<p>Currently, this method downloads the following tables:</p>
<ul class="simple">
<li><p>comp.funda</p></li>
<li><p>comp.fundq</p></li>
<li><p>comp.exrt_dly</p></li>
<li><p>crsp.msf (merged with crsp.msenames)</p></li>
<li><p>crsp.dsf (merged with crsp.dsenames)</p></li>
<li><p>crsp.mseall</p></li>
<li><p>crsp.dseall</p></li>
<li><p>crsp.ccmxpf_linktable</p></li>
<li><p>crsp.mcti</p></li>
<li><p>ff.factors_monthly</p></li>
<li><p>ff.factors_daily</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>run_in_executer</strong> – If True, download concurrently. Faster (if network speed is high) but memory hungrier.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_funda">
<span class="sig-name descname"><span class="pre">download_funda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_funda" title="Link to this definition"></a></dt>
<dd><p>Download comp.funda.</p>
<p>Downloaded data has index = datadate/gvkey and is sorted on gvkey/datadate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date, e.g., ‘2000-01-01’. Set to None to download all data.</p></li>
<li><p><strong>edate</strong> – End date. Set to None to download all data.</p></li>
<li><p><strong>run_in_executer</strong> – If True, download concurrently. Faster but memory hungrier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_fundq">
<span class="sig-name descname"><span class="pre">download_fundq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_fundq" title="Link to this definition"></a></dt>
<dd><p>Download comp.fundq.</p>
<p>Downloaded data has index = datadate/gvkey and is sorted on gvkey/datadate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date, e.g., ‘2000-01-01’. Set to None to download all data.</p></li>
<li><p><strong>edate</strong> – End date. Set to None to download all data.</p></li>
<li><p><strong>run_in_executer</strong> – If True, download concurrently. Faster but memory hungrier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_g_secd">
<span class="sig-name descname"><span class="pre">download_g_secd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_g_secd" title="Link to this definition"></a></dt>
<dd><p>Download comp.g_secd.</p>
<p>Downloaded data has index = datadate/gvkey and is sorted on gvkey/datadate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date, e.g., ‘2000-01-01’. Set to None to download all data.</p></li>
<li><p><strong>edate</strong> – End date. Set to None to download all data.</p></li>
<li><p><strong>run_in_executer</strong> – If True, download concurrently. Faster but memory hungrier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_seall">
<span class="sig-name descname"><span class="pre">download_seall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monthly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_seall" title="Link to this definition"></a></dt>
<dd><p>Download delist and dividend info from crsp.m(d)seall.</p>
<p>Delist can be obtained from either mseall or msedelist. We use mseall since it contains exchcd, which is used
when replacing missing dlret.
The shrcd and exchcd in mseall are usually those before halting/suspension. If a stock in NYSE is halted, exchcd
in msenames can be -2, whereas that in mseall is 1.
The downloaded fields are: permno, date, dlret, dlstcd, shrcd, exchcd, distcd, divamt.
Downloaded data has index = date/permno and is sorted on permno/date.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date, e.g., ‘2000-01-01’. Set to None to download all data.</p></li>
<li><p><strong>edate</strong> – End date. Set to None to download all data.</p></li>
<li><p><strong>monthly</strong> – If True download mseall else dseall.</p></li>
<li><p><strong>run_in_executer</strong> – If True, download concurrently. Faster but memory hungrier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_secd">
<span class="sig-name descname"><span class="pre">download_secd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_secd" title="Link to this definition"></a></dt>
<dd><p>Download comp.secd.</p>
<p>Downloaded data has index = datadate/gvkey and is sorted on gvkey/datadate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date, e.g., ‘2000-01-01’. Set to None to download all data.</p></li>
<li><p><strong>edate</strong> – End date. Set to None to download all data.</p></li>
<li><p><strong>run_in_executer</strong> – If True, download concurrently. Faster but memory hungrier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_sf">
<span class="sig-name descname"><span class="pre">download_sf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monthly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_sf" title="Link to this definition"></a></dt>
<dd><p>Download crsp.m(d)sf joined with crsp.m(d)senames.</p>
<p>Downloaded data has index = date/permno and is sorted on permno/date.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date, e.g., ‘2000-01-01’. Set to None to download all data.</p></li>
<li><p><strong>edate</strong> – End date. Set to None to download all data.</p></li>
<li><p><strong>monthly</strong> – If True download msf else dsf.</p></li>
<li><p><strong>run_in_executer</strong> – If True, download concurrently. Faster but memory hungrier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_table">
<span class="sig-name descname"><span class="pre">download_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">library</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coerce_float</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_table" title="Link to this definition"></a></dt>
<dd><p>Download a table from WRDS library.</p>
<p>This is a wrapping function of <code class="docutils literal notranslate"><span class="pre">wrds.get_table()</span></code>. The queried table is saved to
<code class="docutils literal notranslate"><span class="pre">config.input_dir/library/table</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>library</strong> – WRDS library. e.g., crsp, comp, …</p></li>
<li><p><strong>table</strong> – A table in <cite>library</cite>.</p></li>
<li><p><strong>obs</strong> – See <code class="docutils literal notranslate"><span class="pre">wrds.get_table()</span></code>.</p></li>
<li><p><strong>offset</strong> – See <code class="docutils literal notranslate"><span class="pre">wrds.get_table()</span></code>.</p></li>
<li><p><strong>columns</strong> – See <code class="docutils literal notranslate"><span class="pre">wrds.get_table()</span></code>.</p></li>
<li><p><strong>coerce_float</strong> – See <code class="docutils literal notranslate"><span class="pre">wrds.get_table()</span></code>.</p></li>
<li><p><strong>date_cols</strong> – See <code class="docutils literal notranslate"><span class="pre">wrds.get_table()</span></code>.</p></li>
<li><p><strong>index_col</strong> – (List of) column(s) to be set as index.</p></li>
<li><p><strong>sort_col</strong> – (List of) column(s) to sort data on.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_table_async">
<span class="sig-name descname"><span class="pre">download_table_async</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">library</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sql</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_tables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_table_async" title="Link to this definition"></a></dt>
<dd><p>Asynchronous download of a WRDS table.</p>
<p>This method splits the total period into <cite>interval</cite> years and downloads data of each sub-period
asynchronously. If download fails, it can be started from the failed date: already downloaded files will be
gathered together. This method allow us to download a large table, e.g., crsp.dsf, reliably without connection
timeout and consumes much less memory than <a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.download_table" title="pyanomaly.wrdsdata.WRDS.download_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">download_table()</span></code></a>.
The queried table is saved to <code class="docutils literal notranslate"><span class="pre">config.input_dir/library/table</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>library</strong> – WRDS library.</p></li>
<li><p><strong>table</strong> – WRDS table. If a complete query is given in <cite>sql</cite>, this can be any name: used only as the file name
when saving the data.</p></li>
<li><p><strong>sql</strong> – String of the fields to select or a complete query statement. See below.</p></li>
<li><p><strong>date_col</strong> – Date field on which downloaing will be split. Ignored if <cite>sql</cite> is a complete query statement.</p></li>
<li><p><strong>sdate</strong> – Start date (‘yyyy-mm-dd’). If None, ‘1900-01-01’.</p></li>
<li><p><strong>edate</strong> – End date. If None, today.</p></li>
<li><p><strong>interval</strong> – Sub-period size in years.</p></li>
<li><p><strong>src_tables</strong> – List of (library, table) that are used in the query. The <cite>src_tables</cite> are used to get data types
of the fields. When data is selected from a single table, <cite>library.table</cite>, this can be set to None.</p></li>
<li><p><strong>run_in_executer</strong> – If True, download concurrently. Faster but memory hungrier.</p></li>
<li><p><strong>index_col</strong> – (List of) column(s) to be set as index.</p></li>
<li><p><strong>sort_col</strong> – (List of) column(s) to sort data on.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a small table, this can be slower than <a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.download_table" title="pyanomaly.wrdsdata.WRDS.download_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">download_table()</span></code></a>.
Table should have a date field (<cite>date_col</cite>) to split the period.</p>
</div>
<p class="rubric">Examples</p>
<p>Instantiate WRDS.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wrds</span> <span class="o">=</span> <span class="n">WRDS</span><span class="p">(</span><span class="s1">&#39;user_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Download crsp.msf.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wrds</span><span class="o">.</span><span class="n">download_table_async</span><span class="p">(</span><span class="s1">&#39;crsp&#39;</span><span class="p">,</span> <span class="s1">&#39;msf&#39;</span><span class="p">,</span> <span class="n">date_col</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Download ‘permno’, ‘prc’, and ‘exchcd’ fields from crsp.msf.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span> <span class="o">=</span> <span class="s1">&#39;permno, prc, exchcd&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wrds</span><span class="o">.</span><span class="n">download_table_async</span><span class="p">(</span><span class="s1">&#39;crsp&#39;</span><span class="p">,</span> <span class="s1">&#39;msf&#39;</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Download crsp.msf merged with crsp.msenames. When <cite>sql</cite> is a complete query statement as below,
it should contain ‘WHERE [<cite>date_col</cite>] BETWEEN {} and {}’ for asynchronous download.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">       SELECT a.*, b.shrcd, b.exchcd, b.siccd</span>
<span class="gp">... </span><span class="s1">       FROM crsp.msf as a</span>
<span class="gp">... </span><span class="s1">       LEFT JOIN crsp.msenames as b</span>
<span class="gp">... </span><span class="s1">       ON a.permno = b.permno</span>
<span class="gp">... </span><span class="s1">       AND b.namedt &lt;= a.date</span>
<span class="gp">... </span><span class="s1">       AND a.date &lt;= b.nameendt</span>
<span class="gp">... </span><span class="s1">       WHERE a.date BETWEEN &#39;{{}}&#39; and &#39;{{}}&#39;</span>
<span class="gp">... </span><span class="s1">       ORDER BY a.permno, a.date</span>
<span class="gp">... </span><span class="s1">    &#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">src_tables</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;crsp&#39;</span><span class="p">,</span> <span class="s1">&#39;msf&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;crsp&#39;</span><span class="p">,</span> <span class="s1">&#39;msenames&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wrds</span><span class="o">.</span><span class="n">download_table_async</span><span class="p">(</span><span class="s1">&#39;crsp&#39;</span><span class="p">,</span> <span class="s1">&#39;msf&#39;</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">src_tables</span><span class="o">=</span><span class="n">src_tables</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.get_risk_free_rate">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_risk_free_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mcti'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.get_risk_free_rate" title="Link to this definition"></a></dt>
<dd><p>Get risk-free rate.</p>
<p>The risk-free rate can be obtained either from crsp.mcti or ff.factors_monthly.
The mcti is preferred since the values in factors_monthly have only 4 decimal places.
Both risk-free rates are in decimal (not percentage values).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
<li><p><strong>src</strong> – data source. ‘mcti’: crsp.mcti, ‘ff’: ff.factors_monthly.</p></li>
<li><p><strong>month_end</strong> – If True, shift dates to the end of the month.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame of risk-free rates with index = ‘date’ and columns = [‘rf’].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.merge_sf_with_seall">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">merge_sf_with_seall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monthly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.merge_sf_with_seall" title="Link to this definition"></a></dt>
<dd><p>Merge m(d)sf with m(d)seall.</p>
<p>This method adjusts m(d)sf return (‘ret’) using m(d)seall delist return (‘dlret’). The adjusted return replaces
‘ret’ and ‘dlret’ column is added to m(d)sf.
For msf, this method also adds cash dividend column, ‘cash_div’, to msf.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>monthly</strong> – If True, merge msf with mseall; else, merge dsf with dseall.</p></li>
<li><p><strong>fill_method</strong> – <p>Method to fill missing dlret. 0: don’t fill, 1: JKP code, or 2: GHZ code. Default to 1.</p>
<ul>
<li><p>fill_method = 1:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>dlret</cite> = -0.30 if <cite>dlstcd</cite> is 500 or between 520 and 584.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>fill_method = 2:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>dlret</cite> = -0.35 if <cite>dlstcd</cite> is 500 or between 520 and 584, and <cite>exchcd</cite> is 1 or 2.</p></li>
<li><p><cite>dlret</cite> = -0.55 if <cite>dlstcd</cite> is 500 or between 520 and 584, and <cite>exchcd</cite> is 3.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>m(d)sf with adjusted return (and cash dividend).</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The msenames can be missing when a firm is delisted, resulting in missing shrcd/exchcd in m(d)sf.
Missing shrcd and exchcd are filled with the latest values.</p>
</div>
<p class="rubric">References</p>
<p>Delist codes: <a class="reference external" href="http://www.crsp.com/products/documentation/delisting-codes">http://www.crsp.com/products/documentation/delisting-codes</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.preprocess_crsp">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">preprocess_crsp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_ccmxpf_linktable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.preprocess_crsp" title="Link to this definition"></a></dt>
<dd><p>Create crspm and crspd files.</p>
<p>This method calls <a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.merge_sf_with_seall" title="pyanomaly.wrdsdata.WRDS.merge_sf_with_seall"><code class="xref py py-meth docutils literal notranslate"><span class="pre">merge_sf_with_seall()</span></code></a> and <a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.add_gvkey_to_crsp" title="pyanomaly.wrdsdata.WRDS.add_gvkey_to_crsp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_gvkey_to_crsp()</span></code></a> to add delist return,
gveky, and primary indicator to m(d)sf. The result is saved to <code class="docutils literal notranslate"><span class="pre">config.input_dir/crspm(d)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>use_ccmxpf_linktable</strong> – If True, use crsp.ccmxpf_linktable to link CRSP and Compustat; if False, use
internally created link table, crsp_comp_linktable. If None, use crsp.ccmxpf_linktable if it exists,
otherwise, use crsp_comp_linktable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.read_data">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">library</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typecast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.read_data" title="Link to this definition"></a></dt>
<dd><p>Read data from a saved table.</p>
<p>The file path is <code class="docutils literal notranslate"><span class="pre">config.input_dir/library/table</span></code>.
The <cite>library</cite> argument is redundant: if it is None, all folders under <code class="docutils literal notranslate"><span class="pre">config.input_dir</span></code> is searched.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> – File name without extension.</p></li>
<li><p><strong>library</strong> – Directory.</p></li>
<li><p><strong>index_col</strong> – (List of) column(s) to be set as index.</p></li>
<li><p><strong>sort_col</strong> – (List of) column(s) to sort data on.</p></li>
<li><p><strong>typecast</strong> – If True, cast float to <code class="docutils literal notranslate"><span class="pre">config.float_type</span></code> and object to string after reading from the file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame. Data read. Index = <cite>index_col</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.save_as_csv">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_as_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">library</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.save_as_csv" title="Link to this definition"></a></dt>
<dd><p>Read a file and save it to a csv file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> – File name without extension.</p></li>
<li><p><strong>library</strong> – Directory.</p></li>
<li><p><strong>fpath</strong> – File path for the csv file. If None, the file is saved to <code class="docutils literal notranslate"><span class="pre">config.input_dir/library/table.csv</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.save_data">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">library</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typecast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.save_data" title="Link to this definition"></a></dt>
<dd><p>Save downloaded table to a file.</p>
<p>The file format can be either pickle (default) or parquet and configured by <a class="reference internal" href="#pyanomaly.config.set_config" title="pyanomaly.config.set_config"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_config()</span></code></a>.
The <cite>data</cite> is saved in the following location:</p>
<blockquote>
<div><ul class="simple">
<li><p>If <cite>library</cite> = None, <code class="docutils literal notranslate"><span class="pre">config.input_dir/table</span></code>.</p></li>
<li><p>Otherwise, <code class="docutils literal notranslate"><span class="pre">config.input_dir/library/table</span></code>.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Data to save (DataFrame).</p></li>
<li><p><strong>table</strong> – File name without extension.</p></li>
<li><p><strong>library</strong> – Directory.</p></li>
<li><p><strong>index_col</strong> – (List of) column(s) to be set as index.</p></li>
<li><p><strong>sort_col</strong> – (List of) column(s) to sort data on.</p></li>
<li><p><strong>typecast</strong> – If True, cast float to <cite>config.float_type</cite> and object to string before saving to a file.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A parquet file size can be significantly smaller especially when there are many duplicate values in columns.
However, it tends to be slower to read and write and takes significantly more memory in some cases for
unknown reasons. To change the file format to parquet, use <code class="docutils literal notranslate"><span class="pre">set_config(file_format='parquet')</span></code>.
We use parquet or pickle file format to store data as they preserve data types and are much faster to read
compared to a csv file. To convert a file to a csv file, use <a class="reference internal" href="#pyanomaly.wrdsdata.WRDS.save_as_csv" title="pyanomaly.wrdsdata.WRDS.save_as_csv"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save_as_csv()</span></code></a>.</p>
</div>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="building_your_own.html" class="btn btn-neutral float-left" title="Bulding Your Own" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="support.html" class="btn btn-neutral float-right" title="Support" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Chulwoo Han and Jongho Kang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>